{"version":3,"file":"spreadsheet.js","sources":["../sources/locale.js","../sources/locales/en.js","../sources/views/align.js","../sources/views/border.js","../sources/views/color.js","../node_modules/@xbs/muon/dist/muon.js","../sources/mathematics/methods.js","../sources/views/date.js","../sources/views/dialog.js","../sources/views/form.js","../sources/views/formlate.js","../sources/views/icons.js","../sources/views/list_suggest.js","../sources/operations/undo_group.js","../sources/operations/save.js","../sources/helpers/column_names.js","../sources/toolbar/defaults.js","../sources/operations/styles.js","../sources/operations/formats.js","../sources/mathematics/parser.js","../sources/operations/types.js","../sources/views/suggest_formula.js","../sources/views/button.js","../sources/views/live_editor.js","../sources/views/separator.js","../sources/views/sheets.js","../sources/views/toggle.js","../sources/views/toolbar_title.js","../sources/views/multicheckbox.js","../sources/views/formlist.js","../sources/views/ui.js","../sources/views/series.js","../sources/editors/date.js","../sources/editors/richselect.js","../sources/toolbar/actions.js","../sources/toolbar/buttons.js","../sources/toolbar/all_elements.js","../sources/toolbar.js","../sources/toolbar/helpers.js","../sources/operations/column_operations.js","../sources/operations/lock_cell.js","../sources/operations/spans.js","../sources/helpers/conditional.js","../sources/operations/conditional_formats.js","../sources/table.js","../sources/hotkeys.js","../sources/editor.js","../sources/helpers/array.js","../sources/operations/data.js","../sources/sheets.js","../sources/dialogs/common.js","../sources/mathematics/writer.js","../sources/dialogs/imagecell.js","../sources/dialogs/imagetop.js","../sources/dialogs/sparkline.js","../sources/dialogs/ranges.js","../sources/dialogs/dropdown.js","../sources/mathematics/ranges.js","../sources/operations/filter.js","../sources/dialogs/filter.js","../sources/dialogs/format.js","../sources/dialogs/conditional.js","../sources/dialogs/export.js","../sources/dialogs/link.js","../sources/dialogs/print.js","../sources/dialogs/comments.js","../sources/dialogs/sizing.js","../sources/dialogs/index.js","../sources/operations/undo.js","../sources/operations/views.js","../sources/chart.js","../sources/operations/add_row_col.js","../sources/operations/dropdown.js","../sources/operations/clipboard.js","../sources/operations/hide_row_col.js","../sources/operations/resize.js","../sources/operations/selection.js","../sources/helpers/expand_selection.js","../sources/operations/sorting.js","../sources/mathematics/sheets.js","../sources/operations/hide_gridlines.js","../sources/operations/hide_headers.js","../sources/operations/comments.js","../sources/operations/states.js","../sources/operations/import.js","../sources/operations/print.js","../sources/operations/export.js","../sources/operations/load.js","../sources/operations/clear_styles.js","../sources/api/row_col_operations.js","../sources/api/lock_cell.js","../sources/api/freeze.js","../sources/api/hide_gridlines.js","../sources/api/hide_headers.js","../sources/api/hide_rows.js","../sources/api/math.js","../sources/api/operations.js","../sources/api/core.js","../sources/api/save.js","../sources/api/dropdown.js","../sources/api/filter.js","../sources/api/confirm.js","../sources/api/undo.js","../sources/api/number_formats.js","../sources/menu.js","../sources/spreadsheet.js","../sources/context.js","../sources/operations/index.js","../sources/api/index.js"],"sourcesContent":["import en from \"./locales/en\";\nwebix.i18n.spreadsheet = en;","export default {\n\tlabels:{\n\t\t// formats\n\t\t\"common\": \"Common\",\n\t\t\"currency\": \"Currency\",\n\t\t\"number\": \"Number\",\n\t\t\"percent\": \"Percent\",\n\t\t\"date\": \"Date\",\n\t\t\"string\": \"Text\",\n\t\t\"custom-format\": \"Custom\",\n\t\t\"decimal-places\":\"Decimal places\",\n\t\t\"separator\":\"Group separator\",\n\t\t\"negative\":\"Negative number\",\n\t\t\"currency-symbol\":\"Ð¡urrency\",\n\t\t\"date-format\":\"Date format\",\n\t\t\"format-docs\":\"How to create a format\",\n\t\t// titles\n\t\t\"undo-redo\": \"Undo/Redo\",\n\t\t\"font\": \"Font\",\n\t\t\"text\": \"Text\",\n\t\t\"cell\": \"Cell\",\n\t\t\"align\": \"Align\",\n\t\t\"format\": \"Number\",\n\t\t\"column\": \"Column\",\n\t\t\"borders\": \"Borders\",\n\t\t\"px\": \"px\",\n\t\t\"apply\": \"Apply\",\n\t\t// popups and dialogs\n\t\t\"cancel\": \"Cancel\",\n\t\t\"save\": \"Save\",\n\t\t// multisheets\n\t\t\"sheet\": \"Sheet\",\n\t\t// conditions\n\t\t\"conditional-format\": \"Conditional Format\",\n\t\t\"condition\": \"Condition\",\n\t\t\"conditional-style\": \"Style\",\n\t\t\"conditional-operator\": \"Operator\",\n\t\t\"conditional-between\":\"between\",\n\t\t\"conditional-not-equal\":\"not equal\",\n\t\t// ranges\n\t\t\"range\": \"Range\",\n\t\t\"range-title\": \"Named ranges\",\n\t\t\"range-name\": \"Name\",\n\t\t\"range-cells\": \"Range\",\n\t\t\"range-scope\": \"Scope\",\n\t\t\"range-global\": \"Book\",\n\t\t// images\n\t\t\"image-or\": \"or\",\n\t\t\"image-title\": \"Add image\",\n\t\t\"image-upload\": \"Select file for upload\",\n\t\t\"image-url\": \"URL (e.g. http://*)\",\n\t\t// sparklines\n\t\t\"sparkline-title\": \"Add sparkline\",\n\t\t\"sparkline-type\": \"Type\",\n\t\t\"sparkline-range\": \"Range\",\n\t\t\"sparkline-color\": \"Color\",\n\t\t\"sparkline-positive\": \"Positive\",\n\t\t\"sparkline-negative\": \"Negative\",\n\t\t// custom format\n\t\t\"format-title\": \"Set format\",\n\t\t\"format-pattern\": \"Format pattern\",\n\t\t//dropdown\n\t\t\"dropdown-empty\": \"Empty cells\",\n\t\t\"dropdown-title\": \"Add dropdown\",\n\t\t\"dropdown-range\": \"Range\",\n\t\t// confirm\n\t\t\"ok\": \"OK\",\n\t\t// import/export\n\t\t\"import-title\": \"Import\",\n\t\t\"import-not-support\": \"Sorry, your browser does not support import\",\n\t\t\"export-title\": \"Export\",\n\t\t\"export-name\": \"Name of xslx file\",\n\t\t\"export-all-sheets\":\"Export all sheets\",\n\t\t// add link\n\t\t\"link-title\": \"Add Link\",\n\t\t\"link-name\": \"Text\",\n\t\t\"link-url\": \"URL\",\n\t\t//images\n\t\t\"image\": \"Image\",\n\t\t\"add-image-cell\":\"Add to cell\",\n\t\t\"add-image-top\":\"Add above cells\",\n\t\t//charts\n\t\t\"graph\": \"Graph\",\n\t\t\"add-sparkline\":\"Add to cell\",\n\t\t\"add-chart\":\"Add above cells\",\n\t\t//conditional format labels\n\t\t\"display\" : \"Display\",\n\t\t\"value\" : \"Value\",\n\t\t// confirm messages\n\t\t\"range-remove-confirm\": \"Are you sure you want to remove the range permanently?\",\n\t\t\"sheet-remove-confirm\": \"Are you sure you want to remove the sheet permanently?\",\n\t\t\"merge-cell-confirm\":\"Only the left top value will remain after merging. Continue?\",\n\t\t\"error-range\": \"The range is incorrect!\",\n\t\t//print\n\t\t\"print\":\"Print\",\n\t\t\"print-title\":\"Before you print..\",\n\t\t\"print-settings\":\"General settings\",\n\t\t\"print-paper\":\"Paper size\",\n\t\t\"print-layout\":\"Layout\",\n\t\t\"current-sheet\":\"Current sheet\",\n\t\t\"all-sheets\":\"All sheets\",\n\t\t\"selection\":\"Selected cells\",\n\t\t\"borderless\":\"Hide gridlines\",\n\t\t\"sheet-names\":\"Show sheet names\",\n\t\t\"skip-rows\":\"Skip empty rows\",\n\t\t\"margin\":\"Hide margins\",\n\t\t\"page-letter\":\"Letter\",\n\t\t\"page-a4\":\"A4 (210x297mm)\",\n\t\t\"page-a3\":\"A3 (297x420mm)\",\n\t\t\"page-width\":\"Page width\",\n\t\t\"page-actual\":\"Actual Size\",\n\t\t\"page-portrait\":\"Portrait\",\n\t\t\"page-landscape\":\"Landscape\",\n\t\t//comment\n\t\t\"comment\":\"Comment\",\n\t\t//resize\n\t\t\"width\":\"Width\",\n\t\t\"height\":\"Height\",\n\t\t\"fit-content\": \"Fit to content\",\n\t\t\"default-size\":\"Reset to default\",\n\t\t//views\n\t\t\"edit-view\":\"Edit\",\n\t\t\"remove-view\":\"Remove\",\n\t\t\"chart-edit\":\"Edit chart\",\n\n\t\t\"chart-common\":\"Common\",\n\t\t\"chart-series\":\"Series\",\n\t\t\"chart-extras\":\"Extras\",\n\n\t\t\"export-view\":\"Download\",\n\t\t\"export-view-pdf\":\"PDF document\",\n\t\t\"export-view-png\":\"PNG image\",\n\t\t\"export-view-excel\":\"Excel file\",\n\n\t\t\"line-chart\":\"Line\",\n\t\t\"area-chart\":\"Area\",\n\t\t\"bar-chart\":\"Bar\",\n\t\t\"donut-chart\":\"Donut\",\n\t\t\"pie-chart\":\"Pie\",\n\t\t\"radar-chart\":\"Radar\",\n\t\t\"spline-chart\":\"Spline\",\n\t\t\"splinearea-chart\":\"Spline Area\",\n\n\t\t\"chart-scale\":\"Scale\",\n\t\t\"chart-x-axis\":\"X axis\",\n\t\t\"chart-y-axis\":\"Y axis\",\n\t\t\"chart-lines\":\"Lines\",\n\t\t\"chart-scale-color\":\"Scale color\",\n\t\t\"chart-xAxis-title\":\"Title\",\n\t\t\"chart-yAxis-title\":\"Title\",\n\t\t\"chart-col-xAxis\":\"Use left column as xAxis\",\n\t\t\"chart-row-xAxis\":\"Use top row as xAxis\",\n\t\t\"chart-xAxis-range\":\"Range\",\n\t\t\"chart-yAxis-origin\":\"Origin\",\n\t\t\"chart-yAxis-start\":\"Start\",\n\t\t\"chart-yAxis-end\":\"End\",\n\t\t\"chart-yAxis-step\":\"Step\",\n\t\t\"chart-yAxis-note\":\"* Set all the following parameters to see the effect\",\n\n\t\t\"chart-legend\":\"Legend\",\n\t\t\"chart-row-legend\":\"Use top row as legend\",\n\t\t\"chart-col-legend\":\"Use left column as legend\",\n\t\t\"chart-legend-range\":\"Legend range\",\n\t\t\"chart-legend-align\":\"Align\",\n\t\t\"chart-legend-left\":\"Left\",\n\t\t\"chart-legend-right\":\"Right\",\n\t\t\"chart-legend-center\":\"Center\",\n\t\t\"chart-legend-valign\":\"Vertical align\",\n\t\t\"chart-legend-top\":\"Top\",\n\t\t\"chart-legend-middle\":\"Middle\",\n\t\t\"chart-legend-bottom\":\"Bottom\",\n\n\t\t\"chart-item\":\"Data\",\n\t\t\"stacked-chart\":\"Stacked\",\n\t\t\"chart-range\":\"Range\",\n\t\t\"chart-series-color\":\"Color\",\n\t\t\"add-line\":\"Add line\",\n\t\t\"chart-type\":\"Type\",\n\t\t\"chart-tooltip\":\"Tooltips\",\n\t\t\"chart-label\":\"Labels\",\n\n\t\t\"chart-data-from\":\"Data series from\",\n\t\t\"chart-columns\":\"columns\",\n\t\t\"chart-rows\":\"rows\",\n\n\t\t\"chart-markers\":\"Markers\",\n\t\t\"chart-markers-square\":\"Square\",\n\t\t\"chart-markers-triangle\":\"Triangle\",\n\t\t\"chart-markers-diamond\":\"Diamond\",\n\t\t\"chart-markers-round\":\"Round\",\n\n\t\t\"chart-pie-text\":\"Show values inside\",\n\t\t\"chart-pie-3d\":\"3D\",\n\n\t\t\"chart-radar-circle\":\"Circled lines\"\n\t},\n\ttooltips: {\n\t\t\"color\": \"Font color\",\n\t\t\"background\": \"Background color\",\n\t\t\"font-family\": \"Font family\",\n\t\t\"font-size\": \"Font size\",\n\t\t\"text-align\": \"Horizontal align\",\n\t\t\"vertical-align\": \"Vertical align\",\n\t\t\"borders\": \"Borders\",\n\t\t\"borders-no\": \"Clear borders\",\n\t\t\"borders-left\": \"Left border\",\n\t\t\"borders-top\": \"Top border\",\n\t\t\"borders-right\": \"Right border\",\n\t\t\"borders-bottom\": \"Bottom border\",\n\t\t\"borders-all\": \"All borders\",\n\t\t\"borders-outer\": \"Outer borders\",\n\t\t\"borders-top-bottom\": \"Top and bottom borders\",\n\t\t\"borders-color\": \"Border color\",\n\t\t\"align-left\": \"Left align\",\n\t\t\"align-center\": \"Center align\",\n\t\t\"align-right\": \"Right align\",\n\t\t\"align-top\": \"Top align\",\n\t\t\"align-middle\": \"Middle align\",\n\t\t\"align-bottom\": \"Bottom align\",\n\t\t\"span\": \"Merge\",\n\t\t\"wrap\": \"Text wrap\",\n\t\t\"undo\": \"Undo\",\n\t\t\"redo\": \"Redo\",\n\t\t\"format\": \"Number format\",\n\t\t\"increase-decimals\":\"Increase decimal places\",\n\t\t\"decrease-decimals\":\"Decrease decimal places\",\n\t\t\"font-weight\": \"Bold\",\n\t\t\"font-style\": \"Italic\",\n\t\t\"text-decoration\": \"Underline\",\n\t\t\"hide-gridlines\": \"Hide/show gridlines\",\n\t\t\"hide-headers\": \"Hide/show headers\",\n\t\t\"create-filter\": \"Create/remove filters\",\n\t\t\"freeze-columns\" : \"Freeze/unfreeze columns\",\n\t\t\"add-range\": \"Set name for the selected range\",\n\t\t\"conditional\": \"Conditional formatting\",\n\t\t\"add-sheet\": \"Add Sheet\",\n\t\t\"lock-cell\": \"Lock/unlock cell\",\n\t\t\"clear\": \"Clear\",\n\t\t\"add-link\": \"Add link\",\n\t\t\"row\": \"Rows\",\n\t\t\"column\": \"Columns\",\n\t\t\"sheet\": \"Sheet\",\n\t\t\"add-image\": \"Image\",\n\t\t\"add-sparkline\": \"Graph\",\n\t\t\"add-comment\": \"Comment\"\n\t},\n\tmenus:{\n\t\t\"remove-sheet\": \"Remove sheet\",\n\t\t\"rename-sheet\": \"Rename sheet\",\n\t\t\"file\": \"File\",\n\t\t\"new\": \"New\",\n\t\t\"new-sheet\": \"New sheet\",\n\t\t\"excel-import\": \"Import from Excel\",\n\t\t\"excel-export\": \"Export to Excel\",\n\t\t\"sheet\": \"Sheets\",\n\t\t\"copy-sheet\": \"Copy to new sheet\",\n\t\t\"edit\": \"Edit\",\n\t\t\"undo\": \"Undo\",\n\t\t\"redo\": \"Redo\",\n\t\t\"columns\": \"Columns\",\n\t\t\"insert-column\": \"Insert column\",\n\t\t\"delete-column\": \"Delete column\",\n\t\t\"show-column\": \"Show column\",\n\t\t\"hide-column\": \"Hide column\",\n\t\t\"resize-column\": \"Resize column\",\n\t\t\"rows\": \"Rows\",\n\t\t\"insert-row\": \"Insert row\",\n\t\t\"delete-row\": \"Delete row\",\n\t\t\"show-row\": \"Show row\",\n\t\t\"hide-row\": \"Hide row\",\n\t\t\"resize-row\": \"Resize row\",\n\t\t\"insert\": \"Insert\",\n\t\t\"conditional-format\": \"Conditional format\",\n\t\t\"common\": \"common\",\n\t\t\"text\": \"text\",\n\t\t\"clear\": \"Clear\",\n\t\t\"clear-value\":\"Values\",\n\t\t\"clear-style\":\"Styles\",\n\t\t\"clear-conditional-formats\":\"Conditional formats\",\n\t\t\"clear-dropdown-editors\":\"Dropdowns and filters\",\n\t\t\"clear-comments\":\"Comments\",\n\t\t\"clear-all\":\"All\",\n\t\t\"image\": \"Image\",\n\t\t\"add-image-cell\":\"Add to cell\",\n\t\t\"add-image-top\":\"Add above cells\",\n\t\t\"graph\": \"Graph\",\n\t\t\"add-sparkline\":\"Add to cell\",\n\t\t\"add-chart\":\"Add above cells\",\n\t\t\"data\": \"Data\",\n\t\t\"add-link\": \"Add link\",\n\t\t\"add-range\": \"Named ranges\",\n\t\t\"sort\": \"Sort\",\n\t\t\"sort-asc\": \"Sort A to Z\",\n\t\t\"sort-desc\": \"Sort Z to A\",\n\t\t\"view\": \"View\",\n\t\t\"freeze-columns\": \"Freeze/unfreeze columns\",\n\t\t\"freeze-rows\": \"Freeze/unfreeze rows\",\n\t\t\"hide-gridlines\": \"Hide/show gridlines\",\n\t\t\"hide-headers\": \"Hide/show headers\",\n\t\t\"create-filter\": \"Create/remove filters\",\n\t\t\"add-dropdown\": \"Add dropdown\",\n\t\t\"lock-cell\": \"Lock/unlock cell\",\n\t\t\"print\": \"Print\",\n\t\t\"add-comment\":\"Comment\"\n\t},\n\ttable:{\n\t\t\"math-error\":\"#ERROR!\",\n\t\t\"math-ref-error\":\"#REF!\",\n\t\t\"format-error\":\"INCORRECT FORMAT\"\n\t},\n\tliveEditor:{\n\t\t\"edit\":\"Edit:\"\n\t},\n\tformats:{\n\t\t\"dateFormat\": \"mm/dd/yyyy\",\n\t\t\"timeFormat\": \"hh:mm AM/PM\",\n\t\t\"longDateFormat\": \"dd mmmm yyyy\",\n\t\t\"fullDateFormat\": \"mm/dd/yyyy hh:mm AM/PM\",\n\t\t\"parseDateTime\": \"%m/%d/%Y %G:%i:%s\",\n\t\t\"parseDate\": \"%m/%d/%Y\",\n\t\t\"currencies\": [\n\t\t\t\"{obj} â¬\",\n\t\t\t\"Â¥{obj}\",\n\t\t\t\"R$ {obj}\",\n\t\t\t\"{obj} rub.\"\n\t\t]\n\t}\n};\n","webix.protoUI({\n\tname: \"ssheet-align\",\n\t$cssName:\"richselect\",\n\t$init: function(config){\n\t\tconfig.options =  {\n\t\t\tview:\"datasuggest\",\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-icons\",\n\t\t\t\ttooltip: {\n\t\t\t\t\ttemplate:\"#tooltip#\"\n\t\t\t\t},\n\t\t\t\txCount:3, yCount:1\n\t\t\t},\n\t\t\tdata: config.data\n\t\t};\n\t}\n},webix.ui.richselect);","webix.protoUI({\n\tname: \"ssheet-borders-suggest\",\n\tdefaults:{\n\t\twidth: 300\n\t},\n\t$init: function(config){\n\t\tconfig.body = {\n\t\t\tmargin: 6,\n\t\t\tcols:[\n\t\t\t\t{ view: \"ssheet-icons\", scroll: false, select: true,\n\t\t\t\t\txCount: 4,\n\t\t\t\t\tyCount: 2,\n\t\t\t\t\ttooltip: {\n\t\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\t\treturn webix.i18n.spreadsheet.tooltips[\"borders-\"+obj.id];\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\ton:{\n\t\t\t\t\t\tonAfterSelect: function(){\n\t\t\t\t\t\t\tvar suggest = this.getParentView().getParentView();\n\t\t\t\t\t\t\tsuggest.updateMasterValue(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\tvar css = \"webix_ssheet_button_icon webix_ssheet_icon ssi-borders-\"+obj.value;\n\t\t\t\t\t\treturn \"<span class='\"+css+\"'></span>\";\n\t\t\t\t\t},\n\t\t\t\t\tdata: config.data\n\t\t\t\t},\n\t\t\t\t{ view: \"ssheet-separator\"},\n\t\t\t\t{\n\t\t\t\t\trows:[\n\t\t\t\t\t\t{ view: \"ssheet-color\", css: config.css, name: config.name, width: 68,\n\t\t\t\t\t\t\tvalue: webix.skin.$name == \"contrast\" ? \"#ffffff\" : \"#000000\",\n\t\t\t\t\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[\"borders-color\"],\n\t\t\t\t\t\t\ttitle: \"<span class='webix_icon wxi-pencil'></span>\",\n\t\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\t\tonChange: function(){\n\t\t\t\t\t\t\t\t\tvar suggest = this.getParentView().getParentView().getParentView();\n\t\t\t\t\t\t\t\t\tsuggest.updateMasterValue(false);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"richselect\", css:\"webix_ssheet_border_type\", value:\"thin\", suggest:{\n\t\t\t\t\t\t\t\tfitMaster:false,\n\t\t\t\t\t\t\t\twidth:130,\n\t\t\t\t\t\t\t\tcss: \"webix_ssheet_suggest\",\n\t\t\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\t\t\ttemplate:\"<div class='webix_ssheet_border webix_ssheet_border_#id#'></div>\",\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdata:[\n\t\t\t\t\t\t\t\t\t{ id:\"thin\" },\n\t\t\t\t\t\t\t\t\t{ id:\"medium\" },\n\t\t\t\t\t\t\t\t\t{ id:\"thick\" },\n\t\t\t\t\t\t\t\t\t{ id:\"dashed\" }, \n\t\t\t\t\t\t\t\t\t{ id:\"dotted\" },\n\t\t\t\t\t\t\t\t\t{ id:\"double\" }\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{ }\n\t\t\t\t\t]\n\t\t\t\t}\n\n\t\t\t]\n\t\t};\n\t},\n\tupdateMasterValue: function(hide){\n\t\tvar value = this.getValue();\n\t\tvar master = webix.$$(this.config.master);\n\t\tmaster.setValue(value);\n\t\tif(hide)\n\t\t\tthis.hide();\n\t},\n\tsetValue: function(value){\n\t\tif(value[0])\n\t\t\tthis.getList().select(value[0]);\n\t\tif(value[1])\n\t\t\tthis.getColorView().setValue(value[1]);\n\t\tif(value[2])\n\t\t\tthis.getTypeView().setValue(value[2]);\n\t},\n\tgetValue: function(){\n\t\treturn [this.getList().getSelectedId(), this.getColorView().getValue()||\"\", this.getTypeView().getValue()||\"\"];\n\t},\n\tgetList: function(){\n\t\treturn this.getBody().getChildViews()[0];\n\t},\n\tgetColorView: function(){\n\t\treturn this.getBody().getChildViews()[2].getChildViews()[0];\n\t},\n\tgetTypeView: function(){\n\t\treturn this.getBody().getChildViews()[2].getChildViews()[1];\n\t},\n\tgetItemText:function(){\n\t\treturn \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-borders-all'>\";\n\t}\n},webix.ui.suggest);\n\nwebix.protoUI({\n\tname: \"ssheet-borders\",\n\t$cssName: \"richselect\",\n\t$init: function(config){\n\t\tconfig.options = {\n\t\t\tview: \"ssheet-borders-suggest\",\n\t\t\tfitMaster: false,\n\t\t\tdata: config.data\n\t\t};\n\n\t\tthis.$ready.push(webix.bind(function(){\n\t\t\tthis.getPopup().config.master = this.config.id;\n\t\t},this));\n\n\t},\n\tsetValue: function(value){\n\t\tif(webix.isArray(value)){\n\t\t\tif(!this.config.value || value[0] !=  this.config.value[0] || value[1] !=  this.config.value[1]){\n\t\t\t\tthis.getPopup().setValue(value);\n\t\t\t}\n\t\t\tthis.config.value = value;\n\t\t\tif (value[0])\n\t\t\t\tthis.callEvent(\"onChange\");\n\t\t}\n\t\treturn value;\n\t},\n\tgetValue: function(){\n\t\treturn  this.getPopup().getValue().join(\",\");\n\t},\n\tgetList: function(){\n\t\treturn this.getPopup().getBody().getChildViews()[0];\n\t},\n\tgetColorView: function(){\n\t\treturn this.getPopup().getBody().getChildViews()[1].getChildViews()[0];\n\t}\n},webix.ui.richselect);","// toolbar: color selector\nwebix.protoUI({\n\t$cssName: \"colorboard\",\n\tname: \"ssheet-colorboard\",\n\tdefaults:{\n\t\theight:202,\n\t\twidth:220,\n\t\tcss: \"webix_ssheet_colorboard\",\n\t\ttype:\"classic\",\n\t\tpalette: [\n\t\t\t[\"#000000\", \"#434343\", \"#666666\", \"#999999\", \"#b7b7b7\", \"#cccccc\", \"#d9d9d9\", \"#efefef\", \"#f3f3f3\", \"#ffffff\"],\n\t\t\t[\"#980000\", \"#ff0000\", \"#ff9900\", \"#ffff00\", \"#00ff00\", \"#00ffff\", \"#4a86e8\", \"#0000ff\", \"#9900ff\", \"#ff00ff\"],\n\t\t\t[\"#e6b8af\", \"#f4cccc\", \"#fce5cd\", \"#fff2cc\", \"#d9ead3\", \"#d0e0e3\", \"#c9daf8\", \"#cfe2f3\", \"#d9d2e9\", \"#ead1dc\"],\n\t\t\t[\"#dd7e6b\", \"#ea9999\", \"#f9cb9c\", \"#ffe599\", \"#b6d7a8\", \"#a2c4c9\", \"#a4c2f4\", \"#9fc5e8\", \"#b4a7d6\", \"#d5a6bd\"],\n\t\t\t[\"#cc4125\", \"#e06666\", \"#f6b26b\", \"#ffd966\", \"#93c47d\", \"#76a5af\", \"#6d9eeb\", \"#6fa8dc\", \"#8e7cc3\", \"#c27ba0\"],\n\t\t\t[\"#a61c00\", \"#cc0000\", \"#e69138\", \"#f1c232\", \"#6aa84f\", \"#45818e\", \"#3c78d8\", \"#3d85c6\", \"#674ea7\", \"#a64d79\"],\n\t\t\t[\"#85200c\", \"#990000\", \"#b45f06\", \"#bf9000\", \"#38761d\", \"#134f5c\", \"#1155cc\", \"#0b5394\", \"#351c75\", \"#741b47\"],\n\t\t\t[\"#5b0f00\", \"#660000\", \"#783f04\", \"#7f6000\", \"#274e13\", \"#0c343d\", \"#1c4587\", \"#073763\", \"#20124d\", \"#4c1130\"]\n\t\t]\n\t},\n\t$init:function(){\n\t\tthis.attachEvent(\"onSelect\", function(value){\n\t\t\tthis.getParentView().setMasterValue({ value:value });\n\t\t});\n\t}\n}, webix.ui.colorboard);\n\nwebix.protoUI({\n\t$cssName: \"richselect\",\n\tname: \"ssheet-color\",\n\tdefaults:{\n\t\tcss: \"webix_ssheet_color\",\n\t\ticon: \"wxi-menu-down\",\n\t\tsuggest:{\n\t\t\tborderless: true,\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-colorboard\"\n\t\t\t}\n\t\t}\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_color\";\n\t},\n\t$renderInput: function(config, divStart, id){\n\t\tvar color  = this.renderColor.call(this);\n\t\tdivStart = divStart.replace(/([^>]>)(.*)(<\\/div)/, function(match, p1, p2, p3){\n\t\t\treturn p1+config.title +color+p3;\n\t\t});\n\n\t\treturn webix.ui.colorpicker.prototype.$renderInput.call(this,config, divStart, id);\n\t},\n\t$setValue: function(value){\n\t\tvar popup =  webix.$$(this.config.popup.toString());\n\t\tvar colorboard = popup.getBody();\n\t\tvalue = value || \"\";\n\t\tcolorboard.setValue(value);\n\t\tthis.config.value = value;\n\t\tthis.getColorNode().style.backgroundColor = value;\n\t},\n\trenderColor: function(){\n\t\treturn \"<div class='webix_ssheet_cp_color' style='background-color:\"+this.config.value+\";'> </div>\";\n\t},\n\tgetColorNode: function(){\n\t\treturn this.$view.firstChild.firstChild.childNodes[1];\n\t},\n\t$renderIcon:function(){\n\t\treturn webix.ui.text.prototype.$renderIcon.apply(this,arguments);\n\t}\n},webix.ui.colorpicker);","\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0});var t,e={1:\"#ERROR\",2:\"#ERROR\",3:\"#REF!\"},r=function(){return(r=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function n(t,e,r){return r+64*e+64*t*4096}function o(t){return[t<2147483648?t>>18:t/262144&16777215,t>>6&4095,63&t]}function a(t){return t<2147483648?t>>18:t/262144&16777215}function s(t){return 63&t}function i(t,e,r){for(var n=o(t),a=n[0],s=n[1],i=o(e),u=i[0]-a,f=i[1]-s,h=0;h<=u;h++)for(var c=0;c<=f;c++)r(t+64*c+4096*h*64)}function u(t,e){for(var r,n,a,i,u,h,c,p,g=t.code,l=t.source,_=\"\",v=g.length,d=0;d<v;d+=3){switch(g[d]){case 5:var b=void 0;9===g[d+6]&&(b=e.pageName(s(g[d+7]))),_+=(-1!==(p=b||t.source.substr(g[d+1],g[d+2])).indexOf(\" \")?\"'\"+p+\"'\":p)+\"!\";break;case 7:_+=f(i=(r=o(g[d+4]))[0],h=r[1],g[d+5]);break;case 4:_+=l.substr(g[d+1],g[d+2]).toUpperCase();break;case 8:i=(n=o(g[d+4]))[0],h=n[1],u=(a=o(g[d+7]))[0],c=a[1],_+=f(i,h,g[d+5]),_+=\":\",_+=f(u,c,g[d+8]);break;case 9:break;case 2:_+=\"{{\"+l.substr(g[d+1],g[d+2])+\"}}\";break;case 3:_+=\"#REF!\";break;case 1:_+='\"'+l.substr(g[d+1],g[d+2])+'\"';break;default:_+=l.substr(g[d+1],g[d+2])}}return _}function f(t,e,r){var n=\"\";2&r&&(n+=\"$\");var o=\"\";for(e+=1;e>0;){var a=e%26;0===a&&(a=26),o=String.fromCharCode(64+a)+o,e=(e-a)/26}return n+=o,1&r&&(n+=\"$\"),n+=t+1}function h(t){return t<=122}function c(t){return t<=122?t>=65||35===t||36===t:t>191}function p(t){return t>=97}function g(t){var e=t.charCodeAt(0);return e>=48&&e<=57}function l(t,e){var r;do{e++,r=t.charCodeAt(e)}while(r>=48&&r<=57);return e}function _(t){return\" \"===t||\"\\t\"===t||\"\\n\"===t||\"\\r\"===t}function v(t,e){var r;do{r=t[++e]}while(_(r));return e}function d(t,e){if(\"<\"===t[e]){var r=t[e+1];\">\"!==r&&\"=\"!==r||e++}else\">\"===t[e]&&\"=\"===t[e+1]&&e++;return e+1}function b(e,r,n){for(var o=e.length,a=!0,s=r,i=!1,u=!1,f=!1,l=0;s<o;s++){var _=e[s];if(\"'\"!==_){if(!i){f=!0;var v=_.charCodeAt(0);if(c(v)){h(v)?p(v)&&(u=!0):a=!1,1==l&&l++;continue}if(g(_)){0==l&&l++;continue}break}}else{if(f)break;if(i){s++;break}i=!0}}var d=e[s],b=r,y=s-r;return i&&((y-=1+(\"'\"===e[s-1]?1:0))<0&&(y=0),b++,n=5),0===n&&(\":\"===d&&a?(n=8,u&&(t=!0)):\"!\"===d?n=\"#\"===e[b]?3:5:\"(\"===d?(function(t,e,r){var n=t.substr(e,r);return n.toUpperCase()!==n}(e,b,y)&&(t=!0),n=4):\"}\"===d?n=2:1===l&&a?(n=7,u&&(t=!0)):n=6),[b,y,s,n]}function y(t,e,r){for(var o=0,a=0,s=1,i=1,u=0,f=!1,h=e.length-1;h>=0;h--){var c=e[h].charCodeAt(0);36!==c?c<58?(a+=(c-48)*s,s*=10):(f||(s=1,o=a,a=0,f=!0,i+=1),a+=(c-(c>96?96:64))*s,s*=26):u+=i}t.push(9,n(o-1,a-1,r),u)}function m(e,r){var n,o,s=[];t=!1;for(var i,f=-1,h=0;h<e.length;h++){var p=e[h];if('\"'!=p){if(!(f>-1))if(\"{\"!=p||\"{\"!=e[h+1])if(\"'\"==p||c(p.charCodeAt(0))){var m=b(e,h,0),x=(I=m[0],P=m[1],m[2]),M=m[3],C=s.length;if(7!==M&&8!==M||5!==s[s.length-3])i=r.z,s.push(M,I,P);else{var E=\"'\"===e[I-2]?1:0,T=s[C-2],k=s[C-1];void 0===(i=r.page(e.substr(T,k)))&&(s.push(3,0,0),i=0),s.push(M,I-k-2*E-1,P+k+2*E+1)}if(h=x-1,6===M)r.name(s,e,r);else if(8===M){var O=s.length;if(y(s,e.substr(I,P),i),I=(n=b(e,h+2,0))[0],P=n[1],x=n[2],5===(M=n[3])&&(I=(o=b(e,x+1,0))[0],P=o[1],x=o[2],M=o[3]),7!==M){s[O-3]=7;continue}y(s,e.substr(I,P),i);var D=s[O+1],w=s[O+4];(D>w||a(D)>a(w))&&(s[O+1]=w,s[O+4]=D),s[O-1]+=P+1,h=x-1}else 7===M?y(s,e.substr(I,P),i):3!==M&&5!==M||h++}else if(_(p)){var N=v(e,h);s.push(12,h,N-h),h=N-1}else if(g(p)){var A=l(e,h);s.push(11,h,A-h),h=A-1}else{var R=d(e,h);s.push(10,h,R-h),h=R-1}else{var S=b(e,h+2,2),I=S[0],P=S[1],U=S[2];s.push(2,I,P),h=U+2-1}}else f>-1?(s.push(1,f+1,h-f-1),f=-1):f=h}var z={code:s,source:e,exec:null,broken:0,triggers:null};return t&&(z.source=u(z,r)),z}function x(t){return\"              \".substr(0,10-t.length)}var M=[\">\",\"<\",\"=\",\"+\"];function C(t){var e=function(t){for(var e=t.code,r=t.source,n=\"\",o=e.length,a=0;a<o;a+=3){switch(e[a]){case 4:n+=\"ctx.m.\"+r.substr(e[a+1],e[a+2]).toUpperCase();break;case 1:n+='\"'+r.substr(e[a+1],e[a+2])+'\"';break;case 2:n+='ctx.p(\"'+r.substr(e[a+1],e[a+2])+'\")';break;case 6:case 7:var s=void 0,i=void 0;if(10===e[a-3]?s=a-3:12===e[a-3]&&10===e[a-6]&&(s=a-6),10===e[a+6]?i=a+6:12===e[a+6]&&10===e[a+9]&&(i=a+9),s||i){var u=s?r[e[s+1]]:null,f=i?r[e[i+1]]:null;if(\"&\"==u||\"&\"==f){n+=\"(ctx.v(\"+e[a+4]+') === null ? \"\" : ctx.v('+e[a+4]+\"))\";break}if(-1!=M.indexOf(u)||-1!=M.indexOf(f)){n+=\"(ctx.v(\"+e[a+4]+\") === null ? 0 : ctx.v(\"+e[a+4]+\"))\";break}}n+=\"ctx.v(\"+e[a+4]+\")\";break;case 8:n+=\"ctx.r(\"+e[a+4]+\", \"+e[a+7]+\")\";break;case 10:if(1===e[a+2]){var h=r[e[a+1]];n+=\"&\"===h?'+\"\"+':\"=\"===h?\"==\":\";\"===h?\",\":h}else if(2===e[a+2]){h=r.substr(e[a+1],e[a+2]);n+=\"<>\"===h?\"!=\":h}else n+=r.substr(e[a+1],e[a+2]);break;case 11:n+=r.substr(e[a+1],e[a+2]);break;case 3:return\"\"}}return n}(t);if(!e)return t.broken=3,void(t.exec=null);try{t.exec=new Function(\"ctx\",\"return \"+e)}catch(e){t.broken=1,t.exec=null}}function E(t){var e=new Date(t.getFullYear(),0,0),r=t.valueOf()-e.valueOf()+60*(e.getTimezoneOffset()-t.getTimezoneOffset())*1e3;return Math.floor(r/864e5)}function T(t){var e=new Date(Math.round(86400*(t-25569)*1e3));return new Date(e.getTime()+6e4*e.getTimezoneOffset())}function k(t){return 25569+(t.getTime()-6e4*t.getTimezoneOffset())/864e5}function O(t){return!(!t&&0!==t||(t*=1,isNaN(t)))&&t}function D(t){for(var e=[],r=0;r<t.length;r++)e=e.concat(t[r]);return e}function w(t){return!t&&0!==t}function N(t){return t>0?Math.floor(t):Math.ceil(t)}function A(t){return t<0?Math.floor(t):Math.ceil(t)}var R=Object.freeze({__proto__:null,SUM:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0,n=D(t),o=0;o<n.length;o++){var a=O(n[o]);\"number\"==typeof a&&(r+=a)}return r},AVERAGE:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0,n=0,o=D(t),a=0;a<o.length;a++){var s=O(o[a]);\"number\"==typeof s&&(r+=s,n++)}return r/n},COUNT:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0,n=D(t),o=0;o<n.length;o++){var a=O(n[o]);\"number\"==typeof a&&r++}return r},COUNTA:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0,n=D(t),o=0;o<n.length;o++)n[o]&&1*n[o]!=0&&r++;return r},COUNTBLANK:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0,n=D(t),o=0;o<n.length;o++)0===n[o]||n[o]||r++;return r},MAX:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=-1/0,n=D(t),o=0;o<n.length;o++){var a=O(n[o]);\"number\"==typeof a&&a>r&&(r=a)}return r===-1/0?0:r},MIN:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=1/0,n=D(t),o=0;o<n.length;o++){var a=O(n[o]);\"number\"==typeof a&&a<r&&(r=a)}return r===1/0?0:r},PRODUCT:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=!1,n=1,o=D(t),a=0;a<o.length;a++){var s=O(o[a]);\"number\"==typeof s&&(r=!0,n*=s)}return r?n:null},SUMPRODUCT:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=t[0].length;for(var n in t)if(t[n].length!==r)return;var o=0;for(n=0;n<t[0].length;n++){var a=!1,s=1;for(var i in t){var u=O(t[i][n]);\"number\"==typeof u&&(s*=u,a=!0)}a&&(o+=s)}return o},SUMSQ:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0,n=D(t),o=0;o<n.length;o++){var a=O(n[o]);\"number\"==typeof a&&(r+=Math.pow(a,2))}return r},VARP:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=D(t),n=this.COUNT(r),o=this.AVERAGE(r),a=0,s=0;s<r.length;s++){var i=O(r[s]);\"number\"==typeof i&&(a+=Math.pow(i-o,2))}return a/n},STDEVP:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=D(t);return Math.sqrt(this.VARP(r))},POWER:function(t,e){var r=O(t),n=O(e);if(\"number\"==typeof r&&\"number\"==typeof n)return Math.pow(r,n)},QUOTIENT:function(t,e){var r=O(t),n=O(e);if(\"number\"==typeof r&&\"number\"==typeof n)return N(r/n)},SQRT:function(t){var e=O(t);if(\"number\"==typeof e&&e>=0)return Math.sqrt(e)},ABS:function(t){var e=O(t);if(\"number\"==typeof e)return Math.abs(e)},RAND:function(){return Math.random()},PI:function(){return Math.PI},INT:function(t){var e=O(t);if(\"number\"==typeof e)return Math.floor(e)},ROUND:function(t,e){var r=O(t),n=O(e)||0;if(\"number\"==typeof r&&\"number\"==typeof n)return parseFloat(r.toFixed(n))},ROUNDDOWN:function(t,e){var r=O(t),n=O(e)||0;if(\"number\"==typeof r&&\"number\"==typeof n)return Math.floor(r*Math.pow(10,n))/Math.pow(10,n)},ROUNDUP:function(t,e){var r=O(t),n=O(e)||0;if(\"number\"==typeof r&&\"number\"==typeof n)return Math.ceil(r*Math.pow(10,n))/Math.pow(10,n)},TRUNC:function(t){var e=O(t);if(\"number\"==typeof e)return N(e)},EVEN:function(t){var e=O(t);if(\"number\"==typeof e){var r=A(e);return r%2?r+Math.sign(e):r}},ODD:function(t){var e=O(t);if(\"number\"==typeof e){var r=A(e);return r%2?r:r+Math.sign(e)}}});var S=Object.freeze({__proto__:null,CONCATENATE:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return D(t).join(\"\")},LEFT:function(t,e){return w(t)?\"\":t.toString().substring(0,e)},MID:function(t,e,r){return w(t)?\"\":t.toString().substring(e,e+r)},RIGHT:function(t,e){return w(t)?\"\":t.toString().substring(t.length-e)},LOWER:function(t){return w(t)?\"\":t.toString().toLowerCase()},UPPER:function(t){return w(t)?\"\":t.toString().toUpperCase()},PROPER:function(t){if(w(t))return\"\";var e=t.toString().toLowerCase().split(\" \");for(var r in t=\"\",e)t+=(t?\" \":\"\")+e[r].substring(0,1).toUpperCase()+e[r].substring(1);return t},TRIM:function(t){return w(t)?\"\":t.toString().trim()},LEN:function(t){return w(t)?0:t.toString().length}});var I=Object.freeze({__proto__:null,DATE:function(t,e,r){return k(new Date(t,e-1,r))},TIME:function(t,e,r){return k(new Date(1900,0,1,t,e,r))},DAY:function(t){return T(t).getDate()},MONTH:function(t){return T(t).getMonth()+1},YEAR:function(t){return T(t).getFullYear()},HOUR:function(t){return T(t).getHours()},MINUTE:function(t){return T(t).getMinutes()},SECOND:function(t){return T(t).getSeconds()},NOW:function(){return k(new Date)},DATEDIF:function(t,e,r){if(\"D\"===r)return e-t;var n=T(t),o=T(e);switch(r){case\"Y\":return o.getFullYear()-n.getFullYear();case\"M\":return(s=12*(o.getFullYear()-n.getFullYear()))+o.getMonth()-n.getMonth();case\"D\":return Math.floor(e-t);case\"MD\":if((i=o.getDate()-n.getDate())<0){var a=new Date(n.getFullYear(),n.getMonth()+1,0).getDate();return o.getDate()+a-n.getDate()}return i;case\"YM\":var s;return(s=o.getMonth()-n.getMonth())<0?12+s:s;case\"YD\":var i;return(i=E(o)-E(n))<0?365+i:i}}});var P=Object.freeze({__proto__:null,IF:function(t,e,r){return t?e:r}}),U={number:R,string:S,date:I,other:P},z=r(r(r(r({},R),S),I),P);var F=Math.pow(10,8),V=function(){function t(t){var e=this;(t=t||{get:null,set:null})&&(this._getter=t.get,this._setter=t.set),this._parser=m,this._printer=C,this._parseContext={name:function(){},pageName:function(){return\"\"},pageObj:function(){return null},page:function(){return 0},z:0},this.$count=0,this._data=new Map,this._triggers=new Map,this._holders={},this._context={v:function(t){if(-1===t)throw new Error;var r=e._getter(t);return void 0===r?null:r},r:function(t,r){var n=[];return i(t,r,(function(t){return n.push(e._getter(t))})),n},m:z,e:function(t){throw t},p:function(t){return e.getPlaceholder(t)}}}return t.prototype.setValue=function(t,e,r,n){\"\"===e&&(e=null),this._removeTriggers(t,null),this._setter(t,e,r)&&(n||this.trigger(t))},t.prototype.clean=function(t){this._removeTriggers(t,null)},t.prototype.getValue=function(t){return this._getter(t)},t.prototype.setPlaceholder=function(t,e){var r=this;\"*\"===t?Object.entries(e).forEach((function(t){return r.setPlaceholder(t[0],t[1])})):(null===e?delete this._holders[t]:this._holders[t]=e,this.each((function(e,n){(function(t,e,r){for(var n=0;n<t.length;n+=3)if(2===t[n]&&e.substr(t[n+1],t[n+2])==r)return!0;return!1})(n.code,n.source,t)&&r.setMath(e,n.source,r._parseContext)})))},t.prototype.getPlaceholder=function(t){if(\"*\"===t)return this._holders;var e=this._holders[t];return void 0===e?null:e},t.prototype.setMath=function(t,e,r,n){var o=this._generate(e,r),a=this._setMathAt(t,o);n||this._execAndTrigger(a)},t.prototype.refresh=function(t){this._execAndTrigger(t)},t.prototype.getMath=function(t){return this._data.get(t)},t.prototype.trigger=function(t,e){var r=this._triggers.get(t);if(r){var n=!e;e||(e=new Set);for(var o=0;o<r.length;o++)e.add(r[o]);n&&this.triggerSet(e)}return null},t.prototype.triggerSet=function(t){for(var e=this,r=new Map;t.size;){var n=t.values(),o=!1;t:for(var a=n.next();!a.done;a=n.next()){var s=this._data.get(a.value),i=r.get(a.value);if(!i||(1==i&&(i=this._check_for_loops(a.value,s.triggers,r)),2!=i)){var u=s.triggers;if(u)for(var f=0;f<u.length;f++)if(t.has(u[f]))continue t;this._execAndTrigger(a.value,t),i||r.set(a.value,1),t.delete(a.value),o=!0}}if(!o)return void t.forEach((function(r){return e._errorAndTrigger(r,t)}))}},t.prototype._check_for_loops=function(t,e,r){var n=new Set;e.forEach((function(t){return n.add(t)}));for(var o=n.values(),a=o.next();!a.done;a=o.next()){if(a.value==t)return r.set(t,2),2;var s=r.get(a.value);if(s&&s>1)return r.set(t,s),s;var i=this._data.get(a.value);i&&i.triggers&&i.triggers.forEach((function(t){return n.add(t)}))}return r.set(t,3),3},t.prototype._setMathAt=function(t,e){if(this._removeTriggers(t,e)){if(e.triggers)if(-1===e.triggers.indexOf(t))for(var n=0;n<e.triggers.length;n++){var o=e.triggers[n],a=this._triggers.get(o);void 0===a&&(a=[],this._triggers.set(o,a)),a.push(t)}else e=r(r({},e),{broken:3});return this._data.set(t,e),t}},t.prototype._removeTriggers=function(t,e){var r=this._data.get(t);if(!r)return!0;if(r===e)return!1;var n=r.triggers;if(n&&3!==r.broken)for(var o=0;o<n.length;o++){var a=n[o],s=this._triggers.get(a);if(s){var i=s.findIndex((function(e){return e===t}));s.splice(i,1)}}return this._data.delete(t),!0},t.prototype.parse=function(t,e){return this._parser(t,e||this._parseContext)},t.prototype.exec=function(t,e){var r=this._generate(t,e);return this._exec(r)},t.prototype.each=function(t){var e=this;Array.from(this._data.keys()).forEach((function(r){return t(r,e._data.get(r))}))},t.prototype.setLogger=function(t){this._err_handler=t},t.prototype._setErr=function(t,r){return t.broken=2,r&&this._err_handler&&this._err_handler(r),e[t.broken]},t.prototype._exec=function(t){if(t.broken>0&&2!==t.broken)return e[t.broken];try{var r=t.exec(this._context);return t.broken=0,\"number\"==typeof r?isFinite(r)?Math.round(r*F)/F:this._setErr(t):r}catch(e){return this._setErr(t,e)}},t.prototype.toString=function(t,e){return u(t,e||this._parseContext)},t.prototype.regenerate=function(t,e,n){var o=this;n=r({},n||this._parseContext),Array.from(this._data.keys()).forEach((function(r){var a=!1,i=o._data.get(r),f=s(r);if(e&&f===t)o._removeTriggers(r,null);else{for(var h=0;h<i.code.length;h+=3)if(9===i.code[h]&&s(i.code[h+1])===t){a=!0;break}a&&(n.z=f,e?o.setMath(r,i.source,n):(i.source=u(i,n),i.code=o._parser(i.source,n).code))}}))},t.prototype.recalculate=function(t,e){var n=this;e=r({},e||this._parseContext);var o=new Set;this.each((function(r){if(t){var a=n._data.get(r);if(a.broken&&2!==a.broken)return e.z=s(r),void n.setMath(r,a.source,e)}o.add(r)})),this.triggerSet(o)},t.prototype._generate=function(t,e,r){var n=r||this._parser(t,e||this._parseContext);return this._printer(n),n.triggers=function(t){for(var e=[],r=t.code,n=r.length,o=0;o<n;o+=3){switch(r[o]){case 7:case 6:e.push(r[o+4]);break;case 8:i(r[o+4],r[o+7],(function(t){return e.push(t)}))}}return e.length?e:null}(n),n},t.prototype._execAndTrigger=function(t,e){this.$count+=1;var r=this._data.get(t);if(r){var n=this._exec(r);this._setter(t,n)&&this.trigger(t,e)}},t.prototype._errorAndTrigger=function(t,e){var r=this._data.get(t),n=this._setErr(r);this._setter(t,n)&&this.trigger(t,e)},t.prototype.debug=function(t){console.log(function(t){for(var e=t.code,r=t.source,n=\"\",o=e.length,a=0;a<o;a+=3){var s=e[a],i=void 0;switch(s){case 4:i=\"method\";break;case 1:i=\"text\";break;case 5:i=\"page\";break;case 2:i=\"holder\";break;case 6:i=\"name\";break;case 7:i=\"arg\";break;case 8:i=\"range\";break;case 9:i=\"data\";break;case 10:i=\"op\";break;case 11:i=\"number\";break;case 3:i=\"error\";break;case 12:i=\"extra\"}n+=9===s?\"              \"+e[a+1]+\" x \"+e[a+2]+\")\\n\":\"[\"+i+\"]\"+x(i)+r.substr(e[a+1],e[a+2])+\"\\n\"}return n}(this.parse(t)))},t.prototype.transpose=function(t,e,r,a){var s=this;a=a||this._parseContext;var i=o(t),u=i[0],f=i[1],h=i[2],c=[],p=new Map,g=new Map;Array.from(this._data.keys()).forEach((function(t){var i=o(t),l=i[0],_=i[1],v=i[2],d=s._data.get(t),b=s._transpose(d,u,f,e,r,a),y=t;if(v===h&&(_>=f||l>=u)&&(y=n(l>=u?l+e:l,_>=f?_+r:_,v)),d!==b||t!==y){if(g.set(t,b),v===h&&(r<0&&_>=f&&_<f-r||e<0&&l>=u&&l<u-e))return;p.set(y,b),c.push(y)}})),Array.from(p.keys()).forEach((function(t){return s._setMathAt(t,p.get(t))})),Array.from(g.keys()).forEach((function(t){p.has(t)||s._removeTriggers(t,null)}));for(var l=new Set,_=0;_<c.length;_++)l.add(c[_]);this.triggerSet(l)},t.prototype.transposeMath=function(t,e,r,n){return\"string\"==typeof t&&(t=this.parse(t,n)),this._transpose(t,-1,-1,e,r,n||this._parseContext).source},t.prototype._transpose=function(t,e,r,a,s,i){for(var f=!0,h=t.code,c=!(e<0||r<0),p=0;p<h.length;p+=3)if(7===h[p]){var g=o(h[p+4]),l=g[0],_=g[1],v=g[2];if(i.z!==v)continue;var d=h[p+5];if(!c&&3==d)continue;(c||0==(1&d))&&l>=e&&(f&&(h=[].concat(h),f=!1),((l+=a)<e||l<0)&&(h[p]=3)),(c||0==(2&d))&&_>=r&&(f&&(h=[].concat(h),f=!1),((_+=s)<r||_<0)&&(h[p]=3)),f||(h[p+4]=n(l,_,v)),p+=3}else if(8===h[p]){var b=h[p+5],y=h[p+8];if(!c&&3===b&&3===y)continue;var m=o(h[p+4]),x=m[0],M=m[1],C=(v=m[2],o(h[p+7])),E=C[0],T=C[1];if(i.z!==v)continue;a&&((c||0==(1&b))&&(a>0?x>=e:x>e)&&(f&&(h=[].concat(h),f=!1),(x+=a)<0&&(h[p]=3)),(c||0==(1&y))&&E>=e&&(f&&(h=[].concat(h),f=!1),(E+=a)<x&&(h[p]=3))),s&&((c||0==(2&b))&&(s>0?M>=r:M>r)&&(f&&(h=[].concat(h),f=!1),(M+=s)<0&&(h[p]=3)),(c||0==(2&y))&&T>=r&&(f&&(h=[].concat(h),f=!1),(T+=s)<M&&(h[p]=3))),f||(h[p+4]=n(x,M,v),h[p+7]=n(E,T,v)),p+=6}if(f)return t;var k={code:h,broken:t.broken,source:t.source,triggers:null,exec:null};return k=this._parser(u(k,i),i),this._generate(k.source,i,k)},t}();var Y=function(){function t(t,e,n){this._data=[],this._id=t,this._store=e,this._meta={},this._parseContext=r(r({},n),{z:t})}return t.prototype.getMeta=function(){return this._meta},t.prototype.setMeta=function(t){this._meta=r(r({},this._meta),t)},t.prototype.getID=function(){return this._id},t.prototype.cellID=function(t,e){return n(t,e,this._id)},t.prototype.getSize=function(){var t=this._data.length,e=0;return this._data.forEach((function(t){t&&t.length>e&&(e=t.length)})),[t,e]},t.prototype.getContext=function(){return this._parseContext},t.prototype.addRow=function(t,e){this._data.splice.apply(this._data,j(t,e)),this._store.transpose(n(t,0,this._id),e,0,this._parseContext)},t.prototype.removeRow=function(t,e){this._data.splice(t,e),this._store.transpose(n(t,0,this._id),-e,0,this._parseContext)},t.prototype.addColumn=function(t,e){var r=j(t,e);this._data.forEach((function(t){t&&t.splice.apply(t,r)})),this._store.transpose(n(0,t,this._id),0,e,this._parseContext)},t.prototype.removeColumn=function(t,e){this._data.forEach((function(r){r&&r.splice(t,e)})),this._store.transpose(n(0,t,this._id),0,-e,this._parseContext)},t.prototype.setCell=function(t,e,n){var o=this._data[t];o||(o=this._data[t]=[]);var a=o[e];o[e]=a?r(r(r({},a),n),{value:a.value}):n,void 0!==n.value&&this.setValue(t,e,n.value)},t.prototype.setValue=function(t,e,r,o){\"string\"==typeof r&&r.length>1&&\"=\"===r[0]?this._store.setMath(n(t,e,this._id),r.substr(1),this._parseContext):this._store.setValue(n(t,e,this._id),r,o)},t.prototype.getCell=function(t,e,r){var n=this._data[t],o=n?n[e]:null;return o||!r?o:(n||(n=this._data[t]=[]),(o=n[e])||(o=n[e]={value:\"\"}),o)},t.prototype.getValue=function(t,e,r){if(r){var o=this._store.getMath(n(t,e,this._id));if(o)return\"=\"+o.source}var a=this.getCell(t,e,!1);return a?a.value:null},t.prototype.getRange=function(t,e,r,n){for(var o=[],a=t;a<=r;a++)for(var s=e;s<=n;s++)o.push(this.getValue(a,s,!1));return o},t.prototype.getCellRange=function(t,e,r,n){for(var o=[],a=t;a<=r;a++)for(var s=e;s<=n;s++)o.push(this.getCell(a,s));return o},t.prototype.eachCell=function(t){this._data.forEach((function(e,r){e&&e.forEach((function(e,n){e&&t(r,n,e)}))}))},t.prototype.serialize=function(t){var e=this,o=[];return this.eachCell((function(a,s,i){if(i=r({},i),t){var u=e._store.getMath(n(a,s,e.getID()));u&&(i.value=\"=\"+u.source)}o.push([a,s,i])})),o},t.prototype.parse=function(t,e){var o=this;this._store.each((function(t){s(t)===o._id&&o._store.clean(t)})),this._data=[];var a=new Set;t.forEach((function(t){var s=t[0],i=t[1],u=t[2],f=o._data[s];f||(f=o._data[s]=[]);var h=(u=f[i]=r({},u)).value;if(h)if(\"string\"==typeof h&&h.length>1&&\"=\"===h[0]){var c=n(s,i,o._id),p=h.substr(1);o._store.setMath(c,p,o.getContext(),!0),a.add(c)}else if(e){u.value=null;c=n(s,i,o._id);o._store.setValue(c,h,null,!0),o._store.trigger(c,a)}})),this._store.triggerSet(a)},t}();function j(t,e){for(var r=[t,0],n=0;n<e;n++)r.push(null);return r}var G=function(){function t(t,e,r){this._ranges=new Map,this._counter=1,this._rangeOrder=[],this._store=t,this._page=e,this._pageGetter=r}return t.prototype.get=function(t){return this._store.getMath(this._ranges.get(t))},t.prototype.toId=function(t){return this._ranges.get(t)},t.prototype.add=function(t,e){var r=this._ranges.get(t)||this._next_id();this._store.setMath(r,e,this._page.getContext()),this._ranges.set(t,r),this._refresh(t)},t.prototype.remove=function(t){this._ranges.delete(t),this._counter=1,this._refresh(t)},t.prototype.serialize=function(){var t=this;return Array.from(this._ranges.keys()).map((function(e){return[e,t.get(e).source]}))},t.prototype.parse=function(t){var e=this;t.forEach((function(t){return e.add(t[0],t[1])}))},t.prototype._refresh=function(t){var e=this,r=t.indexOf(\"!\"),n=\"\";-1!==r&&(n=t.substr(0,r),t=t.substr(r+1)),this._store.each((function(r,o){if(function(t,e,r,n){for(var o=0;o<t.length;o+=3)if(6===t[o]){if(\"\"!==r){if(5===t[o-3]&&e.substr(t[o-2],t[o-1])!==r)continue;return!0}if(e.substr(t[o+1],t[o+2])===n)return!0}return!1}(o.code,o.source,n,t)){var a=s(r);e._store.setMath(r,o.source,e._pageGetter(a).getContext())}}))},t.prototype._next_id=function(){for(;this._rangeOrder[this._counter];)this._counter++;return this._rangeOrder[this._counter]=!0,n(this._counter,0,this._page.getID())},t.prototype.renamePage=function(t,e){var r=this;t+=\"!\",e&&(e+=\"!\"),this._ranges.forEach((function(n,o,a){0===o.indexOf(t)&&(e?a.set(o.replace(t,e),n):r._store.clean(n),a.delete(o))}))},t}();var L=function(){function t(){var t=this;this._pages=[],this._pageNames=[],this._pageName2ID=new Map,this._pCounter=0,this._parseContext={page:function(e){return t._pageName2ID.get(e)},pageName:function(e){return t._pageNames[e]},pageObj:function(e){return t._pages[e]},name:function(e,r,n){var o,a=e.length,s=r.substr(e[a-2],e[a-1]);if(5===e[a-6]){var i=r.substr(e[a-5],e[a-4]);o=t._ranges.toId(i+\"!\"+s)||t._ranges.toId(s)}else o=t._ranges.toId(n.pageName(n.z)+\"!\"+s)||t._ranges.toId(s);e.push(9,o||-1,0)},z:0},this._store=new V({get:function(e){var r=o(e),n=r[0],a=r[1],s=r[2];return t._pages[s].getValue(n,a)},set:function(e,r,n){var a=o(e),s=a[0],i=a[1],u=a[2],f=t._pages[u].getCell(s,i,!0);return null==n&&(n=f.$format||0),f.$format=n,\"string\"==typeof r&&1!=n&&r&&parseFloat(r)==r&&(r=parseFloat(r)),f.value!==r&&(f.value=r,!0)}});var e=this._pages[63]=new Y(63,this._store,this._parseContext);this._ranges=new G(this._store,e,this.getPage.bind(this))}return t.prototype.addPage=function(t){for(;this._pages[this._pCounter];)this._pCounter++;var e=this._pCounter,r=new Y(e,this._store,this._parseContext);return this._pageName2ID.set(t,e),this._pages[e]=r,this._pageNames[e]=t,r},t.prototype.renamePage=function(t,e){if(t!==e){var r=this._pageName2ID.get(t);this._pageName2ID.delete(t),this._pageName2ID.set(e,r),this._pageNames[r]=e,this._ranges.renamePage(t,e);var n=this._pages[r].getContext();this._store.regenerate(r,!1,n)}},t.prototype.removePage=function(t){var e=this._pageName2ID.get(t),r=this._pages[e].getContext();this._pageName2ID.delete(t),this._pages[e]=this._pageNames[e]=null,this._pCounter=0,this._ranges.renamePage(t,null),this._store.regenerate(e,!0,r)},t.prototype.getPage=function(t){return\"string\"==typeof t&&(t=this._pageName2ID.get(t)),this._pages[t]},t.prototype.getRanges=function(){return this._ranges},t.prototype.getStore=function(){return this._store},t}();exports.D_COMMON=0,exports.D_STRING=1,exports.DataPage=Y,exports.DataStore=L,exports.Store=V,exports.T_ARG=7,exports.T_DATA=9,exports.T_ERROR=3,exports.T_METHOD=4,exports.T_NAME=6,exports.T_NUMBER=11,exports.T_OPERATOR=10,exports.T_PAGE=5,exports.T_PLACEHOLDER=2,exports.T_RANGE=8,exports.T_SPACE=12,exports.T_TEXT=1,exports.addMethod=function(t,e){z[t]=e},exports.column=function(t){return t>>6&4095},exports.fromId=o,exports.methodGroups=U,exports.methods=z,exports.page=s,exports.row=a,exports.str2id=function(t){var e=[];return y(e,t,0),e[1]},exports.str2pos=function(t){var e=[];return y(e,t,0),o(e[1]).slice(0,2)},exports.str2range=function(t){var e=[];t.split(\":\").map((function(t){return y(e,t,0)}));var r=o(e[1]),n=r[0],a=r[1],s=o(e[4]);return[n,a,s[0],s[1]]},exports.toId=n;\n//# sourceMappingURL=muon.js.map\n","import {addMethod} from \"@xbs/muon\";\n\nexport function init(){\n\taddMethod(\"IMAGE\", function(url){\n\t\treturn `<img class=\"webix_ssheet_cimage\" src=\"${webix.template.escape(url)}\">`;\n\t});\n\n\taddMethod(\"SPARKLINE\", function(arr, type, color1, color2){\n\t\tvar i, config = { type: type, color: color1, negativeColor:color2  },\n\t\t\twidth =  type == \"pie\"? 60: 150;\n\t\tfor(i =0 ; i < arr.length; i++)\n\t\t\tarr[i] = arr[i]||0;\n\t\treturn webix.Sparklines.getTemplate(config)(arr, { width:width, height: 35 });\n\t});\n\n\taddMethod(\"HYPERLINK\", function(url, text){\n\t\ttext = text || url;\n\t\treturn `<a target=\"blank\" href=\"${webix.template.escape(url)}\">${webix.template.escape(text)}</a>`;\n\t});\n}\n\nexport function getJsDateFromExcel(excelDate) {\n\tconst date = new Date(Math.round((excelDate - 25569) * 86400 * 1000));\n\treturn new Date(date.getTime() + date.getTimezoneOffset() * 60000);\n}\n\nexport function getExcelDateFromJs(jsDate) {\n\tconst returnDateTime = 25569 + ((jsDate.getTime() - (jsDate.getTimezoneOffset() * 60000)) / (86400 * 1000));\n\treturn returnDateTime.toString();\n}","import {getJsDateFromExcel, getExcelDateFromJs} from \"../mathematics/methods\";\n\nfunction getJsDate(value){\n\tif ((value || value === 0) && !(value instanceof Date) && !isNaN(value)){\n\t\tvalue = getJsDateFromExcel(value);\n\t}\n\treturn value;\n}\n\nfunction getExcelDate(value){\n\tif (value && value instanceof Date){\n\t\tvalue = getExcelDateFromJs(value);\n\t}\n\treturn value;\n}\n\nwebix.protoUI({\n\t$cssName: \"datepicker\",\n\tname: \"ssheet-datepicker\",\n\tgetValue:function(){\n\t\tconst value = webix.ui.datepicker.prototype.getValue.apply(this);\n\t\treturn getExcelDate(value) || \"\";\n\t},\n\t$prepareValue:function(value){\n\t\tvalue = getJsDate(value);\n\t\treturn webix.ui.datepicker.prototype.$prepareValue.apply(this, [value]);\n\t}\n}, webix.ui.datepicker);\n\nwebix.protoUI({\n\t$cssName: \"daterangepicker\",\n\tname: \"ssheet-daterangepicker\",\n\tgetValue:function(){\n\t\tlet value = webix.ui.datepicker.prototype.getValue.apply(this);\n\t\tif (value){\n\t\t\tvalue = webix.copy(value);\n\t\t\tvalue.start = getExcelDate(value.start);\n\t\t\tvalue.end = getExcelDate(value.end);\n\t\t}\n\t\treturn value || \"\";\n\t},\n\t$prepareValue:function(value){\n\t\tif (!value){\n\t\t\tvalue = { start:null, end:null };\n\t\t}\n\t\telse if (!value.start && !value.end)\n\t\t\tvalue = { start:value };\n\n\t\tvalue.start = getJsDate(value.start);\n\t\tvalue.end = getJsDate(value.end);\n\n\t\treturn webix.ui.daterangepicker.prototype.$prepareValue.apply(this, [value]);\n\t}\n}, webix.ui.daterangepicker);","webix.protoUI({\n\t$cssName: \"window\",\n\tname: \"ssheet-dialog\",\n\t$init: function(config){\n\t\tthis.$view.className += \" webix_ssheet_dialog\";\n\t\tthis.config.buttons = config.buttons;\n\t\tthis.config.close = true;\n\t},\n\tgetBodyConfig: function(content){\n\t\tcontent.borderless = true;\n\t\tvar elements = this.getFormElements(content);\n\t\tvar config = {\n\t\t\tview: \"form\",\n\t\t\tcss: \"webix_ssheet_form\",\n\t\t\tpadding: webix.skin.$active.layoutPadding.form,\n\t\t\telements: elements\n\t\t};\n\t\treturn config;\n\t},\n\tgetFormElements: function(content){\n\t\tvar elements;\n\t\tif(webix.isArray(content))\n\t\t\telements= content;\n\t\telse{\n\t\t\telements = [];\n\t\t\telements.push(content);\n\t\t}\n\t\tif(this.config.buttons){\n\t\t\telements.push({height:1});\n\t\t\telements.push( {\n\t\t\t\tmargin: 10,\n\t\t\t\tcols:[\n\t\t\t\t\t{},\n\t\t\t\t\t{view: \"button\", css: \"ssheet_cancel_button\", label: webix.i18n.spreadsheet.labels.cancel, autowidth:true, click: function(){\n\t\t\t\t\t\tvar parentView = this.getTopParentView();\n\t\t\t\t\t\tparentView.callEvent(\"onCancelClick\",[]);\n\t\t\t\t\t}},\n\t\t\t\t\t{view: \"button\", label: webix.i18n.spreadsheet.labels.save, hotkey: \"enter\", autowidth:true, click: function(){\n\t\t\t\t\t\tvar parentView = this.getTopParentView();\n\t\t\t\t\t\tparentView.callEvent(\"onSaveClick\",[]);\n\t\t\t\t\t}}\n\t\t\t\t]\n\t\t\t});\n\t\t}\n\t\treturn elements;\n\t},\n\tbody_setter: function(value){\n\t\tif(typeof value == \"object\"){\n\t\t\tif(webix.isUndefined(value.padding))\n\t\t\t\tvalue.padding = webix.skin.$active.layoutPadding.form;\n\t\t\tif(value.view == \"form\" && value.elements){\n\t\t\t\tvalue.elements = this.getFormElements(value.elements);\n\t\t\t\tif(!value.css)\n\t\t\t\t\tvalue.css = \"webix_ssheet_form\";\n\t\t\t}\n\t\t\telse\n\t\t\t\tvalue = this.getBodyConfig(value);\n\t\t}\n\n\t\treturn webix.ui.window.prototype.body_setter.call(this,value);\n\t},\n\tdefaults:{\n\t\tmove:true,\n\t\thead: \"Dialog\",\n\t\tbuttons: true,\n\t\tclose:true,\n\t\t//we need to retain focus in table area, so disabling the autofocusing feature\n\t\tautofocus:false,\n\t\twidth: 350\n\t}\n}, webix.ui.window, webix.IdSpace);\n\n\n\nwebix.protoUI({\n\t$cssName: \"datatable\",\n\tname: \"ssheet-dialog-table\",\n\t$init: function(config){\n\t\tif(!config.headerRowHeight)\n\t\t\tconfig.headerRowHeight = 34;\n\t\tthis.$view.className += \" webix_ssheet_dialog_table\";\n\t}\n},webix.ui.datatable);","webix.protoUI({\n\tname: \"ssheet-form-popup\",\n\tdefaults:{\n\t\tpadding:0,\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_form\";\n\t}\n}, webix.ui.suggest);\n\nwebix.protoUI({\n\tname: \"ssheet-form-suggest\",\n\tdefaults:{\n\t\tpadding:0,\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_suggest\";\n\t}\n}, webix.ui.suggest);\n\nwebix.protoUI({\n\t$cssName: \"colorpicker\",\n\tname: \"ssheet-colorpicker\",\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_colorpicker\";\n\t},\n\tdefaults:{\n\t\tsuggest:{\n\t\t\tborderless: true,\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-colorboard\",\n\t\t\t}\n\t\t}\n\t}\n}, webix.ui.colorpicker);","webix.protoUI({\n\tname:\"formlate\",\n\tsetValue:function(a){ return this.setHTML(a); },\n\tgetValue:function(){ return \"\"; }\n}, webix.ui.template);","webix.protoUI({\n\tname:\"ssheet-icons\",\n\t$cssName: \"dataview\",\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_dataview\";\n\t},\n\tdefaults:{\n\t\tborderless: true,\n\t\ttemplate: \"<span class='webix_ssheet_button_icon #css#' ></span>\",\n\t\ttype:{\n\t\t\twidth: 36,\n\t\t\theight: 36\n\t\t}\n\t}\n},webix.ui.dataview);","webix.protoUI({\n\tname: \"ssheet-suggest\",\n\tdefaults:{\n\t\tpadding:0,\n\t\tcss: \"webix_ssheet_suggest\"\n\t}\n},webix.ui.contextmenu);","const group = {\n\tvalue: null,\n\tset: function(method, master){\n\t\tif(!this.value){\n\t\t\tthis.start();\n\t\t\tmethod.call(master);\n\t\t\tthis.end();\n\t\t}\n\t\telse\n\t\t\tmethod.call(master);\n\t},\n\tstart(){\n\t\tthis.value = webix.uid();\n\t},\n\tend(){\n\t\tthis.value = null;\n\t}\n};\n\nexport default group;","export function init(view){\n\tconst events = [\n\t\t{name:\"onSheetAdd\", type:\"insert\"},\n\t\t{name:\"onSheetRemove\", type:\"remove\"},\n\t\t{name:\"onSheetRename\", type:\"rename\"},\n\t\t{name:\"onCellChange\"},\n\t\t{name:\"onStyleChange\"},\n\t\t{name:\"onAction\"},\n\t\t{name:\"onRowOperation\"},\n\t\t{name:\"onColumnOperation\"},\n\t\t{name:\"onAfterConditionSet\"},\n\t\t{name:\"onAfterRangeSet\"},\n\t\t{name:\"onAfterSpan\"},\n\t\t{name:\"onAfterSplit\"},\n\t\t{name:\"onAfterFilter\", view: \"cells\"},\n\t\t{name:\"onRowResize\", view: \"cells\"},\n\t\t{name:\"onColumnResize\", view: \"cells\"}\n\t];\n\n\tlet thread;\n\tfor (let i = 0; i < events.length; i++){\n\t\tconst handler = events[i];\n\t\t(handler.view ? view.$$(handler.view) : view).attachEvent(handler.name, function(name, newName){\n\t\t\tif (view._loading_data) return;\n\n\t\t\tlet params;\n\t\t\tif(handler.type)\n\t\t\t\tparams = handler.type == \"rename\" ? [handler.type, newName, name] : [handler.type, name];\n\t\t\telse\n\t\t\t\tparams = [\"update\", view.getActiveSheet()];\n\n\t\t\tclearTimeout(thread);\n\t\t\tthread = webix.delay(() => view.callEvent(\"onChange\", params));\n\t\t});\n\t}\n\n\tview.attachEvent(\"onChange\", function(){\n\t\tsave(view, \"all\");\n\t});\n}\n\nexport function save(view, name, data){\n\tvar save = view.config.save;\n\tvar url;\n\tif (!save) return;\n\n\tif(name == \"all\"){\n\t\tif(!save.all)\n\t\t\treturn;\n\t\tdata = { data: view.serialize({ sheets: true }) };\n\t\turl = save.all;\n\t}\n\telse{\n\t\turl = typeof save === \"string\" ? save + \"/\" + name : save[name];\n\t}\n\n\turl = webix.proxy.$parse(url);\n\n\tif(url){\n\t\tif (typeof url === \"function\")\n\t\t\treturn url(name, data);\n\n\t\tif (url.$proxy && url.save)\n\t\t\treturn url.save(view, data, null, null);\n\n\t\tvar ajax = webix.ajax();\n\t\tif (name === \"all\")\n\t\t\tajax.headers({ \"Content-type\" : \"application/json\" });\n\t\tajax.post(url, data);\n\t}\n}","export const decode = {};\nexport const encode = {};\n\nconst alpha = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\nfor (let i=1; i<703; i++){\n\tconst prefixIndex = parseInt((i-1)/alpha.length);\n\tconst str = (prefixIndex?alpha[prefixIndex-1]:\"\") + alpha[(i-1)%(alpha.length)];\n\n\tdecode[str] = i;\n\tencode[i] = str;\n}\n\nencode[0]=encode[1];\n\n\nexport function adress(text){\n\tconst size = (text.charCodeAt(1) < 59) ? 1 : 2;\n\tconst col = text.substr(0, size);\n\tconst row = text.substr(size);\n\n\treturn [row*1, decode[col]];\n}\n\nexport function range(text, view, page){\n\tconst nind = text.indexOf(\"!\");\n\tlet sheet = page || \"\";\n\n\t//parse sheet names\n\tif (nind !== -1){\n\t\tsheet = text.substr(0, nind);\n\t\tif (sheet[0] === \"'\")\n\t\t\tsheet = sheet.substr(1, sheet.length-2);\n\t\ttext = text.substr(nind+1);\n\t}\n\n\tlet parts = text.split(\":\");\n\tif (parts.length != 2){\n\t\tif(view){\n\t\t\tlet code = view.ranges.getCode(text, sheet);\n\t\t\tif(!code){\n\t\t\t\t// global named range\n\t\t\t\tcode = view.ranges.getCode(text, true);\n\t\t\t\tif(!code)\n\t\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst rangeParts = code.split(\"!\");\n\t\t\tif(rangeParts[0] != page || view.getActiveSheet())\n\t\t\t\tsheet = rangeParts[0].replace(/'/g,\"\");\n\t\t\tcode = rangeParts[1];\n\t\t\tparts = code.split(\":\");\n\t\t}\n\t\telse\n\t\t\treturn null;\n\t} \n\n\tconst d1 = adress(parts[0]);\n\tconst d2 = adress(parts[1]);\n\n\tif(d1[0] && d1[1] && d2[0] && d2[1])\n\t\treturn [d1[0], d1[1], d2[0], d2[1], sheet];\n}\n\n\nfunction escapeSheet(sheet){\n\treturn sheet.indexOf(\" \") == -1 ? sheet : `'${sheet}'`;\n}\n\nexport function toRange(x,y,x2,y2,sheet){\n\treturn (sheet?(escapeSheet(sheet)+\"!\"):\"\")+encode[y]+x+\":\"+encode[y2]+x2;\n}\nexport function toSheetRange(x,y,sheet){\n\treturn (sheet?(escapeSheet(sheet)+\"!\"):\"\")+x+\":\"+y;\n}\n\nexport function rangeObj(text, view){\n\tif (typeof text === \"object\") return text;\n\tconst a = range(text, view);\n\treturn { start:{ row:a[0], column:a[1]}, end:{ row:a[2], column:a[3] }, sheet: a[4] };\n}\n\nexport function eachRange(text, view, callback, data){\n\tconst range = rangeObj(text);\n\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\tfor (let column = range.start.column; column <=  range.end.column; column++) {\n\t\t\tcallback(view, {row: row, column: column}, data);\n\t\t}\n\t}\n}\n\nconst cellTest = /[A-Z]+[0-9]+/;\nexport function isRange(text){\n\tif(typeof text == \"string\"){\n\t\tconst cells = text.split(\":\");\n\t\tif(cells.length == 2){\n\t\t\tfor(let i = 0; i < cells.length; i++){\n\t\t\t\tconst parts = cells[i].split(\"!\");\n\t\t\t\tif(!cellTest.test(parts.pop()))\n\t\t\t\t\treturn;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t}\n}\n\nexport function changeRange(text,name,inc,start){\n\tlet updated = false;\n\n\tif(isRange(text)){\n\t\tlet [r1,c1,r2,c2,sheet] = range(text);\n\n\t\t//ranges like B2:A1\n\t\tif(r1 > r2)\n\t\t\t[r1, r2] = [r2, r1];\n\t\tif(c1 > c2)\n\t\t\t[c1, c2] = [c2, c1];\n\n\t\tif (name === \"row\" && start.row <= r2){\n\t\t\tif((inc < 0 && start.row < r1) || (inc > 0 && start.row <= r1))\n\t\t\t\tr1 += inc;\n\t\t\tr2 += inc;\n\n\t\t\tif(r2<r1)\n\t\t\t\treturn \"\";\n\n\t\t\tupdated = true;\n\t\t}\n\t\telse if (name === \"column\" && start.column <= c2){\n\t\t\tif((inc < 0 && start.column < c1) || (inc > 0 && start.column <= c1))\n\t\t\t\tc1 += inc;\n\t\t\tc2 += inc;\n\n\t\t\tif(c2<c1)\n\t\t\t\treturn \"\";\n\n\t\t\tupdated = true;\n\t\t}\n\t\tif(updated)\n\t\t\ttext = toRange(r1,c1,r2,c2,sheet);\n\t}\n\n\treturn text;\n}","export const toolbarSizes = {\n\twidth:38,\n\tmargin: 7,\n\tpaddingY: 1,\n\tsectorPadding: 5,\n\tsectorMargin: 0\n};\n\n// default styles for toolbar elements\nexport const defaultStyles = {\n\t\"color\"         : \"#666666\",\n\t\"background\"    : \"#ffffff\",\n\t\"font-family\"   : \"'PT Sans', Tahoma\",\n\t\"font-size\" : \"15px\",\n\t\"text-align\": \"left\",\n\t\"vertical-align\": \"middle\",\n\t\"white-space\": \"nowrap\",\n};\n\nexport function setSkinDefaults(){\n\tconst skin = webix.skin.$name;\n\tconst material = skin == \"material\" || skin == \"mini\";\n\ttoolbarSizes.width = webix.skin.$active.inputHeight+2;\n\ttoolbarSizes.titleHeight = webix.skin.$name == \"mini\" ? 18 : 20;\n\n\tdefaultStyles[\"font-family\"] = material ? \"'Roboto', sans-serif\" : \"'PT Sans', Tahoma\";\n\n\tif(skin == \"contrast\"){\n\t\tdefaultStyles.background = \"#393939\";\n\t\tdefaultStyles.color = \"#ffffff\";\n\t}\n}","import group from \"./undo_group\";\nimport {save} from \"./save\";\nimport {eachRange} from \"../helpers/column_names\";\nimport {defaultStyles} from \"../toolbar/defaults\";\n\n//do not change order, it will break server side compatibility\n//add new options to the end of this list\nexport const style_names = [\n\t\"color\",\"background\",\"text-align\",\n\t\"font-family\",\"font-size\",\n\t\"font-style\",\"text-decoration\",\"font-weight\",\n\t\"vertical-align\", \"wrap\", \"borders\", \"format\",\n\t\"border-right\", \"border-bottom\",\"border-left\", \"border-top\"\n];\n\nconst _style_map = {\n\t\"text-align\": {\n\t\tleft: () => \"justify-content:flex-start;\",\n\t\tcenter: () => \"justify-content:center;\",\n\t\tright: () => \"justify-content:flex-end;\"\t\t\n\t},\n\t\"vertical-align\": {\n\t\ttop: () => \"align-items:flex-start;\",\n\t\tmiddle: () => \"align-items:center;\",\n\t\tbottom: () => \"align-items:flex-end;\"\n\t},\n\twrap: {\n\t\twrap: ()=> {\n\t\t\treturn \"white-space: normal !important;\";\n\t\t}\n\t},\n\t\"border-left\": obj => {\n\t\treturn getBorderCss(\"border-left\", obj);\n\t},\n\t\"border-top\": obj => {\n\t\treturn getBorderCss(\"border-top\", obj);\n\t},\n\t\"border-right\": obj => {\n\t\treturn getBorderCss(\"border-right\", obj);\n\t},\n\t\"border-bottom\": obj => {\n\t\treturn getBorderCss(\"border-bottom\", obj);\n\t},\n\t\"font-weight\": obj => {\n\t\t//Roboto bold - font-weight:500 (looks better, than 700). Roboto is default font for material skins.\n\t\tif(obj[\"font-weight\"] == \"bold\"){\n\t\t\tconst family = obj[\"font-family\"] || defaultStyles[\"font-family\"];\n\t\t\treturn \"font-weight:\" + (family == \"'Roboto', sans-serif\" ? 500 : 700) + \";\";\n\t\t}\n\t\treturn \"\";\n\t}\n};\n\nfunction getBorderCss(pos, obj){\n\tlet border = obj[pos];\n\tif(border){\n\t\tlet [color, type] = border.split(\",\");\n\n\t\ttype = type || \"thin\";\n\t\tlet size = \"1px\";\n\t\tif(type == \"medium\")\n\t\t\tsize = \"2px\";\n\t\telse if(type == \"thick\" || type == \"double\")\n\t\t\tsize = \"3px\";\n\n\t\tif([\"thin\", \"medium\", \"thick\"].indexOf(type) != -1)\n\t\t\ttype = \"solid\";\n\n\t\treturn `${pos}: ${size} ${type} ${color} !important;`;\n\t}\n\treturn \"\";\n}\n\nconst border_checks = {\n\t\"border-left\":\t\tfunction(cell, area, mode){ return cell.column == area.start.column || mode ==\"no\"; },\n\t\"border-right\":\t\tfunction(cell, area, mode){ return cell.column == area.end.column || mode == \"all\" || mode ==\"no\"; },\n\t\"border-top\":\t\tfunction(cell, area , mode){ return cell.row == area.start.row || mode ==\"no\"; },\n\t\"border-bottom\":\tfunction(cell, area, mode){ return cell.row == area.end.row || mode == \"all\"|| mode ==\"no\"; }\n};\n\nconst _style_handlers = {\n\t\"borders\": function(view, style, value, cell){\n\t\tconst area = view.$$(\"cells\").getSelectArea();\n\t\tvalue = value.split(\",\");\n\t\tconst type = value[0];\n\t\tlet color = value[1];\n\t\tlet lineStyle = value[2];\n\n\t\tvar modes = [\"border-left\", \"border-right\", \"border-bottom\", \"border-top\"];\n\n\t\tif(type == \"top-bottom\"){\n\t\t\tmodes = [\"border-top\",\"border-bottom\"];\n\t\t}\n\t\telse if (type != \"no\" && type != \"all\" && type != \"outer\")\n\t\t\tmodes = [\"border-\"+type];\n\n\t\tfor (var i = 0; i < modes.length; i++){\n\t\t\tvar mode = modes[i];\n\t\t\tlet result = view.callEvent(\"onAction\", [\"check-borders\", {row:cell.row, column:cell.column, area, type, mode}]);\n\t\t\tif (result === true || border_checks[mode](cell, area, type)){\n\t\t\t\tconst border = type == \"no\" ? \"\" : `${color},${lineStyle}`;\n\t\t\t\tstyle = _updateStyle(view, style, mode, border, cell);\n\t\t\t}\n\t\t}\n\t\treturn style;\n\t}\n};\n\nvar sizeEl;\nexport function init(view){\n\tview.attachEvent(\"onStyleSet\", (name, value) => _applyStyles(view, name, value));\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data) => _serialize(view, data));\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, style) => {\n\t\tif(type == \"style\")\n\t\t\t_undoStyle(view, row, column, style);\n\t});\n\n\treset(view);\n\n\tif (!sizeEl)\n\t\tsizeEl = webix.html.create(\"DIV\", { style:\"visibility:hidden; position:absolute; top:0px; left:0px; height:auto;\"}, \"\");\n}\n\nfunction reset(view){\n\tview._styles = {};\n\tview._styles_cache = {};\n\tview._styles_max = 1;\n\n\tlet prefix = \".wss_\"+view.$index;\n\twebix.html.removeStyle(prefix);\n}\n\nexport function getStyle(view, cell){\n\tconst obj = view._mPage.getCell(cell.row-1, cell.column-1);\n\tconst span = view.$$(\"cells\").getSpan(cell.row, cell.column);\n\n\tif(span){\n\t\tconst spanStyles = span[5].split(\" \");\n\t\tfor (let i = 0; i < spanStyles.length; i++){\n\t\t\tconst spanStyle = view._styles[spanStyles[i]];\n\t\t\tif(spanStyle)\n\t\t\t\treturn spanStyle;\n\t\t}\n\t}\n\n\tif (obj && obj.style)\n\t\treturn view._styles[obj.style];\n\n\treturn null;\n}\n\nexport function getFormat(view, row, column){\n\tvar obj = view._mPage.getCell(row-1, column-1);\n\treturn (obj && obj.format) || \"\";\n}\n\n// undo\nfunction _undoStyle(view, row, column, style){\n\tvar cell = {row: row, column: column};\n\tsetStyle(view, cell, style);\n}\n\nfunction _serialize(view, obj){\n\tvar styles = [];\n\n\tfor (var key in view._styles_cache)\n\t\tstyles.push([view._styles_cache[key].id, key]);\n\n\tobj.styles = styles;\n}\n\nexport function addStyle(view, props, origin){\n\tvar style = {\n\t\tprops:styleFromText(\";;;;;;;;;;;;;;;\")\n\t};\n\n\tif (origin)\n\t\tfor (var key in origin.props)\n\t\t\tstyle.props[key] = origin.props[key];\n\n\tfor (let  key in props)\n\t\tstyle.props[key] = props[key];\n\n\n\tstyle.text = _styleToText(style);\n\tvar cache = view._styles_cache[style.text];\n\tif (cache)\n\t\treturn cache;\n\n\t_addStyle(view, style);\n\n\treturn style;\n}\n\nfunction _parse(view, obj){\n\tif (obj.styles)\n\t\tfor (let i=0; i < obj.styles.length; i++){\n\t\t\tvar styleObj = obj.styles[i];\n\t\t\tvar style = {\n\t\t\t\tid: styleObj[0],\n\t\t\t\ttext:styleObj[1],\n\t\t\t\tprops: styleFromText(styleObj[1])\n\t\t\t};\n\n\t\t\t_addStyle(view, style, true);\n\t\t}\n\n\tfor (let i = 0; i < obj.data.length; i++){\n\t\tvar [row, column, , css] = obj.data[i];\n\n\t\tif (css)\n\t\t\tupdate_style_data(view, row, column, view._styles[css]);\n\t}\n}\n\nfunction _applyStyles(view, name, value){\n\tgroup.set(function(){\n\t\tview.eachSelectedCell(function(cell){\n\t\t\t_applyCellStyles(view, cell, name, value);\n\t\t});\n\t});\n\tview.refresh();\n}\n\nfunction _applyCellStyles(view, cell, name, value){\n\tvar ostyle = getStyle(view, cell);\n\tvar nstyle = _updateStyle(view, ostyle, name, value, cell);\n\n\tif (nstyle && nstyle != ostyle)\n\t\t_setStyle(view, cell, nstyle, ostyle);\n}\n\nfunction _updateStyle(view, style, name, value, cell){\n\n\tif(_style_handlers[name]){\n\t\treturn _style_handlers[name](view, style, value, cell);\n\t}\n\n\tif (style && style.props[name] == value) return style;\n\n\tvar nstyle = { text:\"\", id:0, props: (style?webix.copy(style.props):{}) };\n\tnstyle.props[name] = value;\n\tnstyle.text = _styleToText(nstyle);\n\n\tvar cache = view._styles_cache[nstyle.text];\n\tif (cache)\n\t\treturn cache;\n\n\t_addStyle(view,nstyle);\n\n\treturn nstyle;\n}\n\nfunction update_style_data(view, row, column, style){\n\tconst obj = view._mPage.getCell(row-1, column-1, true);\n\tobj.style = style && style.id;\n\tobj.format = style && style.props.format;\n}\n\nexport function setStyle(view, cell, style){\n\tvar old = getStyle(view, cell);\n\treturn _setStyle(view, cell, style, old);\n}\n\nexport function setRangeStyle(view, range, style) {\n\teachRange(range, view, _setStyle, style);\n}\n\nexport function getTextSize(view, text, css, baseWidth){\n\tsizeEl.innerHTML = text;\n\tsizeEl.style.width = baseWidth ? baseWidth+\"px\" : \"auto\";\n\n\tsizeEl.className = \"webix_table_cell webix_cell \"+css;\n\tview._table.$view.appendChild(sizeEl);\n\n\tconst width = Math.max(0, sizeEl.offsetWidth+1);\n\tconst height = Math.max(0, sizeEl.offsetHeight+1);\n\n\tview._table.$view.removeChild(sizeEl);\n\tsizeEl.innerHTML = \"\";\n\n\treturn { width, height };\n}\n\nfunction _setStyle(view, cell, style, old){\n\tif(view.callEvent(\"onBeforeStyleChange\", [cell.row, cell.column, style, old])){\n\t\tgroup.set(()=>{\n\t\t\tconst format = style && style.props.format || null;\n\t\t\tconst oldFormat = old && old.props.format || null;\n\t\t\tconst formatChanged = format != oldFormat;\n\t\t\tif(!formatChanged || formatChanged && view.callEvent(\"onBeforeFormatChange\", [cell.row, cell.column, format, oldFormat])){\n\t\t\t\tupdate_style_data(view, cell.row, cell.column, style);\n\t\t\t\tview.callEvent(\"onStyleChange\", [cell.row, cell.column, style, old]);\n\n\t\t\t\tif(formatChanged)\n\t\t\t\t\tview.callEvent(\"onFormatChange\", [cell.row, cell.column, format, oldFormat]);\n\n\t\t\t\tview.saveCell(cell.row,cell.column);\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction _buildCssString(style) {\n\tlet css = \"\";\n\n\tfor (var key in style){\n\t\tif (style[key]){\n\t\t\tif( _style_map[key]){\n\t\t\t\tif(_style_map[key][style[key]])\n\t\t\t\t\tcss += _style_map[key][style[key]](style);\n\t\t\t\telse if(typeof  _style_map[key] == \"function\")\n\t\t\t\t\tcss += _style_map[key](style);\n\t\t\t}\n\t\t\telse\n\t\t\t\tcss+= key+\":\"+style[key]+\";\";\n\t\t}\n\t}\n\n\treturn css;\n}\n\nfunction _addStyle(view, style, silent){\n\tview._styles_cache[style.text] = style;\n\n\twhile (!style.id || view._styles[style.id])\n\t\tstyle.id = \"wss\"+(view._styles_max++);\n\tview._styles[style.id] = style;\n\n\tconst css = _buildCssString(style.props);\n\tlet prefix = \".wss_\"+view.$index;\n\twebix.html.addStyle(prefix+\" .\"+style.id+\"{\"+css+\"}\", prefix);\n\n\tif (!silent)\n\t\tsave(view, \"styles\", { name:style.id, text: style.text } );\n}\n\nfunction _styleToText(style){\n\tvar id = [];\n\tfor (var i=0; i<style_names.length; i++)\n\t\tid.push(style.props[style_names[i]]);\n\treturn id.join(\";\");\n}\n\nexport function styleFromText(text){\n\tvar parts = text.split(\";\");\n\tvar props = {};\n\tfor (var i=0; i<style_names.length; i++)\n\t\tprops[style_names[i]] = parts[i];\n\treturn props;\n}\n\n\n\nexport function clearRangeStyle(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tlet style = getStyle(view,cell);\n\t\t\tif (style)\n\t\t\t\tsetStyle(view, cell, null);\n\t\t});\n\t});\n}\n\nexport function compactStyles(view){\n\tconst serialized = view.serialize();\n\tserialized.styles = removeUnusedStyles(serialized);\n\n\treset(view);\n\t_parse(view, serialized);\n}\n\nexport function removeUnusedStyles(serialized){\n\tconst data = serialized.data;\n\tconst styles = serialized.styles;\n\n\tconst used = {};\n\tfor (let i=0; i<data.length; i++){\n\t\tconst name = data[i][3];\n\t\tif (name)\n\t\t\tused[name] = 1;\n\t}\n\n\tconst newStyles = [];\n\tfor(let i = 0; i<styles.length; i++){\n\t\tconst name = styles[i][0];\n\t\tif (used[name])\n\t\t\tnewStyles.push(styles[i]);\n\t}\n\n\treturn newStyles;\n}","import {addStyle, styleFromText} from \"./styles\";\nimport {getJsDateFromExcel} from \"../mathematics/methods\";\nimport group from \"./undo_group\";\n\nexport function init(view){\n\tview.attachEvent(\"onDataParse\", (data) => load(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data, config) => serialize(view, data, config));\n}\n\nexport let formatHelpers = {};\nexport let currencies = [];\n\nlet formats;\nlet formatsCount;\nlet formatSources;\nlet formatCache;\n\nfunction getCurrencySymbol(format){\n\treturn webix.template(format)(\"\");\n}\n\nexport function setDefaultFormats(){\n\tconst formatsLocale = webix.i18n.spreadsheet.formats;\n\n\tcurrencies = [ webix.i18n.price ];\n\tcurrencies = currencies.concat(webix.copy(formatsLocale.currencies));\n\n\tcurrencies = currencies.map(format => {\n\t\tconst id = getCurrencySymbol(format);\n\t\treturn {\n\t\t\tformat,\n\t\t\tid,\n\t\t\tvalue: id.trim()\n\t\t};\n\t});\n\n\tformats = {};\n\tformatsCount = 0;\n\tformatSources = {};\n\tformatCache = {};\n\tformatHelpers = {\n\t\tprice : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_price\";\n\t\t\t\treturn webix.i18n.priceFormat(value);\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: webix.i18n.priceSettings.decimalSize, \n\t\t\t\tsymbol: webix.i18n.priceFormat(\"\"),\n\t\t\t\tseparator: 1, negative:1, type: \"price\"\n\t\t\t}, getDelimiters(\"price\"))\n\t\t},\n\t\t\"int\" : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_int\";\n\t\t\t\treturn webix.i18n.numberFormat(value);\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: webix.i18n.decimalSize,\n\t\t\t\tseparator: 1, negative:1, type: \"int\",\n\t\t\t}, getDelimiters(\"int\"))\n\t\t},\n\t\tpercent : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_percent\";\n\t\t\t\treturn Math.round(value*100)+\"%\";\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: 0, separator: 0, negative:1, type: \"percent\",\n\t\t\t}, getDelimiters(\"percent\"))\n\t\t},\n\t\tdate : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_date\";\n\t\t\t\treturn format2code(formatsLocale.dateFormat, getDelimiters(\"date\"))(value);\n\t\t\t},\n\t\t\tvalues: { type:\"date\", date:formatsLocale.dateFormat }\n\t\t},\n\t\tstring : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_text\";\n\t\t\t\treturn value;\n\t\t\t},\n\t\t\tvalues: { type:\"string\" }\n\t\t}\n\t};\n\n\tfor(let i in formatHelpers){\n\t\tformatSources[i] = serializeFormat(formToValues(i, formatHelpers[i].values));\n\t\tformatCache[formatSources[i]] = i;\n\t}\n}\n\nexport function getDelimiters(type){\n\tif(type == \"price\")\n\t\treturn { groupSign:webix.i18n.priceSettings.groupDelimiter, decimalSign:webix.i18n.priceSettings.decimalDelimiter };\n\telse \n\t\treturn { groupSign:webix.i18n.groupDelimiter, decimalSign:webix.i18n.decimalDelimiter };\n}\n\nfunction serialize(view, data){\n\tconst formats = [];\n\tconst defaultFormats = [\"percent\", \"int\", \"price\", \"date\", \"string\"];\n\n\tfor(let i in formatSources){\n\t\tif(defaultFormats.indexOf(i) == -1) //exclude default formats\n\t\t\tformats.push([i,formatSources[i]]);\n\t}\n\tdata.formats = formats;\n}\n\nfunction load(view,data){\n\tvar i,\n\t\tformats = data.formats;\n\n\tif(formats)\n\t\tfor(i = 0; i < formats.length; i++)\n\t\t\tcreateFormatName(formats[i][1],formats[i][0]);\n}\n\nexport function getFormat(name){\n\treturn formatHelpers[name] ? formatHelpers[name].getFormat : formatHelpers[name];\n}\n\nexport function getFormatSource(name, toexcel){\n\tif(toexcel){\n\t\tlet parsed = parseFormat({values: formatHelpers[name].values, format: formatSources[name]});\n\t\treturn serializeFormat(parsed, true);\n\t}\n\telse\n\t\treturn formatSources[name];\n}\n\nfunction createFormatName(str, values){\n\tif (formatCache[str]) return formatCache[str];\n\n\tlet name = typeof(values) == \"object\" ? \"fmt\"+(formatsCount) : values;\n\tformatsCount++;\n\n\tformats[name] = str;\n\n\tif(typeof(values) == \"string\")\n\t\tvalues = formatToForm(str);\n\n\twebix.extend(\n\t\tvalues,\n\t\tgetDelimiters(\"custom\")\n\t);\n\n\tformatHelpers[name] = {\n\t\tgetFormat:format2code(str, {decimalSign: values.decimalSign, groupSign: values.groupSign}),\n\t\tvalues: values\n\t};\n\n\tformatSources[name] = str;\n\tformatCache[str] = name;\n\n\treturn name;\n}\n\nexport function addFormat(view, row, column, format, type){\n\tif(!type)\n\t\ttype = {format:format, type: \"custom\"};\n\tconst old = view.getStyle(row, column);\n\tconst nev = addStyle(view, { format:createFormatName(format, type) }, old);\n\tview.setStyle(row, column, nev);\n}\n\nexport function removeFormat(view, row, column){\n\tconst old = view.getStyle(row, column);\n\tconst nev = addStyle(view, { format:\"\" }, old);\n\tview.setStyle(row, column, nev);\n}\n\nfunction splitFormat(str){\n\tvar conditional = str.match(/.*\\[[><=].*/g);\n\tvar parts = str.split(\";\");\n\tif (!conditional){\n\t\tif (parts.length > 1){\n\t\t\tparts[0] = (parts.length > 2 ? \"[>0]\" : \"[>=0]\")+parts[0];\n\t\t\tparts[1] = \"[<0]\"+parts[1];\n\t\t\tif (parts[2])\n\t\t\t\tparts[2] = \"[=0]\"+parts[2];\n\t\t}\n\t}\n\treturn parts;\n}\n\nexport function format2code(str, delimiters){\n\tconst errorMessage = webix.i18n.spreadsheet.table[\"format-error\"];\n\tlet parts = splitFormat(str);\n\tlet code = [\"var spaces = \\\"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\\";\"];\n\tfor (var i=0; i<parts.length; i++){\n\t\tvar separated = separateFmt(parts[i]);\n\t\tcode.push(genCode(separated.condition, separated.color.toLowerCase(), separated.symbol, separated.fmt, i, parts.length > 0, delimiters));\n\t}\n\n\treturn new Function(\"val\",\"extra\", `try{ ${code.join(\"\\n\")} return val; } catch(err) { return \"${errorMessage}\"; }`);\n}\n\nfunction genCode(check, color, symbol, line, ind, isAbs, delimiters){\n\tvar str = \"\";\n\tif (check){\n\t\tif (!ind) str+=\"if\"; else str+=\"else if\";\n\t\tif (check[0] === \"=\") check = \"=\"+check;\n\t\tstr+=\"(val\"+check+\"){\";\n\t\tif (isAbs) str+=\"val = Math.abs(val);\";\n\t}\n\tif (color)\n\t\tstr+=\"extra.css = \\\"webix_ssheet_format_\"+color+\"\\\";\";\n\n\tstr += genFormatCode(line, delimiters, symbol);\n\n\treturn str+(check?\"}\":\"\");\n}\n\nconst dateTypes = {\n\t\"yy\": \"%y\",\n\t\"yyyy\": \"%Y\",\n\t\"m\": \"%n\",\n\t\"mm\": \"%m\",\n\t\"mmm\": \"%M\",\n\t\"mmmm\": \"%F\",\n\t\"mmmmm\":\"%F\", //not supported by webix\n\t\"d\": \"%j\",\n\t\"dd\": \"%d\",\n\t\"ddd\": \"%D\",\n\t\"dddd\": \"%l\"\n};\n\nconst timeTypes = {\n\t\"h\": \"%G\",\n\t\"hh\": \"%H\",\n\t\"m\": \"%i\", //not supported by webix\n\t\"mm\": \"%i\",\n\t\"s\": \"%s\", //not supported by webix\n\t\"ss\": \"%s\",\n\t\"AM/PM\": \"%A\"\n};\n\nconst dateOrder = Object.keys(dateTypes).sort((a, b) => b.length - a.length);\nconst timeOrder = Object.keys(timeTypes).sort((a, b) => b.length - a.length);\n\nfunction excelDateToWebix(text, lastDateType){\n\tconst typesOrder = [\n\t\t{name:\"date\", order:dateOrder, types:dateTypes}, \n\t\t{name:\"time\", order:timeOrder, types:timeTypes}\n\t];\n\n\t// \"m\"/\"mm\" format can be either date (%n/%m) or time (%i), so check last date type\n\tconst basedOnLast = /^m{1,2}(?!m)/.test(text);\n\tif(basedOnLast && lastDateType != \"date\")\n\t\ttypesOrder.reverse();\n\n\tfor(let i = 0; i < typesOrder.length; i++){\n\t\tconst type = typesOrder[i];\n\t\tfor(let j = 0; j < type.order.length; j++)\n\t\t\tif(text.indexOf(type.order[j]) == 0)\n\t\t\t\treturn {\n\t\t\t\t\tformat: type.types[type.order[j]],\n\t\t\t\t\tlength: type.order[j].length,\n\t\t\t\t\ttype: type.name\n\t\t\t\t};\n\t}\n}\n\nfunction genFormatCode(line, delimiters, symbol){\n\tif (!line)\n\t\treturn \"return val;\";\n\n\tlet str = \"return \\\"\\\"\";\n\n\tlet isQuote;\n\tlet fmt = \"\";\n\tlet multiply = 1;\n\tlet comma, numberPlaceholder, textPlaceholder;\n\tlet date = [];\n\tlet lastDateType = \"date\";\n\n\tlet symbolPos;\n\tif(symbol){\n\t\tconst currency = currencies.find(val => val.id == symbol);\n\t\tsymbolPos = \"left\";\n\n\t\tif(currency)\n\t\t\tsymbolPos = currency.format.split(\"{obj}\").findIndex(val => val) ? \"right\" : \"left\";\n\t}\n\n\tfor (var i=0; i<line.length; i++){\n\t\tvar betweenPlaceholders = placeholder(line[i-1])&&placeholder(line[i+1]);\n\t\tif (line[i] == \"\\\"\"){\n\t\t\tif(webix.isUndefined(isQuote))\n\t\t\t\tisQuote = i;\n\t\t\telse {\n\t\t\t\tstr += `+\"${line.substr(isQuote+1, i-isQuote-1)}\"`;\n\t\t\t\tisQuote = undefined;\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\tif (!webix.isUndefined(isQuote))\n\t\t\tcontinue;\n\t\tif(line[i] == \"%\")\n\t\t\tmultiply = multiply*100;\n\n\t\tif(/[a-zA-Z]/.test(line[i])){\n\t\t\tconst datePart = excelDateToWebix(line.substr(i), lastDateType);\n\t\t\tif(datePart){\n\t\t\t\tif(numberPlaceholder || textPlaceholder)\n\t\t\t\t\treturn \"throw \\\"unexpected number placeholder\\\";\";\n\t\t\t\tdate.push(datePart.format);\n\t\t\t\tstr += \"/*date*/\"; //update this value after date format is ready\n\t\t\t\tlastDateType = datePart.type;\n\t\t\t\ti += datePart.length-1;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\telse\n\t\t\t\tstr += `+\"${line[i]}\"`;\n\t\t}\n\t\telse if (line[i] === delimiters.decimalSign && betweenPlaceholders){\n\t\t\tfmt+= delimiters.decimalSign;\n\t\t}\n\t\telse if(line[i]==\"@\"){\n\t\t\tif(numberPlaceholder || date.length)\n\t\t\t\treturn \"throw \\\"unexpected number placeholder\\\";\";\n\t\t\tif(!textPlaceholder){\n\t\t\t\tstr+=\"+fmt\";\n\t\t\t\ttextPlaceholder = true;\n\t\t\t}\n\t\t\tfmt+=line[i];\t\t\n\t\t}\n\t\telse if (placeholder(line[i])){\n\t\t\tif(textPlaceholder || date.length)\n\t\t\t\treturn \"throw \\\"unexpected text placeholder\\\";\";\n\t\t\tif (!numberPlaceholder) {\n\t\t\t\tif(symbolPos == \"left\")\n\t\t\t\t\tstr += `+\"${symbol}\"`;\n\t\t\t\tstr+=\"+fmt\";\n\t\t\t\tif(symbolPos == \"right\")\n\t\t\t\t\tstr += `+\"${symbol}\"`;\n\t\t\t\tnumberPlaceholder=true;\n\t\t\t}\n\t\t\tfmt+=line[i];\n\t\t}\n\t\telse if (line[i] === delimiters.groupSign && betweenPlaceholders)\n\t\t\tcomma = true;\n\t\telse\n\t\t\tstr += `+\"${line[i]}\"`;\n\t}\n\n\tif(date.length){\n\t\t// 12-hour or 24-hour clock depends on AM/PM in format\n\t\tif(date.indexOf(\"%A\") != -1)\n\t\t\tdate = date.map(datePart => {\n\t\t\t\tswitch(datePart){\n\t\t\t\t\tcase \"%G\": return \"%g\";\n\t\t\t\t\tcase \"%H\": return \"%h\";\n\t\t\t\t\tdefault: return datePart;\n\t\t\t\t}\n\t\t\t});\n\n\t\tfor(let i = 0; i < date.length; i++)\n\t\t\tstr = str.replace(\"/*date*/\", `+dateParts[${i}]`);\n\t}\n\n\treturn `\n\t\t${date.length ? `val = (${getJsDateFromExcel})(val); var dateParts = webix.Date.dateToStr(\"${date.join(\";\")}\")(val).split(\";\");` : \"\"}\n\t\t${fmt ? `${numberFormat(fmt, comma, delimiters, multiply)};` : \"\"}\n\t\t${str};`;\n}\n\nfunction numberFormat(fmt, comma, delimiters, multiply){\n\tvar str = `if(/^@+$/.test(\"${fmt}\") || isNaN(val)){ var fmt = val; }else {`;\n\tvar decimal = delimiters.decimalSign;\n\tvar [left, right] = getParts(fmt, decimal);\n\tright = (right || \"\").split(\"\").reverse().join(\"\");\n\n\t//calculate indexes in mask\n\tvar lzeros = left.indexOf(\"0\"); if (lzeros>=0) lzeros = left.length - lzeros;\n\tvar lfills = left.indexOf(\"?\"); if (lfills>=0) lfills = left.length - lfills;\n\tvar rzeros = right.indexOf(\"0\"); if (rzeros>=0) rzeros = right.length - rzeros;\n\tvar rfills = right.indexOf(\"?\"); if (rfills>=0) rfills = right.length - rfills;\n\tvar rmax = right.length;\n\n\tstr += `\n\tval = val*${multiply};\n\tvar parts = val.toFixed(${rmax}).split(\".\");\n\tvar left = parts[0];\n\tvar lsize = left.length; \n\tvar right = parts[1] || \"\";\n\tif (left.length < ${lzeros}) left = \"0000000000\".substr(0, ${lzeros} - left.length)+left;\n\tif (left.length < ${lfills}) left = spaces.substr(0, 6*(${lfills} - left.length))+left;\n\tif (${comma}) {\n\t\tvar buf = [];\n\t\tvar start = 3;\n\t\twhile (lsize > start) { buf.push(left.substr(left.length-start,3)); start+=3; }\n\t\tvar last = left.substr(0,left.length-start+3);\n\t\tif (last !== \"-\")\n\t\t\tbuf.push(last);\n\t\telse\n\t\t\tbuf.push(\"-\"+buf.pop());\n\n\t\tleft = buf.reverse().join(\"${delimiters.groupSign}\");\n\t}\n\tif (right){\n\t\tvar zpoint = right.length-1;\n\t\twhile (zpoint >= ${rzeros}){\n\t\t\tif (right[zpoint] !== \"0\"){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tzpoint--;\n\t\t}\n\n\t\tif (zpoint <= right.length)\n\t\t\tright = right.substr(0, zpoint+1);\n\n\t\tif (right.length < ${rfills}){\n\t\t\tright += spaces.substr(0, 6*(${rfills} - right.length));\n\t\t}\n\t}\n\tvar fmt = left+(right?\"${decimal}\":\"\")+right;\n\t`;\n\n\treturn str+\"}\\n\";\n}\n\nfunction updateDecimals(fmt, inc, val){\n\tlet parsed = parseFormat(fmt);\n\tfor(let i = 0; i < parsed.length; i++){\n\t\tif(parsed[i].decimals){\n\t\t\tif(inc>0)\n\t\t\t\tparsed[i].right.placeholders += Array(inc+1).join(\"0\");\n\t\t\telse\n\t\t\t\tparsed[i].right.placeholders = parsed[i].right.placeholders.slice(0, inc);\n\t\t}\n\t\telse{\n\t\t\tconst withoutText = !parsed[i].left.text && !parsed[i].right.text;\n\t\t\tconst withoutPlaceholders = !parsed[i].left.placeholders && !parsed[i].right.placeholders;\n\t\t\t//check if cell value have decimals (not cell format)\n\t\t\tif(inc < 0 && withoutText && withoutPlaceholders && webix.rules.isNumber(val) && val.indexOf(\".\") > -1){\n\t\t\t\tparsed[i].left.placeholders = \"0\";\n\t\t\t\tparsed[i].right.placeholders = Array(val.split(\".\")[1].length).join(Array(inc+1).join(\"0\"));\n\t\t\t}\n\t\t\t//ignore text\n\t\t\telse if(inc > 0 && (parsed[i].left.placeholders || withoutText)){\n\t\t\t\tparsed[i].left.placeholders = parsed[i].left.placeholders || \"0\";\n\t\t\t\tparsed[i].right.placeholders = Array(inc+1).join(\"0\");\n\t\t\t\tparsed[i].decimals = true;\n\t\t\t}\n\t\t}\n\t\tparsed[i].decimals = parsed[i].right.placeholders.length > 0;\n\t}\n\n\treturn serializeFormat(parsed);\n}\n\nexport function changeAreaDecimals(view, inc, row, column){\n\tlet cells = getCells(view, row, column);\n\tif(cells.length == 0)\n\t\treturn;\n\n\tconst obj = view._mPage.getCell(cells[0].row-1, cells[0].column-1);\n\tconst oldFormat = obj && obj.format;\n\tconst value = (obj && obj.value) ? obj.value.toString() : \"\";\n\t\n\tif(webix.rules.isNumber(value) || oldFormat){\n\t\tgroup.set(function(){\n\t\t\tfor(let i = 0; i < cells.length; i++)\n\t\t\t\tchangeCellDecimals(view, inc, cells[i]);\n\t\t});\n\t\tview.refresh();\n\n\t\tlet format = getFormatName(view, cells[0].row, cells[0].column) || \"common\";\n\t\tformat = isCustom(format) ? \"custom\" : format;\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"format\", value:format}]);\n\t}\n}\n\nexport function changeCellDecimals(view, inc, cell){\n\tlet format;\n\tconst obj = view._mPage.getCell(cell.row-1, cell.column-1);\n\tconst oldFormat = obj && obj.format;\n\tconst value = (obj && obj.value) ? obj.value.toString() : \"\";\n\n\tif(oldFormat){\n\t\tformat = webix.copy({values:formatHelpers[oldFormat].values, format:getFormatSource(oldFormat)});\n\t\tformat.format = updateDecimals(format, inc, value);\n\n\t\tif(format.values && format.values.hasOwnProperty(\"zeros\"))\n\t\t\tformat.values.zeros = Math.max(format.values.zeros+inc, 0);\n\t}\n\t//add format for cell without format\n\telse{\n\t\tconst zeros = webix.rules.isNumber(value) && value.split(\".\")[1] ? Math.max(value.split(\".\")[1].length+inc, 0) : Math.max(inc, 0);\n\n\t\tformat = {values:{negative:1, zeros:zeros, separator:0, type:\"int\"}};\n\t\tformat.format = serializeFormat(formToValues(format.values.type, format.values));\n\t}\n\taddFormat(view, cell.row, cell.column, format.format, format.values);\n}\n\nexport function isCustom(name){\n\treturn name != \"common\" && (name.indexOf(\"fmt\") != -1 || formatHelpers[name].values.type == \"custom\");\n}\n\nexport function formToValues(type, formValues){\n\tif(type == \"string\")\n\t\treturn [{left:{text:\"@\"}}];\n\tif(formValues.date)\n\t\treturn [{left:{text:formValues.date}}];\n\n\tlet values = [{condition:\">=0\", left:{text:\"\"},right:{text:\"\"}}, {condition:\"<0\", left:{text:\"\"}, right:{text:\"\"}}];\n\twebix.extend(values, getDelimiters(type));\n\tvalues[0].right.placeholders = values[1].right.placeholders = formValues.zeros ? Array(formValues.zeros + 1).join(\"0\") : \"\";\n\tvalues[0].separator = values[1].separator = formValues.separator && type != \"percent\";\n\tvalues[0].left.placeholders = values[1].left.placeholders = values[0].separator ? \"#\"+values.groupSign +\"0\" : \"0\";\n\tvalues[0].decimals = values[1].decimals = formValues.zeros ? true : false;\n\tvalues[1].color = formValues.negative != 1 ? \"red\" : \"\";\n\tvalues[1].left.text += formValues.negative < 3 ? \"-\" : \"\";\n\tif(formValues.negative == 4)\n\t\tvalues[1].left.text += \"(\";\n\n\tif(type === \"percent\")\n\t\tvalues[0].right.text = values[1].right.text += \"%\";\n\telse if(type === \"price\"){\n\t\tconst symbolId = formValues.symbol;\n\t\tconst currency = currencies.find(val => val.id == symbolId);\n\t\tconst pos = currency.format.split(\"{obj}\").findIndex(val => val) ? \"right\" : \"left\";\n\n\t\tvalues[0][pos].symbol = values[1][pos].symbol = symbolId;\n\t}\n\n\tif(formValues.negative == 4)\n\t\tvalues[1].right.text += \")\";\n\n\treturn values;\n}\n\nfunction formatToForm(format){\n\tconst formatsLocale = webix.i18n.spreadsheet.formats;\n\tconst dates = [\n\t\tformatsLocale.dateFormat,\n\t\tformatsLocale.timeFormat,\n\t\tformatsLocale.fullDateFormat,\n\t\tformatsLocale.longDateFormat\n\t];\n\tconst form = {format, type:\"custom\"};\n\n\tif(dates.find(date => date == format)){\n\t\twebix.extend(form, {\n\t\t\ttype:\"date\", date:format\n\t\t}, true);\n\t}\n\telse{\n\t\tlet [first, second] = format.split(\";\");\n\t\tif(first && second){\n\t\t\tif(first.indexOf(\"[>=0]\") == 0 && second.indexOf(\"[<0]\") == 0){\n\t\t\t\tfirst = first.replace(\"[>=0]\", \"\");\n\t\t\t\tsecond = second.replace(\"[<0]\", \"\");\n\n\t\t\t\tlet red;\n\t\t\t\tif(second.indexOf(\"[red]\") == 0){\n\t\t\t\t\tsecond = second.replace(\"[red]\", \"\");\n\t\t\t\t\tred = true;\n\t\t\t\t}\n\n\t\t\t\tif(second[0] == \"-\"){\n\t\t\t\t\tsecond = second.substring(1);\n\t\t\t\t\tform.negative = red ? 2 : 1;\n\t\t\t\t}\n\t\t\t\telse if(red){\n\t\t\t\t\tif(second[0] == \"(\" && second[second.length-1] == \")\"){\n\t\t\t\t\t\tform.negative = 4;\n\t\t\t\t\t\tsecond = second.substring(1, second.length-1);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\tform.negative = 3;\n\t\t\t\t}\n\n\t\t\t\tif(form.negative && first == second){\n\t\t\t\t\tlet type = \"int\";\n\t\t\t\t\tlet priceBrackets = first.indexOf(\"[$\") != -1;\n\n\t\t\t\t\tif(first[first.length-1] == \"%\"){\n\t\t\t\t\t\tfirst = first.substring(0, first.length-1);\n\t\t\t\t\t\ttype = \"percent\";\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tfor(let i = 0; i < currencies.length; i++){\n\t\t\t\t\t\t\tconst currency = currencies[i].id;\n\t\t\t\t\t\t\tlet isPrice;\n\n\t\t\t\t\t\t\tif(priceBrackets){\n\t\t\t\t\t\t\t\tif(first.indexOf(`[$${currency}]`) != -1){\n\t\t\t\t\t\t\t\t\tfirst = first.replace(`[$${currency}]`, \"\");\n\t\t\t\t\t\t\t\t\tisPrice = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if(first.indexOf(currency) != -1){\n\t\t\t\t\t\t\t\tfirst = first.replace(currency, \"\");\n\t\t\t\t\t\t\t\tisPrice = true;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif(isPrice){\n\t\t\t\t\t\t\t\ttype = \"price\";\n\t\t\t\t\t\t\t\tform.symbol = currency;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tconst delimiters = getDelimiters(type);\n\n\t\t\t\t\tif(first.indexOf(\"#\"+delimiters.groupSign) == 0){\n\t\t\t\t\t\tfirst = first.replace(\"#\"+delimiters.groupSign, \"\");\n\t\t\t\t\t\tform.separator = 1;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst [integer, decimal] = first.split(delimiters.decimalSign);\n\t\t\t\t\tif((!integer || integer == \"0\") && (!decimal || /^[0]+$/.test(decimal))){\n\t\t\t\t\t\tform.type = type;\n\t\t\t\t\t\tform.delimiters = delimiters;\n\t\t\t\t\t\tform.zeros = decimal ? decimal.length : 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn form;\n}\n\nexport function serializeFormat(values, toExcel){\n\tlet fmt = \"\";\n\tfor(let i = 0; i < values.length; i++){\n\t\tif(values[i].condition)\n\t\t\tfmt += \"[\"+values[i].condition+\"]\";\n\t\tif(values[i].color)\n\t\t\tfmt += \"[\"+values[i].color+\"]\";\n\n\t\tif(values[i].left){\n\t\t\tif(values[i].left.text){\n\t\t\t\tlet leftText = values[i].left.text;\n\t\t\t\tfmt += leftText;\n\t\t\t}\n\t\t\tif(values[i].left.symbol)\n\t\t\t\tfmt += \"[$\"+values[i].left.symbol+\"]\";\n\t\t\tif(values[i].left.placeholders){\n\t\t\t\tlet leftPlaceholders = values[i].left.placeholders;\n\t\t\t\tfmt += toExcel ? leftPlaceholders.replace(values.groupSign, \",\") : leftPlaceholders;\n\t\t\t}\n\t\t}\n\n\t\tif(values[i].decimals)\n\t\t\tfmt += toExcel ? \".\" : values.decimalSign;\n\n\t\tif(values[i].right){\n\t\t\tif(values[i].right.placeholders)\n\t\t\t\tfmt += values[i].right.placeholders;\n\t\t\tif(values[i].right.symbol)\n\t\t\t\tfmt += \"[$\"+values[i].right.symbol+\"]\";\n\t\t\tif(values[i].right.text){\n\t\t\t\tlet rightText = values[i].right.text;\n\n\t\t\t\tfmt += rightText;\n\t\t\t}\n\t\t}\n\t\tif(i != values.length - 1)\n\t\t\tfmt += \";\";\n\t}\n\treturn fmt;\n}\n\nfunction parseFormat(fmt){\n\tconst fmtParts = fmt.format.split(\";\");\n\tlet values = [];\n\n\tfor(let i = 0; i < fmtParts.length; i++){\n\t\tlet separated = separateFmt(fmtParts[i]);\n\t\tvalues[i] = {color:separated.color, condition:separated.condition ,left:{}, right:{}};\n\n\t\tconst format = separated.fmt;\n\n\t\tvalues.groupSign = fmt.values.groupSign;\n\t\tvalues.decimalSign = fmt.values.decimalSign;\n\n\t\tif(format.indexOf(values.groupSign) > -1)\n\t\t\tvalues[i].separator = true;\n\n\t\tconst sepFmtParts = getParts(format, values.decimalSign);\n\n\t\tlet left = sepFmtParts[0];\n\t\tlet right = sepFmtParts[1] || \"\";\n\n\t\tif(sepFmtParts[1])\n\t\t\tvalues[i].decimals = true;\n\n\t\tleft = getFmtPartValues(left, \"left\", values.groupSign);\n\t\tright = getFmtPartValues(right, \"right\", values.groupSign);\n\n\t\tvalues[i].left = {\n\t\t\ttext: left.leftText,\n\t\t\tplaceholders: left.placeholders\n\t\t};\n\n\t\tvalues[i].right = {\n\t\t\ttext: left.rightText + right.rightText,\n\t\t\tplaceholders: right.placeholders\n\t\t};\n\n\t\tconst symbol = separated.symbol;\n\t\tif(symbol){\n\t\t\tconst currency = currencies.find(val => val.id == symbol);\n\t\t\tlet pos = \"left\";\n\n\t\t\tif(currency)\n\t\t\t\tpos = currency.format.split(\"{obj}\").findIndex(val => val) ? \"right\" : \"left\";\n\n\t\t\tvalues[i][pos].symbol = symbol;\n\t\t}\n\t}\n\treturn values;\n}\n\nfunction getFmtPartValues(fmtPart, type, groupSign){\n\tlet firstPlaceholder;\n\tif(type == \"left\"){\n\t\tfirstPlaceholder = fmtPart.match(/[#?0]/);\n\t\tfirstPlaceholder = firstPlaceholder ? firstPlaceholder.index : Infinity;\n\t}\n\n\tlet leftText = \"\";\n\tlet rightText = \"\";\n\tlet placeholders = \"\";\n\tfor(let k = 0; k < fmtPart.length; k++){\n\t\tif(!placeholder(fmtPart[k])){\n\t\t\tif(fmtPart[k] == groupSign && placeholder(fmtPart[k+1]) && placeholder(fmtPart[k-1])){\n\t\t\t\tplaceholders += fmtPart[k];\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(type == \"left\")\n\t\t\t\tif(k < firstPlaceholder){\n\t\t\t\t\tleftText += fmtPart[k];\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\trightText += fmtPart[k];\n\t\t}\n\t\telse\n\t\t\tplaceholders += fmtPart[k];\n\t}\n\treturn {leftText: leftText, rightText: rightText, placeholders: placeholders};\n}\n\nfunction separateFmt(line){\n\tlet color = \"\";\n\tlet check = \"\";\n\tlet symbol = \"\";\n\n\tlet start = line.indexOf(\"[\");\n\tif (start != -1){\n\t\tif (line[1].match(/[><=]/)){\n\t\t\tlet end = line.indexOf(\"]\");\n\t\t\tcheck = line.substr(start+1, end-start-1);\n\t\t\tline = line.substr(end+1);\n\t\t}\n\t}\n\n\tstart = line.indexOf(\"[$\");\n\tif(start != -1){\n\t\tlet end = start + line.substr(start).indexOf(\"]\");\n\t\tsymbol = line.substr(start+2, end-start-2);\n\t\tline = line.substr(0, start)+line.substr(end+1);\n\t}\n\n\tstart = line.indexOf(\"[\");\n\tif (start != -1){\n\t\tlet end = line.indexOf(\"]\");\n\t\tcolor = line.substr(start+1, end-start-1);\n\t\tline = line.substr(end+1);\n\t}\n\treturn {condition:check, color, symbol, fmt:line};\n}\n\nfunction getCells(view, row, column){\n\tif(row && column){\n\t\tif (typeof row === \"object\" && typeof column === \"object\"){\n\t\t\tlet cells = [];\n\t\t\tfor (let r = row.row; r<=column.row; r++)\n\t\t\t\tfor (let c = row.column; c<=column.column; c++)\n\t\t\t\t\tcells.push({row: r, column: c});\n\t\t\treturn cells;\n\t\t}\n\t\telse\n\t\t\treturn [{row: row, column: column}];\n\t}\n\telse\n\t\treturn view.getSelectedId(true);\n}\n\nfunction placeholder(val){\n\treturn val === \"0\" || val === \"#\" || val === \"?\";\n}\n\nfunction getParts(str, decimal){\n\t// it is nessesary to use \"/\" before decimal to escape regex special characters\n\tconst match = str.match(\"[#?0][/\"+decimal+\"][#?0]\");\n\tif(match)\n\t\treturn [str.substring(0, match.index+1), str.substring(match.index+2)];\n\telse\n\t\treturn [str];\n}\n\n//simple check: take into account only first condition\nexport function checkFormat(format, type, checkTime){\n\tformat = format && format.fmt ? format.fmt : getFormatSource(format);\n\tif(!format) return;\n\tconst parts = splitFormat(format);\n\tconst separated = separateFmt(parts[0]).fmt;\n\n\tlet quot;\n\tif(separated)\n\t\tfor(let i = 0; i < separated.length; i++){\n\t\t\tif(separated[i] == \"\\\"\")\n\t\t\t\tquot = !quot;\n\t\t\tif(quot) continue;\n\n\t\t\tif(type == \"date\" && /[a-zA-Z]/.test(separated)){\n\t\t\t\tconst datePart = excelDateToWebix(separated.substr(i), \"date\");\n\t\t\t\tif(datePart){\n\t\t\t\t\tif(checkTime){\n\t\t\t\t\t\tif(datePart.type == \"time\")\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(type == \"string\" && separated[i] == \"@\")\n\t\t\t\treturn true;\n\t\t}\n}\n\nexport function getFormatName(view, row, col){\n\tconst item = view._mPage.getCell(row-1, col-1);\n\treturn (item && item.format) || null;\n}\n\nexport function isDateInvalid(value){\n\treturn value < -99974430.925 || value > 100025569.125;\n}\n\nexport function getDateEditFormat(view, row, col){\n\tconst formatName = getFormatName(view, row, col);\n\tconst locale = webix.i18n.spreadsheet.formats;\n\tconst isTime = checkFormat(formatName, \"date\", true);\n\n\treturn webix.Date.dateToStr( locale[isTime ? \"parseDateTime\" : \"parseDate\"] );\n}\n\nexport function getFormatFromData(data, arr){\n\tconst styleName = arr[3];\n\tlet fmt;\n\tif(styleName){\n\t\tlet style = data.styles.find(arr => arr[0] == styleName);\n\t\tif(style){\n\t\t\tstyle = style[1];\n\t\t\tconst fmtName = styleFromText(style).format;\n\t\t\tif(fmtName){\n\t\t\t\tif(data.formats)\n\t\t\t\t\tfmt = data.formats.find(arr => arr[0] == fmtName);\n\n\t\t\t\tif(fmt)\n\t\t\t\t\tfmt = fmt[1];\n\t\t\t\telse\n\t\t\t\t\tfmt = getFormatSource(fmtName); //default formats (int, percent, etc.)\n\t\t\t}\n\t\t}\n\t}\n\treturn fmt;\n}","import {getFormatName, getFormatSource} from \"../operations/formats\";\n\nexport function isChar(char) {\n\tconst code = char.charCodeAt(0);\n\treturn code <= 122 ? code >= 65 || code === 35 || code === 36 : code > 191;\n}\n\nexport function getLastCharIndex(str){\n\tfor(let i = str.length - 1; i >= 0; i--){\n\t\tif(!isChar(str[i]))\n\t\t\treturn i+1;\n\t}\n}\n\nfunction isNumber(char){\n\tvar code = char.charCodeAt(0);\n\treturn code>=48 && code<=57;\n}\n\nfunction getWord(formula, i, passive){\n\tvar max = formula.length;\n\tvar sheet = passive;\n\tvar quotes = false;\n\n\tfor(var j=i; j<max; j++){\n\t\tvar key =  formula[j];\n\t\tif (key === \"'\"){\n\t\t\tquotes = !quotes;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!quotes){\n\t\t\tif (key == \"!\"){\n\t\t\t\tif(formula[i] == \"#\") //error\n\t\t\t\t\tcontinue;\n\t\t\t\telse{\n\t\t\t\t\t//multi-sheet math\n\t\t\t\t\tsheet = formula.substr(i, j-i);\n\t\t\t\t\tif (sheet[0] === \"'\")\n\t\t\t\t\t\tsheet = sheet.substr(1, sheet.length-2);\n\t\t\t\t\ti=j+1;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (!isChar(key) && !isNumber(key)){\n\t\t\t\treturn [formula.substr(i, j-i), j, i, sheet];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn [formula.substr(i), j, i, sheet];\n}\n\nvar operand = /^[A-Z$]+[0-9]+$/;\nfunction isPosition(text){\n\treturn operand.test(text);\n}\n\nexport function position(word){\n\tvar row = 0, sum = 0, x = 1, mode = 1, flags = 0;  \n\tvar chars = false;\n\n\tfor (var j =word.length-1; j>=0; j--){\n\t\tvar key = word[j].charCodeAt(0);\n\t\tif (key === 36) {\n\t\t\tflags = flags+mode;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (key < 58){\n\t\t\t//numeric\n\t\t\tsum += (key - 48)*x;\n\t\t\tx *= 10;\n\t\t} else {\n\t\t\tif (!chars){\n\t\t\t\tx = 1; row = sum; sum = 0; chars = true; mode += 1;\n\t\t\t}\n\t\t\t//alpha\n\t\t\tsum += (key - 64)*x;\n\t\t\tx*=26;\n\t\t}\n\t}\n\n\t/*\n\t\t$X$Y => flags = 3\n\t\t$XY  => flags = 2\n\t\tX$Y  => flags = 1\n\t\tXY   => flags = 0\n\t*/\n\treturn [row, sum, flags];\n}\n\nexport function split(formula, view, crosssheet){\n\tconst activeSheet = view.getActiveSheet();\n\tvar lines = [];\n\tvar index = 0;\n\tvar quotes = false, ph = false;\n\tfor (var i = formula[i] === \"=\" ? 1 : 0; i < formula.length; i++){\n\t\tvar key = formula[i];\n\t\tif (key == \"\\\"\"){\n\t\t\tquotes = !quotes;\n\t\t} else if (!quotes){\n\t\t\tif (key == \"{\" && formula[i+1] == \"{\"){\n\t\t\t\tph = true;\n\t\t\t} else if (key == \"}\" && formula[i+1] == \"}\"){\n\t\t\t\tph = false;\n\t\t\t} else if (!ph){\n\t\t\t\tconst escaped = key === \"'\";\n\t\t\t\tif (escaped || isChar(key)){\n\t\t\t\t\tlet [word, end, ,sheet] = getWord(formula, i, \"\");\n\t\t\t\t\tlet next = end - 1;\n\t\t\t\t\tlet value;\n\n\t\t\t\t\tif(formula[next+1] !== \"(\"){\n\t\t\t\t\t\tif(isPosition(word)){\n\t\t\t\t\t\t\tif(!sheet || sheet == activeSheet || crosssheet){\n\t\t\t\t\t\t\t\tvalue = sheet ? [sheet, word, escaped] : word;\n\t\t\t\t\t\t\t\tpushLine(lines, formula, i, index, value);\n\t\t\t\t\t\t\t\tindex = next+1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tif(crosssheet){\n\t\t\t\t\t\t\t\tvalue = sheet ? [sheet, word, escaped] : word;\n\t\t\t\t\t\t\t\tpushLine(lines, formula, i, index, value);\n\t\t\t\t\t\t\t\tindex = next+1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tlet range;\n\n\t\t\t\t\t\t\t\tif(sheet)\n\t\t\t\t\t\t\t\t\trange = view.ranges.getCode(word, sheet);\n\t\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\t\t//global range\n\t\t\t\t\t\t\t\t\trange = view.ranges.getCode(word, true);\n\n\t\t\t\t\t\t\t\t\t//active sheet range\n\t\t\t\t\t\t\t\t\tif(!range)\n\t\t\t\t\t\t\t\t\t\trange = view.ranges.getCode(word);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif(range){\n\t\t\t\t\t\t\t\t\tconst parts = range.split(\"!\");\n\t\t\t\t\t\t\t\t\tif(parts[0] == activeSheet){\n\t\t\t\t\t\t\t\t\t\tvalue = [sheet, word, escaped, parts[1]];\n\t\t\t\t\t\t\t\t\t\tpushLine(lines, formula, i, index, value);\n\t\t\t\t\t\t\t\t\t\tindex = next+1;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ti = next;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif (index!=formula.length)\n\t\tlines.push(formula.substr(index));\n\treturn lines;\n}\n\nfunction pushLine(lines, formula, i, index, value){\n\tif (i!==0)\n\t\tlines.push(formula.substr(index, i-index));\n\tlines.push(value);\n}\n\nexport function getMathFormat(view, value){\n\tlet level = 0;\n\tlet blockLevel;\n\n\tconst parts = split(value, view);\n\n\tfor(let i = 0; i < parts.length; i++){\n\t\t// parts[i] can contain numbers, math operators, formulas, etc.\n\t\tif(i%2 === 0){\n\t\t\t// check formulas and round brackets which are not in quotes\n\t\t\tconst methods = parts[i].match(/(([a-zA-Z]*\\()|\\))(?=(?:[^\"]|\"[^\"]*\")*$)/g);\n\t\t\tif(methods)\n\t\t\t\tmethods.forEach(part => {\n\t\t\t\t\tif(part.indexOf(\"(\") > -1){\n\t\t\t\t\t\tlevel++;\n\t\t\t\t\t\t// some methods block format addition (like count,odd,etc.)\n\t\t\t\t\t\tconst safeMethods = /^(SUM|AVERAGE|MAX|MIN|INT|ROUND|ROUNDDOWN|ROUNDUP|TRUNC)?\\($/gi;\n\t\t\t\t\t\tif(!blockLevel && !safeMethods.test(part))\n\t\t\t\t\t\t\tblockLevel = level;\n\t\t\t\t\t}\n\t\t\t\t\telse if(--level < blockLevel)\n\t\t\t\t\t\tblockLevel = null;\n\t\t\t\t});\n\t\t}\n\t\t// parts[i] can be named range, cell from the active / non-active sheet\n\t\telse if(!blockLevel){\n\t\t\tif(webix.isArray(parts[i])){\n\t\t\t\tif(/^[A-Za-z]+$/.test(parts[i][1]))\n\t\t\t\t\tparts[i] = parts[i][3].split(\":\")[0];\n\t\t\t\telse if(parts[i][0] == view.getActiveSheet())\n\t\t\t\t\tparts[i] = parts[i][1];\n\t\t\t\telse\n\t\t\t\t\tcontinue; // ignore non-active sheets\n\t\t\t}\n\n\t\t\t// if range - check first cell position\n\t\t\tconst cell = position(parts[i]);\n\t\t\tconst name = getFormatName(view, cell[0], cell[1]);\n\n\t\t\t// first cell with number format\n\t\t\tif(name)\n\t\t\t\treturn {fmt: getFormatSource(name)};\n\t\t}\n\t}\n}","import {getFormatName, checkFormat, isDateInvalid, getFormatFromData, getFormatSource} from \"./formats\";\nimport {getExcelDateFromJs} from \"../mathematics/methods\";\nimport {getMathFormat} from \"../mathematics/parser\";\n\nexport function init(view){\n\tview.attachEvent(\"onCellChange\", function(row, col, value, type){\n\t\tif(!this._setType){\n\t\t\tconst formatName = getFormatName(this, row, col);\n\t\t\tconst cell = {\n\t\t\t\trow,\n\t\t\t\tcol,\n\t\t\t\tvalue,\n\t\t\t\tfmt: formatName ? {fmt: getFormatSource(formatName)} : null,\n\t\t\t\ttype\n\t\t\t};\n\t\t\tsetType(this, cell);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onBeforeFormatChange\", function(row, col, formatName){\n\t\tif(!this._setType){\n\t\t\tconst cell = {\n\t\t\t\trow,\n\t\t\t\tcol,\n\t\t\t\tvalue: view.getCellValue(row, col),\n\t\t\t\tfmt: {fmt:getFormatSource(formatName)}\n\t\t\t};\n\t\t\tsetType(this, cell, true);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAction\", function(action, values){\n\t\tif(action == \"dropdown\" && values.newValue && values.newValue.editor == \"excel_date\"){\n\t\t\tconst format = getFormatName(this, values.row, values.column);\n\t\t\tif(getFormatType(format) != \"date\")\n\t\t\t\tthis.setFormat(values.row, values.column, webix.i18n.spreadsheet.formats.dateFormat);\n\t\t}\n\t});\n}\n\nexport function loadCell(view, data, item){\n\tconst fmt = getFormatFromData(data, item);\n\tconst cell = {\n\t\tvalue: item[2],\n\t\tfmt: fmt ? {fmt} : null,\n\t\ttype: item[4]\n\t};\n\tsetType(view, cell);\n\treturn cell;\n}\n\nfunction getExpectType(view, cell, parseDate, isFormula, formatType, style){\n\t//date based math\n\tlet type = \"string\";\n\tif(!webix.isUndefined(cell.value)){\n\t\tif(isFormula){\n\t\t\ttype = \"number\";\n\n\t\t\tif(/^=(now|date|time)\\(/i.test(cell.value))\n\t\t\t\ttype = \"date\";\n\t\t\telse if(/^=(sparkline|image)\\(/i.test(cell.value))\n\t\t\t\ttype = \"string\";\n\t\t}\n\t\telse if(!isNaN(cell.value))\n\t\t\ttype = \"number\";\n\t\telse if(formatType != \"string\" && parseDate){\n\t\t\t//if user types a date string, or it comes from Excel import\n\t\t\t//set date type and convert string to Excel date\n\t\t\tconst parser = webix.Date.strToDate( webix.i18n.spreadsheet.formats.parseDateTime );\n\t\t\tconst value  = parser(cell.value);\n\t\t\tif(value != \"\" && !isNaN(value)){\n\t\t\t\t//change cell style - value changes once (some value -> 35767.5)\n\t\t\t\t//change cell value - value changes twice (some value -> \"12/03/97\" -> 35767.5)\n\t\t\t\t//so ignore undo for cell value change\n\t\t\t\tif(style)\n\t\t\t\t\tdateToExcel(view, cell, value);\n\t\t\t\telse\n\t\t\t\t\tview.ignoreUndo(() => dateToExcel(view, cell, value));\n\n\t\t\t\ttype = \"date\";\n\t\t\t}\n\t\t}\n\t}\n\treturn type;\n}\n\nfunction dateToExcel(view, cell, date){\n\tdate = getExcelDateFromJs(date);\n\tcell.value = date;\n\n\tif(!view._loading_data)\n\t\tview.setCellValue(cell.row, cell.col, date);\n}\n\nfunction checkType(type, expectType, formatType, isFormula, value){\n\ttype = type || expectType;\n\n\t//strings will always have string type regardless of format\n\tif(expectType == \"string\")\n\t\ttype = \"string\";\n\telse if(formatType)\n\t\ttype = formatType;\n\n\tif(type == \"date\" && !isFormula && isDateInvalid(value))\n\t\ttype = \"number\";\n\n\treturn type;\n}\n\nfunction getFormatType(format){\n\tlet formatType = format ? \"number\" : null;\n\tif(checkFormat(format, \"string\"))\n\t\tformatType = \"string\";\n\telse if(checkFormat(format, \"date\"))\n\t\tformatType = \"date\";\n\treturn formatType;\n}\n\nexport function getType(view, row, column){\n\tconst item = view._mPage.getCell(row-1, column-1);\n\treturn (item && item.type) || null;\n}\n\nfunction setType(view, cell, style){\n\tconst parseToStore = !(cell.row && cell.col);\n\n\t//prevent type change during value or format change\n\tview._setType = true;\n\n\tconst isFormula = typeof cell.value == \"string\" && cell.value[0] == \"=\";\n\tconst parseDate = (!style || cell.fmt == getFormatSource(\"date\")) && (!view._loading_data || cell.type == \"date\");\n\n\tlet mathFormat;\n\tif(!parseToStore)\n\t\tmathFormat = isFormula && !cell.fmt ? getMathFormat(view, cell.value) : null;\n\n\tconst formatType = getFormatType(cell.fmt || mathFormat);\n\tconst expectType = getExpectType(view, cell, parseDate, isFormula, formatType, style);\n\n\tcell.type = checkType(cell.type, expectType, formatType, isFormula, cell.value);\n\tcell.$format = formatType == \"string\" ? 1 : 0;\n\n\tif(!parseToStore){\n\t\tconst item = view._mPage.getCell(cell.row-1, cell.col-1, true);\n\t\titem.type = cell.type;\n\t\titem.$format = cell.$format;\n\n\t\tupdateCell(view, cell, expectType, formatType, mathFormat);\n\t}\n\n\tdelete view._setType;\n}\n\nfunction updateCell(view, cell, expectType, formatType, mathFormat){\n\tconst row = cell.row;\n\tconst col = cell.col;\n\tconst isString = typeof cell.value == \"string\";\n\n\tconst isFormula = isString && cell.value[0] == \"=\";\n\tconst cellEditor = view.getCellEditor(row, col);\n\n\t//update cell value if set number format (5e5 -> 500000, 005 -> 5)\n\tif(!view._loading_data && cell.type === \"number\" && isString && !isFormula && cell.value !== \"\")\n\t\tview.setCellValue(row, col, cell.value*1);\n\n\tif(mathFormat)\n\t\tview.setFormat(row, col, mathFormat.fmt);\n\telse if(cell.type == \"date\"){\n\t\t// add default date format\n\t\tif(formatType != \"date\"){\n\t\t\tconst isTime = isFormula && cell.value.toUpperCase().indexOf(\"=TIME(\") == 0;\n\t\t\tconst locale = webix.i18n.spreadsheet.formats;\n\t\t\tconst format = isTime ? locale.timeFormat : locale.dateFormat;\n\t\t\tview.setFormat(row, col, format);\n\t\t}\n\n\t\t//set date editor for cells with date type\n\t\tif(!isFormula && !cellEditor)\n\t\t\tview.setCellEditor(row, col, {editor: \"excel_date\"});\n\t}\n\telse if(formatType != \"string\" && cell.type == \"string\" && expectType != \"string\"){\n\t\t//force text format for numbers typed as strings\n\t\tview.setFormat(row, col, \"@\");\n\t}\n\n\t//remove date editor\n\tif((cell.type != \"date\" || isFormula) && cellEditor && cellEditor.editor == \"excel_date\")\n\t\tview.setCellEditor(row, col, null);\n}\n","import {isChar, getLastCharIndex} from \"../mathematics/parser\";\n\nwebix.protoUI({\n\tname: \"suggest-formula\",\n\tdefaults: {\n\t\tfitMaster: false,\n\t\twidth: 200,\n\t\tfilter(item, value) {\n\t\t\tconst editor = webix.$$(this.config.master);\n\t\t\tconst cursor = editor.getInputNode().selectionStart;\n\t\t\tconst val = editor.getValue();\n\n\t\t\tif(val.charAt(0) !== \"=\") return;\n\n\t\t\tconst str = val.substring(0, cursor);\n\t\t\tconst search = str.substring( getLastCharIndex(str) );\n\t\t\tconst nextSymbol = val.charAt(cursor);\n\n\t\t\tif(search && (cursor === val.length || !(isChar(nextSymbol) || /^[0-9]/.test(nextSymbol))))\n\t\t\t\tvalue = search;\n\n\t\t\treturn item.value.toString().toLowerCase().indexOf(value.toLowerCase()) === 0;\n\t\t}\n\t},\n\t$init() {\n\t\tthis.attachEvent(\"onBeforeShow\", (node) => {\n\t\t\tif(node.tagName){\n\t\t\t\tconst editor = webix.$$(this.config.master);\n\t\t\t\tconst text = editor.getValue();\n\n\t\t\t\t//only for formulas\n\t\t\t\tif(!text || text.charAt(0) !== \"=\") return false;\n\n\t\t\t\tconst sizes = webix.html.offset(node);\n\n\t\t\t\tconst selectionStart = editor.getInputNode().selectionStart;\n\t\t\t\tconst textWidth = webix.html.getTextSize(text.substring(0, selectionStart), \"webix_ssheet_formula\").width;\n\n\t\t\t\tconst y = sizes.y + sizes.height;\n\t\t\t\tconst x = sizes.x + textWidth;\n\n\t\t\t\twebix.ui.popup.prototype.show.apply(this, [{x, y}]);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t},\n\tsetMasterValue(data, refresh) {\n\t\tconst text = data.id ? this.getItemText(data.id) : (data.text||data.value);\n\t\twebix.$$(this.config.master).setValueHere(text);\n\n\t\tif (!refresh)\n\t\t\tthis.hide(true);\n\n\t\tthis.callEvent(\"onValueSuggest\", [data, text]);\n\t},\n\t$enterKey: function() {\n\t\tif (this.isVisible())\n\t\t\treturn webix.ui.suggest.prototype.$enterKey.apply(this, arguments);\n\t}\n}, webix.ui.suggest);","webix.protoUI({\n\tname: \"ssheet-button\",\n\t$cssName: \"button\",\n\tdefaults:{\n\t\ttype:\"htmlbutton\",\n\t\twidth: 40\n\t},\n\t$init: function(config){\n\t\tthis.$view.className += \" webix_ssheet_button\"+(config.arrow?\" webix_ssheet_button_menu\":\"\");\n\t\tif(config.label || config.icon){\n\t\t\tlet icon = (config.icon||config.name),\n\t\t\t\ttext = config.label||\"\";\n\t\t\tif(config.arrow)\n\t\t\t\ttext += \"<span class='webix_ssheet_button_icon webix_ssheet_icon_arrow webix_icon wxi-menu-down'></span>\";\n\t\t\tconfig.label = \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\"+icon+\"'></span> \"+text;\n\t\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\t}\n\t\tif(config.options && !config.popup)\n\t\t\tconfig.popup = getPopupConfig(config.options);\n\t}\n},webix.ui.button);\n\n\nwebix.protoUI({\n\tname: \"ssheet-button-icon-top\",\n\t$cssName: \"button\",\n\tdefaults:{\n\t\ttype:\"htmlbutton\",\n\t\twidth: 70,\n\t\theight: 70\n\t},\n\t$init: function(config){\n\t\tthis.$view.className += \" ssheet_button_icon_top\";\n\t\tif(config.label) {\n\t\t\tlet icon = (config.icon || config.name||\"\"),\n\t\t\t\ttext = config.label;\n\t\t\tconfig.label = \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\" + icon + \"'></span><br/>\";\n\t\t\tconfig.label += \"<span class='ssheet_button_icon_top_text'>\"+text+\"</span>\";\n\t\t\tif (config.arrow)\n\t\t\t\tconfig.label += \"<br/><span class='ssheet_button_icon_top_arrow webix_icon wxi-menu-down'></span>\";\n\t\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\t}\n\t\tif(config.options && !config.popup)\n\t\t\tconfig.popup = getPopupConfig(config.options);\n\t}\n},webix.ui.button);\n\n\nfunction getPopupConfig(options){\n\treturn {\n\t\tview: \"ssheet-suggest\",\n\t\tcss: \"webix_ssheet_suggest\",\n\t\tautowidth:true,\n\t\ttemplate: function(obj){\n\t\t\tvar text = \"\";\n\t\t\tif(obj.icon)\n\t\t\t\ttext += \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\" + obj.icon + \"'></span> \";\n\t\t\ttext += obj.value || webix.i18n.spreadsheet.menus[obj.id] || obj.id;\n\t\t\treturn text;\n\t\t},\n\t\tdata: options,\n\t\ton:{\n\t\t\tonItemClick: function(id){\n\t\t\t\tvar button = this.config.master;\n\t\t\t\tif(button){\n\t\t\t\t\tlet view = webix.$$(button).getTopParentView();\n\t\t\t\t\tvar params = [this.getItem(id)];\n\t\t\t\t\tif(webix.$$(button).config.area){\n\t\t\t\t\t\tlet area = view.$$(\"cells\").getSelectArea();\n\t\t\t\t\t\tif(area)\n\t\t\t\t\t\t\tparams = params.concat([area.start,area.end]);\n\t\t\t\t\t}\n\t\t\t\t\tview.callEvent(\"onCommand\",params);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n}","import \"./suggest_formula\";\nimport {getJsDateFromExcel} from \"../mathematics/methods\";\nimport {getType} from \"../operations/types\";\nimport {getDateEditFormat} from \"../operations/formats\";\nimport {split, position, getLastCharIndex} from \"../mathematics/parser\";\n\nwebix.protoUI({\n\tname: \"live-editor\",\n\t$cssName:\"texthighlight\",\n\t$init(config){\n\t\tconfig.suggest = {\n\t\t\tview: \"suggest-formula\",\n\t\t\tdata: config.suggestData\n\t\t};\n\t\tconfig.highlight = this.highlight;\n\n\t\tthis._highlightedCells = {};\n\t\tthis.$view.className += \" webix_ssheet_formula\";\n\n\t\tthis.attachEvent(\"onKeyPress\", (code, e) => {\n\t\t\tdelete this._update_range;\n\t\t\tif(code == 13) {\n\t\t\t\t//ignore Enter key if it was pressed to select some value from suggest\n\t\t\t\tif ((new Date() - (this._last_value_set || 0)) > 300){\n\t\t\t\t\tconst cell = this.config.activeCell;\n\t\t\t\t\tthis.showActiveSheet(true);\n\t\t\t\t\tthis.updateCellValue(cell);\n\t\t\t\t\t//blur to avoid calling highlight function after selection move\n\t\t\t\t\tthis.getInputNode().blur();\n\t\t\t\t\t//we have 'enter' hot key to activate editor\n\t\t\t\t}\n\t\t\t\twebix.html.preventEvent(e);\n\t\t\t}\n\t\t\t//esc - cancel editing\n\t\t\telse if(code == 27){\n\t\t\t\tthis.showActiveSheet();\n\n\t\t\t\twebix.delay(()=>{\n\t\t\t\t\tconst master = this.getTopParentView();\n\t\t\t\t\tconst cell = master.getSelectedId();\n\t\t\t\t\tconst oldVal = this.getCellValue(cell.row, cell.column);\n\n\t\t\t\t\tif(this.getValue() == oldVal)\n\t\t\t\t\t\tmaster.$$(\"cells\").refresh(cell.row);\n\t\t\t\t\telse\n\t\t\t\t\t\tthis.setValue(oldVal);\n\n\t\t\t\t\tdelete master.$handleSelection;\n\n\t\t\t\t\twebix.UIManager.setFocus(master.$$(\"cells\"));\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tthis.attachEvent(\"onAfterRender\", function(){\n\t\t\twebix.eventRemove(this.keydownEv);\n\n\t\t\tthis.keydownEv = webix.event(this.getInputNode(), \"keydown\", e => {\n\t\t\t\tthis.endEdit(e);\n\t\t\t});\n\t\t});\n\t},\n\thighlight(value){\n\t\tlet html = \"\";\n\t\tconst master = this.getTopParentView();\n\t\tconst escapeText = webix.template.escape;\n\n\t\tfor(let area in this._highlightedCells){\n\t\t\tconst cells = this._highlightedCells[area];\n\t\t\tthis.changeCellCss(cells[0], cells[1], cells[2], true);\n\t\t}\n\t\tthis._highlightedCells = {};\n\n\t\t//value can be null\n\t\tif(value && value[0]==\"=\"){\n\t\t\tconst parts = split(value, master);\n\t\t\tconst sheet = master.getActiveSheet();\n\n\t\t\tlet colorIndex = 1;\n\n\t\t\tfor(let i = 0; i < parts.length; i++){\n\t\t\t\tif(i%2 === 0)\n\t\t\t\t\thtml += escapeText(parts[i]);\n\t\t\t\telse{\n\t\t\t\t\tconst crossheet = webix.isArray(parts[i]);\n\t\t\t\t\tconst cellSheet = crossheet ? this.prepareSheet(parts[i][0], parts[i][2]) : \"\";\n\t\t\t\t\tconst activeMath = this._activeMath;\n\n\t\t\t\t\tconst activeSheet = !crossheet && (!activeMath || activeMath == sheet);\n\t\t\t\t\tlet cell = position(crossheet ? parts[i][1] : parts[i]);\n\t\t\t\t\tconst cellText = crossheet ? cellSheet+parts[i][1] : parts[i];\n\n\t\t\t\t\tconst rangeName = crossheet && !getLastCharIndex(parts[i][1]);\n\n\t\t\t\t\tif(rangeName || activeSheet || (crossheet && parts[i][0] == sheet)){\n\t\t\t\t\t\tlet repeatedColor;\n\t\t\t\t\t\t//range\n\t\t\t\t\t\tif((parts[i+1] == \":\" && parts[i+2]) || rangeName){\n\t\t\t\t\t\t\tlet nextCell, nextCellText;\n\n\t\t\t\t\t\t\tif(rangeName){\n\t\t\t\t\t\t\t\tconst cells = parts[i][3].split(\":\");\n\n\t\t\t\t\t\t\t\tcell = position(cells[0]);\n\t\t\t\t\t\t\t\tnextCell = position(cells[1]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tnextCell = position(webix.isArray(parts[i+2]) ? parts[i+2][1] : parts[i+2]);\n\t\t\t\t\t\t\t\tnextCellText = webix.isArray(parts[i+2]) ? cellSheet+parts[i+2][1] : parts[i+2];\n\t\t\t\t\t\t\t\ti+=2;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\trepeatedColor = this.setColor(cell[0], cell[1], nextCell[0], nextCell[1], colorIndex);\n\t\t\t\t\t\t\thtml += `<span class=\"webix_ssheet_highlight_color_${repeatedColor||colorIndex}\">${rangeName ? cellText : cellText+\":\"+nextCellText}</span>`;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//OtherSheet!A1:A3 - do not highlight A3\n\t\t\t\t\t\telse if(parts[i-1] && parts[i-1][ parts[i-1].length-1 ] == \":\"){\n\t\t\t\t\t\t\thtml += cellText;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//cell\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\trepeatedColor = this.setColor(cell[0], cell[1], cell[0], cell[1], colorIndex);\n\t\t\t\t\t\t\thtml += `<span class=\"webix_ssheet_highlight_color_${repeatedColor||colorIndex}\">${cellText}</span>`;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst colors = 7;\n\t\t\t\t\t\tif(!repeatedColor)\n\t\t\t\t\t\t\tcolorIndex += colorIndex == colors ? -1*(colors-1) : 1;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\thtml += cellText;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\thtml = escapeText(value);\n\n\t\tmaster.$$(\"cells\").refresh();\n\n\t\tif(document.activeElement == this.getInputNode())\n\t\t\tthis.paintValue();\n\t\treturn html;\n\t},\n\tshowActiveSheet(enter){\n\t\tconst master = this.getTopParentView();\n\t\tconst grid = master._table;\n\n\t\tif(this._activeMath){\n\t\t\tif(this._activeMath != master.getActiveSheet()){\n\t\t\t\tconst cell = this.config.activeCell;\n\n\t\t\t\tthis.define({activeCell:null});\n\n\t\t\t\tmaster.showSheet(this._activeMath);\n\n\t\t\t\twebix.delay(()=>{\n\t\t\t\t\tgrid.select(cell.row + (enter ? 1 : 0), cell.column);\n\t\t\t\t});\n\t\t\t}\n\t\t\tdelete this._activeMath;\n\t\t}\n\t\telse if(enter){\n\t\t\twebix.delay(()=>{\n\t\t\t\tgrid.moveSelection(\"down\");\n\t\t\t});\n\t\t}\n\t},\n\tchangeCellCss(row, col, index, remove){\n\t\tconst css = `webix_ssheet_highlight_background_${index}`;\n\t\tfor (let r = row.start; r <= row.end; r++)\n\t\t\tfor (let c = col.start; c <=  col.end; c++)\n\t\t\t\tthis.getTopParentView().$$(\"cells\")[remove?\"removeCellCss\":\"addCellCss\"](r, c, css, true);\n\t},\n\tendEdit(e){\n\t\tlet code = e.which || e.keyCode;\n\n\t\t//if it is a formula - force user to finish it by click outside or 'enter'\n\t\tif(code == 9 || (code>36 && code<41 && this.getValue().charAt(0)!==\"=\")){\n\t\t\tlet dir = (code == 40)?\"down\":(code === 39?\"right\":(code ==37?\"left\":\"up\"));\n\t\t\tif (code === 9)\n\t\t\t\tdir = \"right\";\n\n\t\t\tthis.getInputNode().blur();\n\t\t\tthis.updateCellValue();\n\t\t\tthis.getTopParentView()._table.moveSelection(dir);\n\t\t}\n\t},\n\tpaintValue(){\n\t\tconst master = this.getTopParentView();\n\t\tif(!this._activeMath || this._activeMath == master.getActiveSheet()){\n\t\t\tconst cell = this.config.activeCell;\n\t\t\tconst node = master._table.getItemNode(cell);\n\t\t\tif(cell && node) \n\t\t\t\tnode.innerHTML = `<div>${webix.template.escape(this.getValue())}</div>`;\n\t\t}\n\t},\n\tupdateCellValue(cell) {\n\t\tconst newv = this.getValue();\n\t\tconst master = this.getTopParentView();\n\t\tcell = cell || this.config.activeCell;\n\n\t\tif (!cell)\n\t\t\tthis.setValue(\"\");\n\t\telse{\n\t\t\tconst val = master.getCellValue(cell.row, cell.column);\n\n\t\t\tif(newv !== val){\n\t\t\t\tthis.config.value = newv;\n\t\t\t\tmaster.setCellValue(cell.row, cell.column, newv);\n\t\t\t\tmaster.refresh();\n\t\t\t}\n\t\t}\n\n\t\tdelete master.$handleSelection;\n\t},\n\t$setValueHere(value){\n\t\tthis.setValueHere(value);\n\t},\n\tsetValueHere(value) {\n\t\tthis._last_value_set = new Date();\n\n\t\tconst formula = this.getValue();\n\t\tif(formula && formula.charAt(0)===\"=\"){\n\t\t\tconst cursor = this.getInputNode().selectionStart;\n\t\t\tlet str1 = formula.substring(0, cursor);\n\t\t\tconst str2 = formula.substring(cursor);\n\n\t\t\tif(str1[str1.length-1] == \"(\")\n\t\t\t\tstr1 = str1.substring(0, str1.length-1);\n\n\t\t\tstr1 = str1.substring(0, getLastCharIndex(str1));\n\n\t\t\t//suggest called via up/down key\n\t\t\tstr1 += value + (str2[0] == \"(\" ? \"\" : \"(\");\n\n\t\t\tthis.setValue(str1 + str2);\n\t\t\tthis.getInputNode().setSelectionRange(str1.length, str1.length);\n\t\t}\n\t},\n\texpectOperator(){\n\t\tconst text = this.getValue();\n\n\t\tif(text[0] == \"=\"){\n\t\t\tlet cursor = this.getInputNode().selectionStart;\n\t\t\twhile(text[cursor-1] == \" \")\n\t\t\t\tcursor--;\n\t\t\treturn text[cursor-1] && text[cursor-1].match(/[+&\\-/*%=(:,]/);\n\t\t}\n\t},\n\tsetRange(range, replace){\n\t\tconst cursor = this.getInputNode().selectionStart;\n\t\tconst formula = this.getValue();\n\n\t\tlet str1, str2;\n\n\t\t//check if range was added by click\n\t\tif(replace)\n\t\t\treplace = this._update_range && cursor == this._update_range.pos + this._update_range.len;\n\n\t\tconst lastPos = replace ? this._update_range.pos : cursor;\n\n\t\tstr1 = formula.substring(0, lastPos) + range;\n\t\tstr2 = formula.substring(cursor);\n\n\t\tthis._update_range = {pos: lastPos, len: range.length};\n\n\t\tthis.setValue(str1 + str2);\n\t},\n\tprepareSheet(sheet, escaped){\n\t\tif(!sheet)\n\t\t\treturn \"\";\n\t\tconst condition = webix.isUndefined(escaped) ? sheet.indexOf(\" \") != -1 : escaped;\n\t\treturn (condition ? `'${sheet}'` : sheet) + \"!\";\n\t},\n\tprepareArea(first, second){\n\t\treturn {\n\t\t\tstart: Math.min(first, second),\n\t\t\tend: Math.max(first, second)\n\t\t};\n\t},\n\tsetColor(row1, col1, row2, col2, color){\n\t\tconst row = this.prepareArea(row1, row2);\n\t\tconst col = this.prepareArea(col1, col2);\n\t\tconst index = [row.start, row.end, col.start, col.end].join(\",\");\n\t\tconst coloredArea = this._highlightedCells[index];\n\n\t\tif(!coloredArea){\n\t\t\tthis._highlightedCells[index] = [row, col, color];\n\t\t\tthis.changeCellCss(row, col, color);\n\t\t}\n\t\telse\n\t\t\treturn coloredArea[2];\n\t},\n\tgetCellValue(row, column){\n\t\tconst master = this.getTopParentView();\n\t\tlet value = master.getCellValue(row, column);\n\t\tif(getType(master, row, column) == \"date\" && value[0] != \"=\"){\n\t\t\tconst format = getDateEditFormat(master, row, column);\n\t\t\tvalue = format(getJsDateFromExcel(value));\n\t\t}\n\t\treturn value;\n\t}\n}, webix.ui.texthighlight);","webix.protoUI({\n\tname: \"ssheet-separator\",\n\tdefaults:{\n\t\tcss: \"webix_ssheet_toolbar_spacer\",\n\t\ttemplate: \" \",\n\t\twidth: 1,\n\t\tborderless: true\n\t}\n},webix.ui.view);","webix.protoUI({\n\tname: \"sheets\",\n\tdefaults:{\n\t\tlayout: \"x\",\n\t\tborderless: true,\n\t\tcss:\"ssheet_list_sheets\",\n\t\tselect: true,\n\t\tdrag: \"order\",\n\t\tdragscroll:\"x\",\n\t\tscroll:false\n\t}\n},webix.EditAbility,webix.ui.list);","// toolbar: toogle button\nwebix.protoUI({\n\t$cssName: \"toggle\",\n\tname:\"ssheet-toggle\",\n\ttoggle:function(){\n\t\tvar value = this.getValue() == this.config.onValue?true:false;\n\t\tthis.setValue(!value);\n\t},\n\t$setValue:function(value){\n\t\tif(value == this.config.offValue)\n\t\t\tvalue = false;\n\t\telse if(value == this.config.onValue)\n\t\t\tvalue = true;\n\t\twebix.ui.toggle.prototype.$setValue.call(this,value);\n\t},\n\tgetValue:function(){\n\t\tvar config = this.config;\n\t\tvar value = config.value;\n\t\treturn  !value || value==config.offValue?(config.offValue||false):(config.onValue||true);\n\t},\n\tdefaults:{\n\t\ttemplate:function(obj, common){\n\t\t\tvar css = (obj.value === true ||obj.value == obj.onValue) ? \" webix_pressed\" : \"\";\n\t\t\tvar inp = common.$renderInput(obj, common);\n\t\t\treturn \"<div class='webix_el_box\"+css+\"' style='width:\"+obj.awidth+\"px; height:\"+obj.aheight+\"px'>\"+inp+\"</div>\";\n\t\t}\n\t}\n}, webix.ui.toggle);\n\n\n// toolbar: silent toggle button\nwebix.protoUI({\n\tname:\"ssheet-toggle-silent\",\n\t$cssName:\"toggle\",\n\t$allowsClear:false,\n\tsetValue:function(){\n\t\tthis.blockEvent();\n\t\twebix.ui.toggle.prototype.setValue.apply(this, arguments);\n\t\tthis.unblockEvent();\n\t}\n}, webix.ui.toggle);","webix.protoUI({\n\tname: \"ssheet-bar-title\",\n\tdefaults:{\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_subbar_title\";\n\t}\n},webix.ui.template);","webix.protoUI({\n\tname:\"multicheckbox\",\n\tdefaults:{\n\t\tpadding:0,\n\t\ttype:\"clean\",\n\t\tborderless:true,\n\t\telementsConfig:{\n\t\t\tlabelWidth:10\n\t\t}\n\t},\n\t$init:function(config){\n\t\tconfig.rows = [{height:0.000001}];\n\t\tthis.$ready.push(function(){\n\t\t\tthis._initOnChange();\n\t\t});\n\t},\n\t_initOnChange(){\n\t\tthis.attachEvent(\"onChange\", function(newv){\n\t\t\tconst name = this.$eventSource.config.name;\n\n\t\t\tthis.blockEvent();\n\t\t\tif(name == \"$all\"){\n\t\t\t\tfor(let i in this.elements)\n\t\t\t\t\tthis.elements[i].setValue(newv);\n\t\t\t\tif(!newv)\n\t\t\t\t\tthis._getCheckboxes()[0].setValue(1);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tconst count = this.getValue().length;\n\t\t\t\tthis.elements.$all.setValue(count == this._count ? 1 : 0);\n\t\t\t\tif(!count)\n\t\t\t\t\tthis._getCheckboxes()[0].setValue(1);\n\t\t\t}\n\t\t\tthis.unblockEvent();\n\t\t});\n\t},\n\tsetValue:function(value){\n\t\tthis.elements = {};\n\t\tthis._count = value.length;\n\n\t\tif(value.length > 1){\n\t\t\tlet elements = [];\n\t\t\tlet base = [];\n\t\t\tconst maxHeight = 400;\n\n\t\t\tvalue.forEach(sheet => {\n\t\t\t\tbase.push({ view: \"checkbox\", labelRight: sheet.name, name: sheet.name, value: sheet.active});\n\t\t\t});\n\n\t\t\tconst baseHeight = base.length * webix.skin.$active.inputHeight;\n\t\t\tconst scroll = baseHeight > maxHeight;\n\n\t\t\telements.push({\n\t\t\t\tview:\"scrollview\", body:{rows:base},\n\t\t\t\tscroll: scroll,\n\t\t\t\theight: scroll ? maxHeight : baseHeight\n\t\t\t});\n\n\t\t\telements.push({ template:\"<div class='ss_sep_line'></div>\", height:10 });\n\t\t\telements.push({ view:\"checkbox\", labelRight:webix.i18n.spreadsheet.labels[\"export-all-sheets\"], name:\"$all\", value:0 });\n\n\t\t\twebix.ui(elements, this);\n\t\t}\n\t\telse if(this.getChildViews().length > 1){\n\t\t\twebix.ui([{height:0.000001}], this);\n\t\t}\n\t},\n\tgetValue:function(){\n\t\tconst checkboxes = this._getCheckboxes();\n\t\tlet output = [];\n\n\t\t//save order\n\t\tfor(let i = 0; i < checkboxes.length; i++)\n\t\t\tif(checkboxes[i].getValue())\n\t\t\t\toutput.push(checkboxes[i].config.name);\n\n\t\treturn output;\n\t},\n\t_getCheckboxes(){\n\t\tconst scrollview = this.queryView(\"scrollview\");\n\t\treturn scrollview ? scrollview.getBody().getChildViews() : [];\n\t}\n}, webix.ui.form);","webix.protoUI({\n\tname:\"formlist\",\n\tdefaults:{\n\t\tpaddingY: 5,\n\t\theight: 120,\n\t},\n\t$init:function(config){\n\n\t\tconfig.cols = [\n\t\t\t{\n\t\t\t\tcss:\"webix_inp_label\",\n\t\t\t\ttemplate:config.label,\n\t\t\t\twidth:config.labelWidth,\n\t\t\t\tborderless:true\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"list\",\n\t\t\t\tdata:config.data,\n\t\t\t\tcss:config.css,\n\t\t\t\ttemplate:config.template,\n\t\t\t\tselect: true,\n\t\t\t\tscroll:false,\n\t\t\t\tborderless:true,\n\t\t\t\ton:{\n\t\t\t\t\tonSelectChange:()=>{\n\t\t\t\t\t\tthis.getParentView().callEvent(\"onChange\", []);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t},\n\tsetValue:function(value){this.getChildViews()[1].select(value);},\n\tgetValue:function(){return this.getChildViews()[1].getSelectedId();},\n\trefresh: function(){this.getChildViews()[1].refresh();},\n\tfocus:function(){}\n}, webix.ui.layout);","webix.protoUI({\n\tname: \"ssheet-ui\",\n\tdefaults:{\n\t\tmove:true,\n\t\tcss:\"webix_shadow_none webix_ssheet_ui\",\n\t\thead:false,\n\t\tresize:true,\n\t\ttoFront:true,\n\t\tminWidth:50,\n\t\tminHeight:200,\n\t\tescHide:false,\n\t\tautofit:false\n\t},\n\t$init:function(){\n\t\t// prevent block selection\n\t\tthis.$view.setAttribute(\"webixignore\", \"1\");\n\n\t\tthis.$ready.push(function(){\n\t\t\twebix.UIManager.addHotKey(\"delete\", webix.bind(this._removeView, this));\n\t\t\twebix.UIManager.addHotKey(\"backspace\", webix.bind(this._removeView, this));\n\t\t\tthis.getMenu();\n\t\t});\n\t\tthis.attachEvent(\"onDestruct\", function(){\n\t\t\twebix.eventRemove(this._clickEv);\n\t\t\tthis._menu.destructor();\n\t\t});\n\t},\n\tmove_setter:function(value){\n\t\tif (value){\n\t\t\twebix.DragControl.addDrag(this.$view, this);\n\t\t}\n\t\treturn value;\n\t},\n\t$dragPos:function(pos, e){\n\t\tthis.callEvent(\"onViewMove\", [pos, e]);\n\t\treturn pos;\n\t},\n\t$dragCreate:function(object, e){\n\t\tconst trg = e.target;\n\t\tif (!trg.getAttribute || trg.getAttribute(\"webix_disable_drag\") || trg.getAttribute(\"webixignore\"))\n\t\t\treturn;\n\n\t\tthis.getMenu().hide();\n\t\tconst elOffset = webix.html.offset(object);\n\t\tconst elPos = webix.html.pos(e);\n\t\tconst pOffset = webix.html.offset(object.parentNode);\n\t\tconst state = webix.$$(this.config.master).getScrollState();\n\n\t\twebix.DragControl.top = elOffset.y - elPos.y - pOffset.y;\n\t\twebix.DragControl.left = elOffset.x - elPos.x - pOffset.x + state.x;\n\n\t\treturn webix.toNode(this.$view);\n\t},\n\t$dragDestroy:function(node, drag){\n\t\tconst x = this.config.left = parseInt(drag.style.left,10);\n\t\tconst y = this.config.top = parseInt(drag.style.top,10);\n\n\t\twebix.DragControl.top = webix.DragControl.left = 0;\n\n\t\tthis.callEvent(\"onViewMoveEnd\", [x, y]);\n\t\treturn;\n\t},\n\tgetMenu:function(){\n\t\tconst labels = webix.i18n.spreadsheet.labels;\n\t\tif(!this._menu){\n\t\t\tlet data = [\n\t\t\t\t{ value:labels[\"export-view\"], submenu:[\n\t\t\t\t\t{ id:\"pdf\", value:labels[\"export-view-pdf\"] },\n\t\t\t\t\t{ id:\"png\", value:labels[\"export-view-png\"] },\n\t\t\t\t\t{ id:\"excel\", value:labels[\"export-view-excel\"] }\n\t\t\t\t] }\n\t\t\t];\n\n\t\t\tif(!webix.$$(this.config.master).getTopParentView().config.readonly)\n\t\t\t\tdata = [\n\t\t\t\t\t{ id:\"edit\", value:labels[\"edit-view\"] },\n\t\t\t\t\t...data,\n\t\t\t\t\t{ id:\"del\", value:labels[\"remove-view\"] }\n\t\t\t\t];\n\n\t\t\tthis._menu = webix.ui({\n\t\t\t\tview:\"contextmenu\",\n\t\t\t\tsubmenuConfig:{\n\t\t\t\t\texternalUI: this.config.id\n\t\t\t\t},\n\t\t\t\tdata:data,\n\t\t\t\ton:{\n\t\t\t\t\tonMenuItemClick: id => this._menuActions(id),\n\t\t\t\t\tonBeforeShow: () => this._toggleExcel()\n\t\t\t\t}\n\t\t\t});\n\t\t\tconst dots = webix.html.create(\"span\", {\"class\":\"webix_ssheet_view_menu webix_icon wxi-dots\"});\n\t\t\tthis._clickEv = webix.event(dots, \"click\", ()=> {\n\t\t\t\tif(this._menu.isVisible())\n\t\t\t\t\tthis._menu.hide();\n\t\t\t\telse\n\t\t\t\t\tthis._menu.show(dots);\n\t\t\t});\n\t\t\tthis.$view.firstChild.appendChild(dots);\n\t\t}\n\t\treturn this._menu;\n\t},\n\t_menuActions:function(id){\n\t\tswitch(id){\n\t\t\tcase \"del\":\n\t\t\t\tthis.callEvent(\"onViewRemove\", []);\n\t\t\t\tbreak;\n\t\t\tcase \"edit\":\n\t\t\t\tthis.callEvent(\"onViewEdit\", []);\n\t\t\t\tbreak;\n\t\t\tcase \"pdf\":\n\t\t\t\twebix.toPDF(this.getBody(), {display:\"image\"});\n\t\t\t\tbreak;\n\t\t\tcase \"png\":\n\t\t\t\twebix.toPNG(this.getBody());\n\t\t\t\tbreak;\n\t\t\tcase \"excel\":\n\t\t\t\twebix.toExcel(this.getBody(), {header: false});\n\t\t\t\tbreak;\n\t\t}\n\t},\n\t_toggleExcel:function(){\n\t\tconst view = this.getBody();\n\t\tif(view.data && view.data.pull)\n\t\t\tthis._menu.showItem(\"excel\");\n\t\telse\n\t\t\tthis._menu.hideItem(\"excel\");\n\t},\n\t_removeView:function(view){\n\t\tif(view && view.getTopParentView() == this)\n\t\t\tthis.callEvent(\"onViewRemove\", []);\n\t}\n}, webix.ui.window);","webix.protoUI({\n\tname: \"ssheet-series\",\n\t$init: function(config){\n\t\tconfig.rows = [\n\t\t\t{\n\t\t\t\tview: \"scrollview\",\n\t\t\t\tborderless: true,\n\t\t\t\tbody: {\n\t\t\t\t\tview: \"accordion\",\n\t\t\t\t\tcss: \"webix_ssheet_accordion\",\n\t\t\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\t\t\tmulti: true,\n\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\trows: [\n\t\t\t\t\t\tthis.getSectionConfig()\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\ton:{\n\t\t\t\t\tonAfterScroll:function(){\n\t\t\t\t\t\t//close possibly open selector popups\n\t\t\t\t\t\twebix.callEvent(\"onClick\", []);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{ view:\"button\", label:webix.i18n.spreadsheet.labels[\"add-line\"], click:()=>{\n\t\t\t\tthis.addSection();\n\t\t\t}}\n\t\t];\n\t},\n\tgetSectionConfig: function(i){\n\t\tconst view = this;\n\t\tconst labels = webix.i18n.spreadsheet.labels;\n\t\tconst trashIcon = \"<span class='webix_icon webix_ssheet_series_icon wxi-trash'></span>\";\n\t\tconst padding = webix.skin.$active.dataPadding-2;\n\n\t\treturn {\n\t\t\tview:\"accordionitem\",\n\t\t\theader:`${labels[\"chart-item\"]} ${i ? i+1 : 1} ${trashIcon}`,\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\tpadding,\n\t\t\t\telementsConfig:{\n\t\t\t\t\tlabelWidth:180\n\t\t\t\t},\n\t\t\t\ton:{\n\t\t\t\t\tonChange: () => {\n\t\t\t\t\t\tthis.callEvent(\"onChange\", []);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", label:labels[\"chart-range\"], name:\"range\", range:true, on:{\n\t\t\t\t\t\tonChange: function(val, oldVal) {\n\t\t\t\t\t\t\tconst upper = val.toUpperCase();\n\t\t\t\t\t\t\tif(val != upper){\n\t\t\t\t\t\t\t\tthis.blockEvent();\n\t\t\t\t\t\t\t\tthis.setValue(upper);\n\t\t\t\t\t\t\t\tthis.unblockEvent();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tview.callEvent(\"onRangeChange\", [upper, oldVal]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:labels[\"chart-series-color\"], name:\"color\"},\n\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-tooltip\"], name:\"tooltip\" },\n\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-label\"], name:\"label\", hidden: !this.labelsVisible },\n\t\t\t\t\t{ view:\"richselect\", label:labels[\"chart-markers\"], value:\"square\", name:\"marker\", hidden: !this.markersVisible,\n\t\t\t\t\t\tsuggest:{\n\t\t\t\t\t\t\tview: \"ssheet-form-suggest\",\n\t\t\t\t\t\t\tdata: [\n\t\t\t\t\t\t\t\t{id:\"square\", value:labels[\"chart-markers-square\"]},\n\t\t\t\t\t\t\t\t{id:\"triangle\", value:labels[\"chart-markers-triangle\"]},\n\t\t\t\t\t\t\t\t{id:\"diamond\", value:labels[\"chart-markers-diamond\"]},\n\t\t\t\t\t\t\t\t{id:\"round\", value:labels[\"chart-markers-round\"]}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\tonClick:{\n\t\t\t\t\"wxi-trash\": function(){\n\t\t\t\t\tconst layout = this.getParentView();\n\t\t\t\t\tlayout.removeView(this);\n\n\t\t\t\t\tconst childs = layout.getChildViews();\n\n\t\t\t\t\tfor (let i = 0; i < childs.length; i++) {\n\t\t\t\t\t\tchilds[i].define({header:`${labels[\"chart-item\"]} ${i+1} ${trashIcon}`});\n\t\t\t\t\t\tchilds[i].refresh();\n\t\t\t\t\t}\n\n\t\t\t\t\tview.callEvent(\"onChange\", []);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t},\n\taddSection: function(){\n\t\tconst layout = this.getLayout();\n\t\tconst lastIndex = layout.getChildViews().length;\n\t\tconst layoutId = layout.addView(this.getSectionConfig(lastIndex));\n\n\t\twebix.$$(layoutId).queryView({name: \"range\"}).focus();\n\t},\n\tsetValue: function(value){\n\t\tvalue = value || [];\n\n\t\tconst layout = this.getLayout();\n\t\tconst childs = layout.getChildViews();\n\t\tconst count = childs.length;\n\n\t\tif(count > value.length)\n\t\t\tfor(let i = count; i > value.length; i--)\n\t\t\t\tthis.getLayout().removeView(childs[i-1]);\n\t\telse if(value.length > count)\n\t\t\tfor(let i = value.length; i > count; i--)\n\t\t\t\tthis.addSection();\n\n\t\tfor(let i = 0; i < childs.length; i++){\n\t\t\tconst form = childs[i].getChildViews()[0];\n\t\t\tconst range = form.queryView({name: \"range\"});\n\n\t\t\t//block range events to ignore onRangeChange\n\t\t\trange.blockEvent();\n\t\t\tform.setValues(value[i]);\n\t\t\trange.unblockEvent();\n\t\t}\n\t},\n\tsetSubValue: function(sub, value){\n\t\tsub.blockEvent();\n\t\tsub.setValue(value);\n\t\tsub.unblockEvent();\n\t},\n\tgetLayout(){\n\t\treturn this.queryView(\"scrollview\").getBody();\n\t},\n\thideSubviews(name, show){\n\t\tif(name == \"marker\")\n\t\t\tthis.markersVisible = show;\n\t\telse\n\t\t\tthis.labelsVisible = show;\n\n\t\tthis.queryView({ name }, \"all\").forEach(view => {\n\t\t\tif(show)\n\t\t\t\tview.show();\n\t\t\telse\n\t\t\t\tview.hide();\n\t\t});\n\t},\n\tgetValue: function(){\n\t\tconst value = [];\n\n\t\tconst layout = this.getLayout();\n\t\tlayout.getChildViews().forEach(child => {\n\t\t\tvalue.push(child.getChildViews()[0].getValues());\n\t\t});\n\t\treturn value;\n\t}\n}, webix.ui.layout);","import {getJsDateFromExcel, getExcelDateFromJs} from \"../mathematics/methods\";\nimport {getDateEditFormat} from \"../operations/formats\";\n\nwebix.editors.excel_date = webix.extend({\n\tcreatePopup:function(){\n\t\tconst editor = webix.editors.excel_date;\n\n\t\tif(!editor.popup){\n\t\t\tconst popup = webix.ui({\n\t\t\t\tview:\"popup\",\n\t\t\t\tbody:{ \n\t\t\t\t\tview:\"calendar\",\n\t\t\t\t\ticons:true,\n\t\t\t\t\ttimepicker:true,\n\t\t\t\t\ton:{\n\t\t\t\t\t\tonChange: function(val){\n\t\t\t\t\t\t\tval = val[0];\n\t\t\t\t\t\t\tthis.getParentView()._last_input_target.value = val ? getExcelDateFromJs(val) : \"\";\n\t\t\t\t\t\t\twebix.callEvent(\"onEditEnd\", []);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ton:{\n\t\t\t\t\tonEnter: function(){\n\t\t\t\t\t\twebix.callEvent(\"onEditEnd\", []);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\teditor.popup = popup.config.id;\n\t\t}\n\n\t\treturn editor.popup;\n\t},\n\trender:function(){\n\t\tconst node = webix.html.create(\"div\", {\n\t\t\t\"class\":\"webix_dt_editor\"\n\t\t}, \"<input type='text'>\");\n\n\t\tthis.popup = this.createPopup();\n\n\t\twebix.event(node.firstChild, \"click\", ()=> this.getPopup().show(node));\n\n\t\treturn node;\n\t},\n\tgetPopup(){\n\t\treturn webix.$$(this.popup);\n\t},\n\tshowPopup:function(){\n\t\tconst input = this.getInputNode();\n\t\tconst popup = this.getPopup();\n\n\t\tpopup._last_input_target = input;\n\t\tpopup.show(input);\n\n\t\tinput.setAttribute(\"aria-expanded\", \"true\");\n\t},\n\tupdateCalendar(value){\n\t\tconst calendar = this.getPopup().getBody();\n\n\t\tcalendar.blockEvent();\n\t\tcalendar.setValue(value);\n\t\tcalendar.unblockEvent();\n\t},\n\tafterRender:function(){\n\t\tthis.showPopup();\n\t},\n\tsetValue:function(value){\n\t\tconst noDate = (value === \"\" || isNaN(value*1));\n\t\tvalue = noDate ? new Date() : getJsDateFromExcel(value);\n\t\tthis.updateCalendar(value);\n\n\t\tconst view = webix.$$(this.config.node).queryView(a => a.name === \"spreadsheet\", \"parent\");\n\t\tconst format = getDateEditFormat(view, this.config.row.id, this.config.id);\n\t\tthis.getInputNode().value = format(value);\n\t},\n\tgetValue:function(){\n\t\tconst value = this.getInputNode().value;\n\t\tthis.getPopup().hide();\n\t\treturn value;\n\t}\n}, webix.editors.text);","webix.editors.ss_richselect = webix.extend({\n\tgetFormat:function(value){\n\t\tconst list = this.getInputNode();\n\t\tlet item;\n\n\t\tif (value && list.exists(value))\n\t\t\titem = list.getItem(value);\n\t\treturn item && item.format;\n\t},\n\tpopupInit:function(popup){\n\t\twebix.editors.richselect.popupInit.apply(this, arguments);\n\n\t\tpopup.getList().define(\"template\", function(obj){\n\t\t\treturn obj.$value || obj.value;\n\t\t});\n\t}\n}, webix.editors.richselect);","import {changeAreaDecimals} from \"../operations/formats\";\n\nexport const actions = {\n\tspan: function(view){\n\t\tvar range = view.$$(\"cells\").getSelectArea();\n\t\tif(range){\n\t\t\tif(isMerged(view,range)){\n\t\t\t\tview.splitCell();\n\t\t\t}\n\t\t\telse{\n\t\t\t\tlet values = [];\n\t\t\t\tfor(let r = range.start.row; r<=range.end.row; r++){\n\t\t\t\t\tfor(let c = range.start.column; c<=range.end.column; c++){\n\t\t\t\t\t\tlet value = view.getCellValue(r,c);\n\t\t\t\t\t\tif(value) values.push(value);\n\t\t\t\t\t\tif(values.length >1) break;\n\t\t\t\t\t}\n\t\t\t\t\tif(values.length >1) break;\n\t\t\t\t}\n\t\t\t\tif(values.length>1){\n\t\t\t\t\tview.confirm({\n\t\t\t\t\t\ttext:webix.i18n.spreadsheet.labels[\"merge-cell-confirm\"]\n\t\t\t\t\t}).then(()=> view.combineCells() );\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tview.combineCells();\n\t\t\t}\n\t\t}\n\t},\n\tundo: function(view){\n\t\tview.undo();\n\t},\n\tredo: function(view){\n\t\tview.redo();\n\t},\n\t\"hide-gridlines\": function(view){\n\t\tview.hideGridlines(\"toggle\");\n\t},\n\t\"hide-headers\": function(view){\n\t\tview.hideHeaders(\"toggle\");\n\t},\n\t\"freeze-columns\": function(view){\n\t\tvar table = view.$$(\"cells\");\n\t\tvar select = table.getSelectedId();\n\t\tview.freezeColumns(select && select.column!=\"rowId\"?select.column : 0);\n\t},\n\t\"freeze-rows\":function(view){\n\t\tvar table = view.$$(\"cells\");\n\t\tvar select = table.getSelectedId();\n\t\tview.freezeRows(select ? select.row : 0);\n\t},\n\t\"increase-decimals\": function(view){\n\t\tchangeAreaDecimals(view, 1);\n\t},\n\t\"decrease-decimals\": function(view){\n\t\tchangeAreaDecimals(view, -1);\n\t},\n};\n\nfunction isMerged(view,range){\n\tvar i, j,\n\t\tc0 = range.start,\n\t\tc1 = range.end;\n\n\tfor( i = c0.row*1; i <= c1.row*1; i++ ){\n\t\tfor( j = c0.column*1; j <= c1.column*1; j++ ){\n\t\t\tif(view.$$(\"cells\").getSpan(i, j))\n\t\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n","import {toolbarSizes, defaultStyles} from \"./defaults\";\nimport {formatHelpers} from \"../operations/formats\";\n\n// options for 'font-family' select\nexport const fontFamily = [\n\t{id: \"Arial\", value: \"Arial\"},\n\t{id: \"'Roboto', sans-serif\", value: \"Roboto\"},\n\t{id: \"'PT Sans', Tahoma\", value: \"PT Sans\"},\n\t{id: \"Tahoma\", value: \"Tahoma\"},\n\t{id: \"Verdana\", value: \"Verdana\"},\n\t{id: \"Calibri, Tahoma\", value:\"Calibri\"}\n];\n\n// options for 'format' select\nfunction getCellFormats(){\n\tconst locale = webix.i18n.spreadsheet.labels;\n\treturn [\n\t\t{id: \"common\", value: locale.common },\n\t\t{id: \"price\", value: locale.currency, example: \"98.20\"},\n\t\t{id: \"int\", value: locale.number, example: \"2120.02\"},\n\t\t{id: \"percent\", value: locale.percent, example:\"0.5\"},\n\t\t{id: \"date\", value: locale.date, example:\"45000\"},\n\t\t{id: \"string\", value: locale.string, example:\"012345\"},\n\t\t{id: \"custom\", value: locale[\"custom-format\"]},\n\t];\n}\n\nexport function getColumnOperation(view){\n\tconst locale = webix.i18n.spreadsheet.menus;\n\tlet colOperations = [\n\t\t{ id:\"add\",    group:\"column\", value:locale[\"insert-column\"]},\n\t\t{ id:\"del\",    group:\"column\", value:locale[\"delete-column\"]},\n\t\t{ id:\"show\",   group:\"column\", value:locale[\"show-column\"]},\n\t\t{ id:\"hide\",   group:\"column\", value:locale[\"hide-column\"]}\n\t];\n\tif(view.config.resizeCell != false)\n\t\tcolOperations.push({ id:\"resize\", group:\"column\", value:locale[\"resize-column\"]});\n\treturn colOperations;\n}\n\nexport function getRowOperation(view){\n\tconst locale = webix.i18n.spreadsheet.menus;\n\tlet rowOperations = [\n\t\t{ id:\"add\",    group:\"row\", value:locale[\"insert-row\"]},\n\t\t{ id:\"del\",    group:\"row\", value:locale[\"delete-row\"]},\n\t\t{ id:\"show\",   group:\"row\", value:locale[\"show-row\"]},\n\t\t{ id:\"hide\",   group:\"row\", value:locale[\"hide-row\"]}\n\t];\n\tif(view.config.resizeCell != false)\n\t\trowOperations.push({ id:\"resize\", group:\"row\", value:locale[\"resize-row\"]});\n\treturn rowOperations;\n}\n\n// options for 'clear' select\nexport function getClearOperation(){\n\treturn [\n\t\t{id: \"clear-value\",               value: getLocaleClear(\"value\")},\n\t\t{id: \"clear-style\",               value: getLocaleClear(\"style\")},\n\t\t{id: \"clear-conditional-formats\", value: getLocaleClear(\"conditional-formats\")},\n\t\t{id: \"clear-dropdown-editors\",    value: getLocaleClear(\"dropdown-editors\")},\n\t\t{id: \"clear-comments\",            value: getLocaleClear(\"comments\")},\n\t\t{ $template: \"Separator\" },\n\t\t{id: \"clear-all\",                 value: getLocaleClear(\"all\")}\n\t];\n}\n\n// options for 'borders' select\nconst borders = [\n\t{id: \"no\", value: \"no\"},\n\t{id: \"left\", value: \"left\"},\n\t{id: \"top\", value: \"top\"},\n\t{id: \"right\", value: \"right\"},\n\t{id: \"bottom\", value: \"bottom\"},\n\t{id: \"all\", value: \"all\"},\n\t{id: \"outer\", value: \"outer\"},\n\t{id: \"top-bottom\", value: \"top-bottom\"}\n];\n\nfunction getLocaleClear(value){\n\tvar locale = webix.i18n.spreadsheet.menus;\n\treturn locale[\"clear\"] + \" \" + locale[\"clear-\"+value].toLowerCase();\n}\n\n// options for 'font-size' select\nfunction getFontSize(){\n\tvar numbers = [\n\t\t\"8\",\"9\",\"10\",\"11\",\"12\",\"14\",\"15\",\n\t\t\"16\",\"18\",\"20\",\"22\",\"24\",\"28\",\"36\"\n\t];\n\tvar  fontSize = [];\n\n\tfor(var i =0; i < numbers.length; i++){\n\t\tfontSize.push({id: numbers[i]+webix.i18n.spreadsheet.labels.px, value: numbers[i]});\n\t}\n\treturn fontSize;\n}\n\nexport const styleFormats = {\n\t\"font-weight\": \"bold\",\n\t\"font-style\": \"italic\",\n\t\"text-decoration\": \"underline\"\n};\n\nexport const ui = {\n\tbutton: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-toggle\", width: config.width||toolbarSizes.width, id: config.name, name: config.name,  label: config.label,\n\t\t\tcss: config.css||\"\", onValue: styleFormats[config.name], offValue: \"normal\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||\"\"\n\t\t};\n\t},\n\tcolorButton: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-color\",  css: config.css,  name: config.name, width: config.width||toolbarSizes.width+24,\n\t\t\ttitle: \"<span class='webix_ssheet_button_icon webix_ssheet_color_button_icon webix_ssheet_icon ssi-\"+config.name+\"' ></span>\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||\"\"\n\t\t};\n\t},\n\ttoggleButton: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-toggle-silent\", width: toolbarSizes.width, id: config.name, name: config.name,\n\t\t\tlabel: \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\"+config.name+\"'></span>\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||\"\"\n\t\t};\n\t},\n\ticonButton: function(config){\n\t\tvar btn = webix.copy(config);\n\t\twebix.extend(btn, {view: \"button\", width: toolbarSizes.width, id: config.name,\n\t\t\tlabel: \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\"+config.name+\"'></span>\",\n\t\t\tcss: \"\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||webix.i18n.spreadsheet.menus[config.name]||\"\"\n\t\t});\n\t\tif(config.onValue){\n\t\t\twebix.extend(btn,{view: \"ssheet-toggle\", onValue: config.onValue, offValue: config.offValue},true);\n\t\t}\n\n\t\treturn btn;\n\t},\n\tsegmented: function(config){\n\t\treturn  {\n\t\t\tview: \"segmented\", name: config.name, css:config.css||\"\", width: config.width||toolbarSizes.width+76,  options:config.options\n\t\t};\n\t},\n\tselect: function(config){\n\t\twebix.extend(config,{\n\t\t\tview: \"richselect\",\n\t\t\tid: config.name,\n\t\t\tvalue: defaultStyles[config.name],\n\t\t\tsuggest: {\n\t\t\t\tcss: \"webix_ssheet_suggest\",\n\t\t\t\t//fitMaster: false,\n\t\t\t\tpadding: 0,\n\t\t\t\tdata: config.options\n\t\t\t}\n\t\t});\n\n\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\tif(config.popupWidth){\n\t\t\tconfig.suggest.fitMaster = false;\n\t\t\tconfig.suggest.width = config.popupWidth;\n\t\t}\n\t\tif(config.popupTemplate)\n\t\t\tconfig.suggest.body = {\n\t\t\t\ttemplate: config.popupTemplate\n\t\t\t};\n\t\tif(config.popupEvents){\n\t\t\tconfig.suggest.body = config.suggest.body || {};\n\t\t\tconfig.suggest.body.on = config.popupEvents;\n\t\t}\n\t\treturn config;\n\t},\n\tseparator: function(){\n\t\treturn {\n\t\t\tview: \"ssheet-separator\"\n\t\t};\n\t},\n\ttitle: function(config){\n\t\tvar title = config.title;\n\t\tif(title.indexOf(\"$\") === 0)\n\t\t\ttitle = \"\";\n\t\ttitle = webix.i18n.spreadsheet.labels[config.title]||title;\n\n\t\treturn {\n\t\t\ttemplate: title, view: \"ssheet-bar-title\", height: toolbarSizes.titleHeight\n\t\t};\n\t},\n\tborders: function(config){\n\t\treturn {view: \"ssheet-borders\", width:config.width||toolbarSizes.width+24, data: borders, id: config.name, name: config.name,\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name] };\n\t},\n\talign: function(config){\n\t\treturn {view: \"ssheet-align\", value: defaultStyles[config.name], width:config.width||toolbarSizes.width+24, data: config.options,\n\t\t\tname: config.name, tooltip: webix.i18n.spreadsheet.tooltips[config.name] };\n\t},\n\tcondFormat: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-cond-format\",\n\t\t\twidth: 40,\n\t\t\tid: config.name,\n\t\t\tname: config.name\n\t\t};\n\t}\n};\n\nexport const buttonsMap = {\n\t\"font-family\": function(){\n\t\treturn  ui.select({name: \"font-family\", options:fontFamily, width: 100});\n\t},\n\t\"font-size\": function(){\n\t\treturn  ui.select({name: \"font-size\", options:getFontSize(), width: 64});\n\t},\n\t\"font-weight\": function(){\n\t\treturn ui.button({name:\"font-weight\",label: \"B\", css: \"webix_ssheet_bold\"});\n\t},\n\t\"font-style\": function(){\n\t\treturn ui.button({name: \"font-style\",label: \"I\",css:\"webix_ssheet_italic\"});\n\t},\n\t\"text-decoration\": function(){\n\t\treturn ui.button({name: \"text-decoration\",label: \"U\",css: \"webix_ssheet_underline\"});\n\t},\n\t\"color\": function(){\n\t\treturn ui.colorButton({name: \"color\",icon:\"font\",css:\"webix_ssheet_color\"});\n\t},\n\t\"background\": function(){\n\t\treturn  ui.colorButton({name: \"background\",icon:\"paint-brush\",css:\"webix_ssheet_background\", width: 64});\n\t},\n\t\"borders\": function(){\n\t\treturn ui.borders({ name: \"borders\" });\n\t},\n\t\"text-align\": function(){\n\t\tvar locale = webix.i18n.spreadsheet.tooltips;\n\t\treturn ui.align({name: \"text-align\", css: \"webix_ssheet_align\", options:[\n\t\t\t{id: \"left\", css: \"webix_ssheet_icon ssi-left\", tooltip: locale[\"align-left\"]},\n\t\t\t{id: \"center\", css: \"webix_ssheet_icon ssi-center\", tooltip: locale[\"align-center\"]},\n\t\t\t{id: \"right\", css: \"webix_ssheet_icon ssi-right\", tooltip: locale[\"align-right\"]}\n\t\t]});\n\t},\n\t\"vertical-align\": function(){\n\t\tvar locale = webix.i18n.spreadsheet.tooltips;\n\t\treturn  ui.align({name: \"vertical-align\", css: \"webix_ssheet_align\", options:[\n\t\t\t{id: \"top\", css: \"webix_ssheet_icon ssi-top\", tooltip: locale[\"align-top\"]},\n\t\t\t{id: \"middle\", css: \"webix_ssheet_icon ssi-middle\", tooltip: locale[\"align-middle\"]},\n\t\t\t{id: \"bottom\", css: \"webix_ssheet_icon ssi-bottom\", tooltip: locale[\"align-bottom\"]}\n\t\t]});\n\t},\n\t\"wrap\": function(){\n\t\treturn ui.iconButton({name: \"wrap\", onValue:\"wrap\", offValue:\"nowrap\"});\n\t},\n\t\"format\": function(){\n\t\treturn ui.select({\n\t\t\tname: \"format\", width: 106, options:getCellFormats(), popupWidth: 180,\n\t\t\tpopupTemplate: function(obj){\n\t\t\t\t//make it look like an actual cell\n\t\t\t\tvar format =  formatHelpers[obj.id] ? formatHelpers[obj.id].getFormat : \"\";\n\t\t\t\tvar cell = {css:\"\"};\n\t\t\t\tvar example = format && obj.example?format(obj.example, cell):\"\";\n\t\t\t\treturn obj.value + (format?\"<span class='webix_ssheet_right\"+(cell.css?\" \"+cell.css:\"\")+\"'>\"+example+\"</span>\":\"\");\n\t\t\t},\n\t\t\tpopupEvents:{\n\t\t\t\tonItemClick: function(id){\n\t\t\t\t\tif(id == \"custom\")\n\t\t\t\t\t\tthis.getTopParentView().callEvent(\"onCommand\", [{id:id}]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\t\"column\": function(view){\n\t\treturn {\n\t\t\tname: \"column\",\n\t\t\tview: \"ssheet-button\", icon: \"column\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getColumnOperation(view)\n\t\t};\n\t},\n\t\"row\": function(view){\n\t\treturn {\n\t\t\tname: \"row\", view: \"ssheet-button\", icon: \"row\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getRowOperation(view)\n\t\t};\n\t},\n\t\"clear\": function(){\n\t\treturn {\n\t\t\tname: \"clear\", view: \"ssheet-button\", icon: \"clear-styles\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getClearOperation()\n\t\t};\n\t},\n\t\"image\":function(){\n\t\treturn {\n\t\t\tname:\"image\", view:\"ssheet-button\", icon:\"add-image\",\n\t\t\tarrow:true, options:[\n\t\t\t\t{id:\"add-image-cell\", value: webix.i18n.spreadsheet.labels[\"add-image-cell\"]},\n\t\t\t\t{id:\"add-image-top\", value: webix.i18n.spreadsheet.labels[\"add-image-top\"]}\n\t\t\t]\n\t\t};\n\t},\n\t\"graph\":function(){\n\t\treturn {\n\t\t\tname:\"graph\", view:\"ssheet-button\", icon:\"add-sparkline\",\n\t\t\tarrow:true, options:[\n\t\t\t\t{id:\"add-sparkline\", value:webix.i18n.spreadsheet.labels[\"add-sparkline\"]},\n\t\t\t\t{id:\"add-chart\", value: webix.i18n.spreadsheet.labels[\"add-chart\"]}\n\t\t\t]\n\t\t};\n\t},\n\t\"comment\": function(){\n\t\treturn {\n\t\t\tname: \"comment\",\n\t\t\tview: \"ssheet-button\", icon: \"comments\",\n\t\t\tarrow: true, area: true, width: 55\n\t\t};\n\t},\n\t\"create-filter\": function(){\n\t\treturn ui.toggleButton({name: \"create-filter\"});\n\t},\n\t\"hide-gridlines\": function(){\n\t\treturn ui.toggleButton({name: \"hide-gridlines\"});\n\t},\n\t\"hide-headers\": function(){\n\t\treturn ui.toggleButton({name: \"hide-headers\"});\n\t}\n};","import {toolbarSizes} from \"./defaults\";\n\nfunction getText(text){\n\tvar locale = webix.i18n.spreadsheet;\n\treturn locale.menus[text] || locale.labels[text] || locale.tooltips[text] || text;\n}\nfunction calcButtons(){\n\tvar i, name, width,\n\t\tgroups = {\n\t\t\t\"undo\":[\"undo\",\"redo\"],\n\t\t\t\"insert\":[\"add-sparkline\",\"add-image\",\"add-comment\"]\n\t\t},\n\t\tresult = {};\n\n\tfor( name in groups){\n\t\tresult[name] = 0;\n\t\tfor(i=0; i < groups[name].length; i++){\n\t\t\twidth = webix.html.getTextSize(getText(groups[name][i]), \"webix_ssheet_button_measure\").width + 7;\n\t\t\tresult[name] = Math.max(width,result[name]);\n\t\t}\n\t}\n\treturn result;\n}\nexport function getAllElements(){\n\tvar sizes = calcButtons();\n\tvar titleHeight = toolbarSizes.titleHeight;\n\n\treturn [\n\t\t{\n\t\t\tpadding: 3,\n\t\t\tmargin: 0,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"sheet\", view: \"ssheet-button-icon-top\", label: getText(\"sheet\"), arrow: true,\n\t\t\t\t\t\t\toptions:[\n\t\t\t\t\t\t\t\t{id: \"new-sheet\"},\n\t\t\t\t\t\t\t\t{id: \"copy-sheet\"},\n\t\t\t\t\t\t\t\t{id: \"remove-sheet\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button: \"excel-import\"},\n\t\t\t\t\t\t\t\t{$button: \"excel-export\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button: \"print\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t\t{template: getText(\"file\"), view: \"ssheet-bar-title\", height: titleHeight, width: 85}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{$button: \"undo\", view: \"ssheet-button\", label: getText(\"undo\"), width: sizes.undo },\n\t\t\t\t{$button: \"redo\", view: \"ssheet-button\", label: getText(\"redo\"), width: sizes.undo},\n\t\t\t\t{template: getText(\"undo-redo\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmargin: 2,\n\t\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t\t{$button: \"font-family\", width: (webix.skin.$active.inputHeight+2)*3+4},\n\t\t\t\t\t\t\t\t{$button: \"font-size\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{$button: \"borders\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmargin: 2,\n\t\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t\t{$button: \"font-weight\"},\n\t\t\t\t\t\t\t\t{$button: \"font-style\"},\n\t\t\t\t\t\t\t\t{$button: \"text-decoration\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\t{$button: \"background\"},\n\t\t\t\t\t\t{$button: \"color\"}\n\t\t\t\t\t]\n\n\t\t\t\t},\n\t\t\t\t{template: getText(\"font\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"text-align\"},\n\t\t\t\t\t\t{$button: \"span\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"vertical-align\"},\n\n\t\t\t\t\t\t{$button: \"wrap\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{template: getText(\"align\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{$button: \"format\"},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"increase-decimals\"},\n\t\t\t\t\t\t{$button: \"decrease-decimals\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\n\t\t\t\t{template: getText(\"number\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{cols:[\n\t\t\t\t\t{ $button: \"sort-asc\"},\n\t\t\t\t\t{ $button: \"create-filter\"},\n\t\t\t\t\t{ $button: \"conditional-format\"},\n\t\t\t\t\t{ $button: \"add-link\"},\n\t\t\t\t\t{ $button: \"clear\"}\n\t\t\t\t]},\n\t\t\t\t{cols:[\n\t\t\t\t\t{ $button: \"sort-desc\"},\n\t\t\t\t\t{ $button: \"add-range\"},\n\t\t\t\t\t{ $button: \"lock-cell\"},\n\t\t\t\t\t{ $button: \"add-dropdown\"}\n\t\t\t\t]},\n\t\t\t\t{template: getText(\"edit\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"image\", view: \"ssheet-button\", label: getText(\"image\"), width:sizes.insert},\n\t\t\t\t\t\t{$button: \"add-comment\", view: \"ssheet-button\", label: getText(\"comment\"), width:sizes.insert},\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{$button: \"graph\", view: \"ssheet-button\", label: getText(\"graph\"), width:sizes.insert},\n\t\t\t\t{template: getText(\"insert\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{rows:[\n\t\t\t\t\t\t\t{$button:\"row\"},\n\t\t\t\t\t\t\t{$button:\"column\"}\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button:\"hide-gridlines\"},\n\t\t\t\t\t\t\t\t{$button:\"hide-headers\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button:\"freeze-rows\"},\n\t\t\t\t\t\t\t\t{$button:\"freeze-columns\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{template: getText(\"view\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{}\n\t];\n}","import {actions} from \"./toolbar/actions\";\nimport {defaultStyles} from \"./toolbar/defaults\";\nimport {toolbarButtons, getButtons} from \"./toolbar/helpers\";\nimport * as elm from \"./toolbar/all_elements\";\nimport {isCustom} from \"./operations/formats\";\nimport {getStyle, getFormat} from \"./operations/styles\";\n\nconst buttons = {\n\t\"undo-redo\": [\"undo\",\"redo\"],\n\t\"font\": [\"font-family\",\"font-size\",\"font-weight\",\"font-style\",\"text-decoration\",\"color\",\"background\",\"borders\"],\n\t\"align\": [\"text-align\",\"vertical-align\",\"wrap\",\"span\"],\n\t\"format\": [\"format\"]\n};\n\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\tview.attachEvent(\"onCommand\", (action) => {\n\t\tif (action.id == \"toolbar-update\")\n\t\t\tupdateValue(view, action.name, action.value);\n\t});\n\n\tvar elements = [];\n\n\tif(view.config.toolbar){\n\t\tlet allElements =  view.config.toolbar;\n\t\tif(allElements == \"full\"){\n\t\t\tallElements = elm.getAllElements();\n\t\t\tif(webix.isUndefined(view.config.bottombar))\n\t\t\t\tview.config.bottombar = true;\n\t\t}\n\t\telements =   toolbarButtons(view, allElements);\n\t}\n\telse\n\t\telements =   getButtons(view, view.config.buttons || buttons);\n\n\tvar bar = {\n\t\tview:\"toolbar\",\n\t\tcss: \"webix_ssheet_toolbar webix_layout_toolbar\",\n\t\tid:\"bar\",\n\t\tpadding:0,\n\t\telements: elements,\n\t\ton: {\n\t\t\tonChange: function (){\n\t\t\t\tvar source = this.$eventSource;\n\t\t\t\tvar value = source.getValue();\n\t\t\t\tvar name = source.config.name;\n\t\t\t\tif(name == \"format\" && value == \"common\")\n\t\t\t\t\tvalue = \"\";\n\t\t\t\tif(!(name == \"format\" && value == \"custom\"))\n\t\t\t\t\tview.callEvent(\"onStyleSet\", [name, value]);\n\t\t\t},\n\t\t\tonItemClick: function (id){\n\t\t\t\tvar viewId = view.innerId(id);\n\t\t\t\tif (actions[viewId])\n\t\t\t\t\tactions[viewId].call(this, view);\n\t\t\t\telse\n\t\t\t\t\tview.callEvent(\"onCommand\", [{ id: viewId }]);\n\t\t\t}\n\t\t}\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"toolbar\", bar]);\n\treturn bar;\n\n}\n\nfunction ready(view){\n\tview.attachEvent(\"onAfterSelect\", (selected) => setValues(view, selected));\n}\n\nfunction setValues(view, selected) {\n\tconst barStyles = getBarStyles(view, selected);\n\tview.$$(\"bar\").setValues(barStyles);\n}\n\nfunction updateValue(view, name, value){\n\tconst element = view.$$(\"bar\").elements[name];\n\n\tif (element)\n\t\telement.setValue(value);\n}\n\nfunction getBarStyles(view, selected){\n\tconst dropdowns = [\n\t\t\"font-family\",\n\t\t\"font-size\",\n\t\t\"text-align\",\n\t\t\"vertical-align\",\n\t\t\"format\",\n\t\t\"background\",\n\t\t\"color\"\n\t];\n\n\tconst cell = selected[0];\n\tconst barStyles = getCellStyles(view, cell);\n\n\tfor(let i = 1; i < selected.length; i++){\n\t\tconst cellStyle = getCellStyles(view, selected[i]);\n\n\t\tfor(let k = dropdowns.length-1; k >= 0; k--){\n\t\t\tconst property = dropdowns[k];\n\t\t\tif(barStyles[property] != cellStyle[property]){\n\t\t\t\tdelete barStyles[property];\n\t\t\t\tdropdowns.splice(k, 1);\n\t\t\t}\n\t\t}\n\n\t\tif(!dropdowns.length)\n\t\t\tbreak;\n\t}\n\n\treturn barStyles;\n}\n\nfunction getCellStyles(view, cell){\n\tconst span = view.$$(\"cells\").getSpan(cell.row, cell.column);\n\tif(span)\n\t\t[cell.row, cell.column] = span;\n\n\tconst obj = getStyle(view, cell);\n\tconst styles = obj ? webix.copy(obj.props) : {};\n\n\tfor (let i in defaultStyles)\n\t\tif(!styles[i])\n\t\t\tstyles[i] = defaultStyles[i];\n\n\tconst format = getFormat(view, cell.row, cell.column) || \"common\";\n\tstyles.format = isCustom(format) ? \"custom\" : format;\n\n\treturn styles;\n}","import {ui, buttonsMap} from \"./buttons\";\n\nexport function toolbarButtons(view,structure){\n\tvar checkButtons = function(cells){\n\t\tfor(var i =0; i < cells.length; i++){\n\t\t\tvar name = cells[i].$button;\n\t\t\tif (name){\n\t\t\t\tvar base = buttonsMap[name] ? buttonsMap[name](view) : ui.iconButton({name:name});\n\t\t\t\twebix.extend(cells[i], base);\n\t\t\t}\n\t\t\t\n\t\t\tif(cells[i].rows)\n\t\t\t\tcheckButtons(cells[i].rows);\n\t\t\tif(cells[i].cols)\n\t\t\t\tcheckButtons(cells[i].cols);\n\t\t}\n\t};\n\tcheckButtons(structure);\n\treturn structure;\n}\n\nexport function getButtons(view,structure){\n\tvar config = [];\n\tfor(var block in structure){\n\t\tconfig.push(elementsBlock(view, block, structure[block]));\n\t\tconfig.push(ui.separator());\n\t}\n\treturn config;\n}\n\nfunction blockColumns(view, buttons){\n\tvar cols = [];\n\tfor(var i =0; i < buttons.length; i++){\n\t\tlet name = buttons[i];\n\t\tif(typeof name == \"object\"){\n\t\t\tcols.push(name);\n\t\t}\n\t\telse {\n\t\t\tvar base = buttonsMap[name] ? buttonsMap[name](view) : ui.iconButton({name:name});\n\t\t\tcols.push(base);\n\t\t}\n\t}\n\treturn cols;\n}\n\n\nfunction elementsBlock(view, name, columns){\n\tvar block = {\n\t\trows:[\n\t\t\t{\n\t\t\t\tpadding:2,\n\t\t\t\tcols:[{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols: blockColumns(view, columns)\n\t\t\t\t}]\n\t\t\t},\n\t\t\tui.title({title:name})\n\t\t]\n\t};\n\treturn block;\n}","import {getTextSize} from \"./styles\";\n\nexport function selectRow(row, view, endRow){\n\tvar columns = view.$$(\"cells\").config.columns;\n\tvar firstColumn = columns[0].id == \"rowId\" ? 1 : 0;\n\n\tvar start = {\n\t\trow:row,\n\t\tcolumn:columns[firstColumn].id\n\t};\n\tvar last = {\n\t\trow: (endRow || row),\n\t\tcolumn: columns[columns.length-1].id\n\t};\n\n\tif(start.column && last.column)\n\t\t_selectRange(start, last, view);\n}\n\nexport function selectAll(view){\n\tvar order = view.$$(\"cells\").data.order;\n\tvar columns = view.$$(\"cells\").config.columns;\n\tvar firstColumn = columns[0].id == \"rowId\" ? 1 : 0;\n\n\tvar start = {\n\t\trow: order[0],\n\t\tcolumn: columns[firstColumn].id\n\t};\n\tvar last = {\n\t\trow: order[order.length-1],\n\t\tcolumn: columns[columns.length-1].id\n\t};\n\n\tif(start.column && last.column)\n\t\t_selectRange(start, last, view);\n}\n\nexport function selectColumn(column, view, endColumn){\n\tvar order = view.$$(\"cells\").data.order;\n\tvar startRow = order[0];\n\tvar lastRow = order[order.length-1];\n\n\tvar start = {row: startRow, column: column};\n\tvar last = {row: lastRow, column: (endColumn || column) };\n\n\t_selectRange(start, last, view);\n}\n\nexport function isColSelected(column, view){\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\tif (selectedArea){\n\t\tif (column >= selectedArea.start.column && column <= selectedArea.end.column)\n\t\t\treturn true;\n\t}\n\treturn false;\n}\n\nexport function isCellSelected(row, column, view){\n\treturn isRowSelected(row, view) && isColSelected(column, view);\n}\n\nexport function isRowSelected(row, view){\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\tif (selectedArea){\n\t\tif (row >= selectedArea.start.row && row <= selectedArea.end.row)\n\t\t\treturn true;\n\t}\n\treturn false;\n}\n\nexport function selectColumns(column, view) {\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\n\tif (!selectedArea)\n\t\tselectColumn(column, view);\n\telse {\n\t\tlet col1 = Math.min(selectedArea.start.column, selectedArea.end.column, column);\n\t\tlet col2 = Math.max(selectedArea.start.column, selectedArea.end.column, column);\n\t\tselectColumn(col1, view, col2);\n\t}\n}\n\nfunction _selectRange(a, b, view){\n\tview.$$(\"cells\").addSelectArea(a, b);\n}\n\n\nexport function adjustColumn(column, view) {\n\tlet width = 25;\n\tconst columnWidth = view._table.getColumnConfig(column).width;\n\n\tview._table.eachRow(function(row) {\n\t\tconst span = view._table.getSpan(row, column);\n\t\tif(span && span[2] > 1)\n\t\t\treturn;\n\n\t\tconst text = this.getText(row, column);\n\t\tconst style = view.getStyle(row, column);\n\t\tconst css = style ? style.id : \"\";\n\n\t\tif (text.replace(/<\\/?[^>]+(>|$)/g, \"\")) {\n\t\t\tconst size = getTextSize(view, text, css);\n\n\t\t\tif(view.getCellEditor(row, column))\n\t\t\t\tsize.width += 20;\n\t\t\tif(view.getCellFilter(row, column))\n\t\t\t\tsize.width += 20;\n\n\t\t\tif(style && style.props.wrap == \"wrap\" && size.width > columnWidth)\n\t\t\t\tsize.width = columnWidth;\n\t\t\tif (size.width > width)\n\t\t\t\twidth = size.width;\n\t\t}\n\t});\n\tview._table.setColumnWidth(column, width);\n}\n\nexport function adjustRow(row, view) {\n\tlet height = 25;\n\n\tview._table.eachColumn(function(column) {\n\t\tif(column != \"rowId\"){\n\t\t\tconst text = this.getText(row, column);\n\n\t\t\t// if there is text wrap in cell we need to know width to get correct height\n\t\t\tlet width = this.getColumnConfig(column).width;\n\t\t\tconst span = view._table.getSpan(row, column);\n\t\t\tif(span)\n\t\t\t\twidth = view._table.getSpanNode({row:span[0], column:span[1]}).offsetWidth;\n\n\t\t\tlet style = view.getStyle(row, column);\n\t\t\tlet css = style ? style.id : \"\";\n\n\t\t\tif (text.replace(/<\\/?[^>]+(>|$)/g, \"\")) {\n\t\t\t\tlet size = getTextSize(view, text, css, width);\n\t\t\t\tif (size.height > height) height = size.height;\n\t\t\t}\n\t\t}\n\t});\n\tview._table.setRowHeight(row, height);\n}\n\nexport function highlightColRow(start, end, view){\n\tif(!view._table.config.header) return;\n\n\tconst grid = view._table;\n\n\tconst css = \"webix_highlight\";\n\n\tlet sr = start.row, er = end.row, sc = start.column, ec = end.column;\n\n\tconst columns = grid.config.columns;\n\tconst firstColumn = columns[1].id;\n\n\tif(sc == \"rowId\"){\n\t\tif(sc == ec){\n\t\t\tstart.column = sc = firstColumn;\n\t\t\tend.column = ec = columns[ columns.length-1 ].id;\n\t\t}\n\t\telse\n\t\t\tstart.column = sc = firstColumn;\n\t}\n\telse if(ec == \"rowId\")\n\t\tend.column = ec = firstColumn;\n\n\tif(er<sr) [sr, er] = [er, sr];\n\tif(ec<sc) [sc, ec] = [ec, sc];\n\n\tgrid.eachRow(function(row){\n\t\tif(row < sr || row > er)\n\t\t\tgrid.removeCellCss(row, \"rowId\", css, true);\n\t\telse\n\t\t\tgrid.addCellCss(row, \"rowId\", css, true);\n\t});\n\twebix.delay(() => grid.refresh());\n\n\tgrid.eachColumn(function(col){\n\t\tconst node = grid.getHeaderNode(col);\n\t\tif(col == \"rowId\" || !node) return;\n\n\t\tif(col < sc || col > ec)\n\t\t\twebix.html.removeCss(node, css);\n\t\telse\n\t\t\twebix.html.addCss(node, css, true);\n\t});\n}","import group from \"./undo_group\";\n\nexport const lockCss = \"webix_lock\";\n\nexport function init(view){\n\tview._locks = {};\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, mode) => {\n\t\tif (type === \"lock\") lockCell(view, row, column, !!mode, true);\n\t});\n\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"lock-cell\")\n\t\t\tlock(view);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(view, p.name, p.inc, p.data, p.start);\n\t});\n}\n\nfunction reset(view){\n\tview._locks = {};\n}\n\nexport function lockCell(view, row, column, mode, silent){\n\tvar table = view.$$(\"cells\");\n\tif (typeof row === \"object\" && typeof column === \"object\"){\n\t\tgroup.set(function() {\n\t\t\t_mapCellsCalls(row, column, function(row, column){\n\t\t\t\tlockCell(view, row, column, mode, true);\n\t\t\t});\n\t\t});\n\t} else {\n\t\tmode = ((mode === false) ? false : true);\n\t\tvar objrow = view._locks[row] = view._locks[row] || {};\n\t\tobjrow[column] = mode;\n\t\tif (mode)\n\t\t\ttable.addCellCss(row, column, lockCss, true);\n\t\telse\n\t\t\ttable.removeCellCss(row, column, lockCss, true);\n\n\t\tview.callEvent(\"onAction\", [\"lock\", { row, column, value: !mode, newValue: mode }]);\n\t}\n\n\tif (!silent)\n\t\ttable.refresh();\n}\n\nfunction _mapCellsCalls(start, end, handler,master){\n\tfor (let x = start.row; x<=end.row; x++)\n\t\tfor (let y = start.column; y<=end.column; y++)\n\t\t\thandler.call(master||this, x, y);\n}\n\nexport function isCellLocked(view, row, column){\n\treturn view._locks[row]?view._locks[row][column]:false;\n}\n\nexport function serialize(view,data){\n\tvar row, column,\n\t\tlocked = [];\n\tfor(row in view._locks){\n\t\tfor(column in view._locks[row])\n\t\t\tif(view._locks[row][column])\n\t\t\t\tlocked.push([row,column]);\n\t}\n\tdata.locked = locked;\n}\n\nexport function load(view,data){\n\tvar i,\n\t\tlocked = data.locked;\n\n\tif(locked)\n\t\tfor(i = 0; i < locked.length; i++)\n\t\t\tlockCell(view, locked[i][0],locked[i][1],true, true);\n}\n\nfunction lock(view){\n\tvar block = view.$$(\"cells\").getSelectArea();\n\tif (block){\n\t\tvar mode = view.isCellLocked(block.start.row, block.start.column);\n\t\tview.lockCell(block.start, block.end, !mode);\n\t}\n}\n\nfunction updatePosition(view, name, inc, data, start){\n\tlet locked = data.locked,\n\t\ti = locked.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = locked[i];\n\t\t\tif(row && name == \"row\" && row>= start.row || column && name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete lock mark if row was deleted\n\t\t\t\t\t\tlocked.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tlocked[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tlocked.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tlocked[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}","import {lockCss} from \"./lock_cell\";\nimport {save} from \"./save\";\n\nexport function init(view){\n\tview.attachEvent(\"onStyleChange\", (row, column, style) => {\n\t\tvar span = getSpan(view, row, column);\n\t\tif (span){\n\t\t\tvar extraCss = getExtraCss(view, row, column);\n\t\t\tspan[3] = (style ? style.id : \"\") + (extraCss ? (\" \" + extraCss) : \"\");\n\t\t}\n\t});\n\n\tview.attachEvent(\"onDataParse\", (data) => {\n\t\tparse(view, data);\n\t});\n\n\tview.attachEvent(\"onDataSerialize\", (data) => {\n\t\tserialize(view, data);\n\t});\n\t\n\tview.attachEvent(\"onUndo\", (type, row, column, value, isUndo) => {\n\t\tif(type == \"span\" || type == \"split\"){\n\t\t\tif (type == \"span\") \n\t\t\t\tisUndo = !isUndo;\n\t\t\tundoSpan(view, row, column, value, isUndo);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAction\", (name, options) => {\n\t\tif(name == \"lock\")\n\t\t\tsetSpanCss(view, options.row, options.column, lockCss, options.newValue);\n\t\telse if(name == \"before-grid-change\")\n\t\t\tupdatePosition(view, options.name, options.inc, options.data, options.start);\n\t\telse if(name == \"check-borders\")\n\t\t\treturn checkSpanBorders(view, options.row, options.column, options.area, options.mode);\n\t});\n}\n\nfunction getSpan(view, row, column){\n\tvar item = view.$$(\"cells\").getSpan()[row];\n\tif (item)\n\t\treturn item[column];\n}\n\nfunction parse(view, data){\n\tif (data.spans)\n\t\tfor (var i = 0; i < data.spans.length; i++) {\n\t\t\tvar span = data.spans[i];\n\t\t\taddSpan( view,\n\t\t\t\t{ row: span[0], column: span[1] },\n\t\t\t\tspan[2]*1,\n\t\t\t\tspan[3]*1,\n\t\t\t\ttrue \n\t\t\t);\n\t\t}\n}\n\nfunction serialize(view, data){\n\tvar spans = [];\n\tvar pull = view.$$(\"cells\").getSpan();\n\tif (pull){\n\t\tfor (var rid in pull){\n\t\t\tvar row = pull[rid];\n\t\t\tfor (var cid in row){\n\t\t\t\tvar span = row[cid];\n\t\t\t\tspans.push([rid*1, cid*1, span[0], span[1]]);\n\t\t\t}\n\t\t}\n\n\t\tdata.spans = spans;\n\t}\n}\n\nexport function addSpan(view, cell, x, y, silent){\n\tif (x<2 && y<2) return;\n\n\tif(silent || view.callEvent(\"onBeforeSpan\", [cell.row, cell.column, [x, y]])){\n\t\tconst obj = view._mPage.getCell(cell.row-1, cell.column-1);\n\t\tlet css = ( obj && obj.style ) || \"\";\n\t\tvar extraCss = getExtraCss(view, cell.row, cell.column);\n\t\tif (extraCss)\n\t\t\tcss += \" \" + extraCss;\n\n\t\tsetSpanValue(view, cell, x, y);\n\t\tview.$$(\"cells\").addSpan(cell.row, cell.column, x, y, null, css);\n\t\tif (!silent){\n\t\t\tview.callEvent(\"onAfterSpan\", [cell.row, cell.column, [x, y]]);\n\t\t\tsave(view, \"spans\", {\n\t\t\t\trow:cell.row, column: cell.column,\n\t\t\t\tx:x, y:y\n\t\t\t});\n\t\t}\n\t}\n}\n\nexport function removeSpan(view, cell){\n\tvar span = view.$$(\"cells\").getSpan(cell.row, cell.column);\n\tif(span && view.callEvent(\"onBeforeSplit\", [ cell.row, cell.column, [span[2], span[3]] ])){\n\t\tview.$$(\"cells\").removeSpan(cell.row, cell.column);\n\t\tview.callEvent(\"onAfterSplit\", [ cell.row, cell.column, [span[2], span[3]] ]);\n\t\tsave(view, \"spans\", {\n\t\t\trow:cell.row, column: cell.column,\n\t\t\tx:0, y:0\n\t\t});\n\t}\n}\n\nexport function getRange(sel){\n\tvar lx, ly, rx, ry;\n\trx = ry = 0;\n\tlx = ly = Infinity;\n\n\tfor (var i=0; i<sel.length; i++){\n\t\tvar cx = sel[i].column*1;\n\t\tvar cy = sel[i].row*1;\n\n\t\tlx = Math.min(cx, lx);\n\t\trx = Math.max(cx, rx);\n\t\tly = Math.min(cy, ly);\n\t\try = Math.max(cy, ry);\n\t}\n\n\treturn {\n\t\tcell:{ row:ly, column:lx },\n\t\tx: rx-lx+1,\n\t\ty: ry-ly+1\n\t};\n}\n\nexport function setSpanCss(view, row, column, css, add){\n\tconst span = getSpan(view, row, column);\n\tif (span){\n\t\tif (add){\n\t\t\tif (span[3].indexOf(css) == -1)\n\t\t\t\tspan[3] += \" \" + css;\n\t\t} else {\n\t\t\tspan[3] = span[3].replace(\" \" + css, \"\");\n\t\t}\n\t}\n}\n\nfunction getExtraCss(view, row, column){\n\tlet extraCss = [];\n\tif(view.getCellEditor(row, column))\n\t\textraCss.push(\"ss_editor\");\n\tif(view.getCellFilter(row, column))\n\t\textraCss.push(\"ss_filter\");\n\treturn extraCss.join(\" \");\n}\n\nfunction undoSpan(view,row, column,value,isUndo){\n\tif(isUndo){\n\t\tremoveSpan(view,{row: row, column: column});\n\t}\n\telse{\n\t\taddSpan(view, {row: row, column: column}, value[0], value[1]);\n\t}\n}\n\nfunction updatePosition(view, name, inc, data, start){\n\tlet spans = data.spans;\n\tif(inc){\n\t\tfor(let i = spans.length-1;i >=0;i--){\n\t\t\tlet [row,column] = spans[i];\n\n\t\t\tif(inc < 0){//deleting\n\t\t\t\tif(name == \"row\" && row <= start.row-inc-1)\n\t\t\t\t\tinc = start.row - spans[i][0];\n\t\t\t\telse if (name == \"column\" && column <= start.column-inc-1)\n\t\t\t\t\tinc = start.column - spans[i][1];\n\t\t\t}\n\n\t\t\tif(name == \"row\" && row>= start.row || name == \"column\" && column >= start.column){\n\t\t\t\tspans[i][0] =  name == \"row\"?row*1 + inc:row;\n\t\t\t\tspans[i][1] = name == \"column\"?column*1 + inc:column;\n\t\t\t}\n\t\t}\n\t}\n}\n\nvar borderChecks = {\n\t\"border-right\":\t\tfunction(row, column, span, area){\n\t\treturn area.end.column == column+span[0]-1;\n\t},\n\t\"border-bottom\":\tfunction(row, column, span, area){\n\t\treturn area.end.row == row+span[1]-1;\n\t}\n};\n\nfunction checkSpanBorders(view, row, column, area, mode){\n\tvar span = getSpan(view, row, column);\n\treturn span&&borderChecks[mode]?borderChecks[mode](row, column, span, area):false;\n}\n\n// clear merged cells except the first one\nfunction setSpanValue(view, cell, x, y){\n\tvar i,j,value,\n\t\trow = cell.row*1,\n\t\tcolumn = cell.column*1,\n\t\tisEmpty = !view.getCellValue(row,column);\n\tfor(i = row; i < row+y; i++){\n\t\tfor(j = column; j < column+x; j++) {\n\t\t\tvalue = view.getCellValue(i,j);\n\t\t\tif(value!==\"\" && (j != column || i != row)){\n\t\t\t\tif(isEmpty){\n\t\t\t\t\tisEmpty = false;\n\t\t\t\t\tview.setCellValue(row,column,value);\n\t\t\t\t}\n\t\t\t\tview.setCellValue(i,j,\"\");\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function adjustSpan (span, action, start, end, view, data, spanData){\n\tvar length = action.group == \"row\" ? span[3] : span[2];\n\tvar checkSpan = action.group == \"row\" ? [span[0]*1, span[0]*1+span[3]-1] : [span[1]*1, span[1]*1+span[2]-1];\n\tvar selection = action.group == \"row\" ? [start.row, end.row] : [start.column, end.column];\n\n\t//if we add, the number of selected rows/cols is added to span, so we need original selection length\n\tvar inc = selection[1] - selection[0] + 1;\n\n\tselection[0] = Math.max(selection[0], checkSpan[0]);\n\tselection[1] = Math.min(selection[1], checkSpan[1]);\n\n\tvar isFirstCell = selection[0] == checkSpan[0];\n\n\tif(selection[0] <= selection[1]){ //selection is in span\n\t\tif(action.id == \"del\") //if we delete, only rows/cols included into span\n\t\t\tinc = (selection[1] - selection[0]+ 1) * -1;\n\t\t//delete smth which starts as span and less than it's length\n\t\tif(action.id == \"del\" && isFirstCell && length > -1*inc){\n\t\t\tconst item = data.find(arr => arr[0] == span[0] && arr[1] == span[1]);\n\t\t\tif(item)\n\t\t\t\tspanData.push(item);\n\t\t}\n\n\t\tif(!(isFirstCell && action.id == \"add\")){\n\t\t\tspan[2] = action.group == \"column\" ? span[2]+inc : span[2];\n\t\t\tspan[3] = action.group == \"row\" ? span[3]+inc : span[3];\n\t\t}\n\t}\n\treturn span;\n}\n\nexport function pasteSpan(view, extra, row, col, cutted, translate){\n\t//existing span\n\tvar s = view._table.getSpan(row, col);\n\tif(extra && extra.span){\n\t\tvar span = extra.span;\n\t\t//if we are on start position for the future span\n\t\tif(row == span[0]*1+translate.row && col == span[1]*1+translate.column){\n\t\t\t//delete spans in future paste zone \n\t\t\tview._table.mapCells(row, col, span[3], span[2], (value, rid, cid) => {\n\t\t\t\ts = view._table.getSpan(rid,cid);\n\t\t\t\tif(s) removeSpan(view, {row:s[0], column:s[1]});\n\t\t\t}, true);\n\t\t\taddSpan(view, {row:row, column:col}, span[2], span[3]);\n\t\t\tif(cutted === 1)\n\t\t\t\tremoveSpan(view, {row:extra.row, column:extra.col});\n\t\t}\n\t}\n\telse if(s)\n\t\tremoveSpan(view, {row:s[0], column:s[1]});\n}","import {isDateInvalid} from \"../operations/formats\";\n\nfunction getText(text){\n\tvar locale = webix.i18n.spreadsheet.labels;\n\treturn locale[text] || text;\n}\nexport function getDefaultStyles(){\n\treturn [\n\t\t{name: getText(\"normal\"), css: \"webix_ssheet_condition_regular\"},\n\t\t{name: getText(\"neutral\"), css: \"webix_ssheet_condition_neutral\"},\n\t\t{name: getText(\"bad\"), css: \"webix_ssheet_condition_bad\"},\n\t\t{name: getText(\"good\"), css: \"webix_ssheet_condition_good\"}\n\t];\n}\n\nfunction isDate(value){\n\treturn value && !isNaN(value) && !isDateInvalid(value);\n}\n\nexport const conditions = {\n\tnumber:[\n\t\t{ id:\"greater\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a !== \"\" && (a*1 > b*1);\n\t\t}},\n\t\t{ id:\"less\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a !== \"\" && (a*1 < b*1);\n\t\t}},\n\t\t{ id:\"greaterOrEqual\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a !== \"\" && (a*1 >= b*1);\n\t\t}},\n\t\t{ id:\"lessOrEqual\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a !== \"\" && (a*1 <= b*1);\n\t\t}},\n\t\t{ id:\"equal\", batch:\"text\", handler:function(a,b){ return a == b; }},\n\t\t{ id:\"notEqual\", batch:\"text\", handler:function(a,b){ return a != b; }},\n\t\t{ id:\"contains\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toString().toLowerCase().indexOf(b.toString().toLowerCase()) !== -1;\n\t\t}},\n\t\t{ id:\"notContains\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toString().toLowerCase().indexOf(b.toString().toLowerCase()) === -1;\n\t\t}}\n\t],\n\ttext: [\n\t\t{ id:\"contains\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toString().toLowerCase().indexOf(b.toString().toLowerCase()) !== -1;\n\t\t}},\n\t\t{ id:\"notContains\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toString().toLowerCase().indexOf(b.toString().toLowerCase()) === -1;\n\t\t}},\n\t\t{ id:\"equal\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toString().toLowerCase() === b.toString().toLowerCase();\n\t\t}},\n\t\t{ id:\"notEqual\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toString().toLowerCase() !== b.toString().toLowerCase();\n\t\t}},\n\t\t{ id:\"beginsWith\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toString().toLowerCase().lastIndexOf(b.toString().toLowerCase(), 0) === 0;\n\t\t}},\n\t\t{ id:\"notBeginsWith\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toString().toLowerCase().lastIndexOf(b.toString().toLowerCase(), 0) !== 0;\n\t\t}},\n\t\t{ id:\"endsWith\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toString().toLowerCase().indexOf(b.toString().toLowerCase(), a.length - b.length) !== -1;\n\t\t}},\n\t\t{ id:\"notEndsWith\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toString().toLowerCase().indexOf(b.toString().toLowerCase(), a.length - b.length) === -1;\n\t\t}}\n\t],\n\tdate: [\n\t\t{ id:\"greater\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a > b;\n\t\t}},\n\t\t{ id:\"less\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a < b;\n\t\t}},\n\t\t{ id:\"greaterOrEqual\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a >= b;\n\t\t}},\n\t\t{ id:\"lessOrEqual\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a <= b;\n\t\t}},\n\t\t{ id:\"equal\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a == b;\n\t\t}},\n\t\t{ id:\"notEqual\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn !isDate(a) || a != b;\n\t\t}},\n\t\t{ id:\"between\", batch: \"daterangepicker\", handler: function(a, b){\n\t\t\tif (!isDate(a)) return false;\n\t\t\treturn (!b.start || a > b.start) && (!b.end || a < b.end);\n\t\t}},\n\t\t{ id:\"notBetween\", batch: \"daterangepicker\", handler: function(a, b){\n\t\t\tif (!isDate(a)) return false;\n\t\t\treturn (!b.start || a <= b.start) || (!b.end || a >= b.end);\n\t\t}}\n\t]\n};","import group from \"./undo_group\";\nimport {eachRange} from \"../helpers/column_names\";\nimport {setSpanCss} from \"./spans\";\nimport {conditions} from \"../helpers/conditional\";\nimport {getType} from \"./types\";\n\nexport function init(view){\n\tview.conditions = {\n\t\t_empty:true,\n\t\t_pull: {},\n\t\thandlers: createRules(),\n\t\tadd: function(rId, cId, cond, val, style){\n\t\t\tadd.apply(this, [view, rId, cId, cond, val, style]);\n\t\t},\n\t\tupdate: function(r, c, data){\n\t\t\tupdate.apply(this, [view, r, c, data]);\n\t\t},\n\t\tremove,\n\t\tget,\n\t\tparse,\n\t\tserialize,\n\t\tclear\n\t};\n\n\tview.attachEvent(\"onConditionSet\", (data) => _setCondition(view, data));\n\n\tview.attachEvent(\"onUndo\", (type_action, row, column, value) => {\n\t\tif(type_action == \"condition\")\n\t\t\t_undoCondition(view, row, column, value);\n\t});\n\n\tview.attachEvent(\"onDataSerialize\", (data) => _serialize(view, data));\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\n\tview.attachEvent(\"onReset\", () => view.conditions.clear() );\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(view, p.name, p.inc, p.data, p.start);\n\t});\n\n\treset(view);\n}\n\nfunction createRules(){\n\tconst rules = webix.copy(conditions);\n\trules.number = rules.number.concat([\n\t\t{ id:\"between\", handler: function(a, b){\n\t\t\treturn (!b.start || a > b.start) && (!b.end || a < b.end);\n\t\t}},\n\t\t{ id:\"notBetween\", handler: function(a, b){\n\t\t\treturn (!b.start || a <= b.start) || (!b.end || a >= b.end);\n\t\t}}\n\t]);\n\treturn rules;\n}\n\nfunction getCellValue(view, value){\n\tif(isNaN(value*1)){\n\t\tif (value.charAt(0) == \"=\" && value.length > 1){\n\t\t\tvalue = view._mData.getStore().exec(value.substring(1));\n\t\t\tif(value === null)\n\t\t\t\tvalue = \"\";\n\t\t}\n\t}\n\telse {\n\t\tvalue = value*1;\n\t}\n\treturn value;\n}\n\nfunction reset(view){\n\tview.conditions.clear();\n}\n\nfunction _setCondition(view, data){\n\tgroup.set(function(){\n\t\tview.eachSelectedCell((cell) => {\n\t\t\tconst collection = view.conditions.get(cell.row, cell.column);\n\t\t\tif(collection)\n\t\t\t\tfor (let i = 0; i < collection.length; i++)\n\t\t\t\t\tsetSpanCss(view, cell.row, cell.column, collection[i][2], false);\n\t\t\t_changeCondition(\"update\", cell.row, cell.column, (collection||null), data, view);\n\t\t});\n\t});\n\tview.refresh();\n}\n\nfunction _undoCondition(view, row, column, value){\n\tif(view.conditions.get(row, column))\n\t\tview.conditions.remove(row, column);\n\tif(value)\n\t\tview.conditions.update(row, column, value);\n}\n\nfunction _serialize(view, obj){\n\tobj.conditions = view.conditions.serialize();\n}\n\nfunction _parse(view, obj){\n\tview.conditions.parse(obj.conditions);\n}\n\nexport function getConditionCss(view, row, column, rendered){\n\tlet css = \"\";\n\n\tif (!view.conditions._empty){\n\t\tconst collection = view.conditions.get(row, column);\n\t\tif(collection){\n\t\t\tconst span = view.$$(\"cells\").getSpan(row, column);\n\t\t\tlet value = view.getCellValue(row,column,false);\n\t\t\tif(!value && value !== 0)\n\t\t\t\tvalue = \"\";\n\n\t\t\tlet type = getType(view, row, column);\n\t\t\tif(!type || type == \"string\")\n\t\t\t\ttype = \"text\";\n\n\t\t\tfor (let i = collection.length - 1; i >= 0; i--){\n\t\t\t\tlet currentValue = value;\n\t\t\t\tconst rule = collection[i][0];\n\t\t\t\tconst handlers = view.conditions.handlers;\n\t\t\t\tlet handler;\n\n\t\t\t\tlet checkOrder = [\"text\", type, \"number\", \"date\"];\n\t\t\t\tcheckOrder = checkOrder.filter((v, i) => checkOrder.indexOf(v) == i);\n\n\t\t\t\tfor(let k = 0; k < checkOrder.length; k++){\n\t\t\t\t\tconst checkType = checkOrder[k];\n\n\t\t\t\t\thandler = handlers[checkType].find(obj => obj.id == rule);\n\t\t\t\t\tif(handler){\n\t\t\t\t\t\thandler = handler.handler;\n\t\t\t\t\t\tif(checkType == \"text\" && rule != \"equal\" && rule != \"notEqual\")\n\t\t\t\t\t\t\tcurrentValue = rendered;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlet compare = collection[i][1];\n\t\t\t\tif(webix.isArray(compare))\n\t\t\t\t\tcompare = {\n\t\t\t\t\t\tstart: getCellValue(view, compare[0]),\n\t\t\t\t\t\tend: getCellValue(view, compare[1])\n\t\t\t\t\t};\n\t\t\t\telse\n\t\t\t\t\tcompare = getCellValue(view, compare);\n\n\t\t\t\tif(!css && handler && handler(currentValue, compare)){\n\t\t\t\t\tcss = collection[i][2];\n\t\t\t\t\tif(!span)\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tsetSpanCss(view, row, column, collection[i][2], true);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tsetSpanCss(view, row, column, collection[i][2], false);\n\t\t\t}\n\t\t}\n\t}\n\treturn css;\n}\n\n\nfunction addEmptyCollection(pull, row, column, state){\n\tstate._empty = false;\n\tif(!pull[row])\n\t\tpull[row] = {};\n\tif(!pull[row][column])\n\t\tpull[row][column] = [];\n\treturn pull[row][column];\n}\n\n\nfunction parse(data){\n\t//backward compatibility\n\tconst oldConditions = {\n\t\t\">\": \"greater\",\n\t\t\"<\": \"less\",\n\t\t\"=\": \"equal\",\n\t\t\"!=\": \"notEqual\",\n\t\t\"<>\": \"between\"\n\t};\n\n\tthis._empty = true;\n\tif (!data) return;\n\n\tlet i = data.length;\n\twhile(i--){\n\t\tconst c = data[i];\n\t\tconst collection = addEmptyCollection(this._pull,c[0],c[1],this);\n\t\tc[2] = oldConditions[ c[2] ] || c[2];\n\t\tcollection.push([c[2],c[3],c[4]]);\n\t}\n}\n\nfunction clear(){\n\tthis._pull = {};\n}\n\nfunction update(view, row, column, newData){\n\tvar collection = this.get(row, column);\n\tif(!collection)\n\t\taddEmptyCollection(this._pull, row, column, this);\n\n\tnewData.map(item => _normalizeValue(view, item) );\n\tthis._pull[row][column] = newData;\n}\n\nfunction get(rowId, columnId){\n\tif(!rowId)\n\t\treturn this._pull;\n\tif(!columnId)\n\t\treturn this._pull[rowId];\n\treturn this._pull[rowId]?this._pull[rowId][columnId]:null;\n}\n\nfunction add(view, rowId, columnId, condition, value, style){\n\tconst collection = addEmptyCollection(this._pull, rowId, columnId, this);\n\tcollection.push( _normalizeValue(view, [condition, value, style]) );\n}\n\nfunction remove(rowId, columnId){\n\tvar collection = this.get(rowId, columnId);\n\tif(collection)\n\t\tdelete this._pull[rowId][columnId];\n}\n\nfunction serialize(){\n\tvar column, condition, i, row,\n\t\tdata = [];\n\n\tfor( row in this._pull)\n\t\tfor( column in this._pull[row])\n\t\t\tfor(i=0; i < this._pull[row][column].length; i++){\n\t\t\t\tcondition = this._pull[row][column][i];\n\t\t\t\tdata.push([row,column, condition[0],condition[1],condition[2]]);\n\t\t\t}\n\n\treturn data;\n}\n\nfunction updatePosition(view, name, inc, data, start){\n\tlet conditions = data.conditions,\n\t\ti = conditions.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = conditions[i];\n\t\t\tif(name == \"row\" && row>= start.row || name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete lock mark if row was deleted\n\t\t\t\t\t\tconditions.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tconditions[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tconditions.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tconditions[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function clearConditionalFormats(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tvar condition = view.conditions.get(cell.row, cell.column);\n\t\t\tif(condition)\n\t\t\t\t_changeCondition(\"remove\", cell.row, cell.column, condition, null, view);\t\t\t\t\n\t\t});\n\t\tview.refresh();\n\t});\n}\n\nexport function pasteCondition(view, extra, row, col, cutted){\n\tvar condition = extra.condition;\n\tvar collection = view.conditions.get(row,col);\n\t_changeCondition(\"update\", row, col, (collection||null), condition, view);\n\tif(cutted === 1)\n\t\t_changeCondition(\"remove\", extra.row, extra.col, condition, null, view);\n}\n\nexport function _changeCondition(name, row, column, oldCondition, newCondition, view){\n\tif (view.callEvent(\"onBeforeConditionSet\", [row, column, oldCondition, newCondition])){\n\t\tview.conditions[name].apply(view.conditions, [row, column, newCondition]);\n\t\tview.callEvent(\"onAfterConditionSet\", [row, column, oldCondition, newCondition]);\n\t}\n}\n\nfunction _normalizeValue(view, condition){\n\tconst val = condition[1];\n\tif(val[0] == \"=\")\n\t\tcondition[1] = view._mData.getStore().parse(val).source; //fixes formula\n\treturn condition;\n}","import * as cop from \"./operations/column_operations\";\nimport {getConditionCss} from \"./operations/conditional_formats\";\nimport * as nms from \"./helpers/column_names\";\nimport * as fmt from \"./operations/formats\";\n\nexport function init(view, extra){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\tvar datatable = {\n\t\tview:\"datatable\", id:\"cells\", css:\"webix_ssheet_table webix_data_border wss_\"+view.$index,\n\t\theaderRowHeight: webix.skin.$name == \"contrast\" || webix.skin.$name == \"flat\" ? 24 : 20,\n\t\tspans: true,\n\t\tleftSplit: 1,\n\t\tareaselect:true,\n\t\tminColumnWidth:38,\n\t\teditable:true,\n\t\teditaction:(extra.liveEditor ? \"custom\" : \"dblclick\"),\n\t\tminRowHeight:1,\n\t\tnavigation:true\n\t};\n\n\tif (extra)\n\t\tdatatable = webix.extend(datatable, extra, true);\n\n\treturn datatable;\n}\n\nfunction ready(view){\n\tvar grid = view._table;\n\n\tvar showCommentHandler = webix.event(document.body, \"mousemove\", function(){\n\t\tvar thread;\n\t\treturn function(e) {\n\t\t\tclearTimeout(thread);\n\t\t\tthread = webix.delay(function(e){\n\t\t\t\tif(view.comments._activeComment.editStatus)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar cell = grid.locate(e);\n\t\t\t\tvar visible = view.comments.commentsView && view.comments.commentsView.isVisible();\n\n\t\t\t\tif(cell && view.comments.get(cell.row, cell.column)){\n\t\t\t\t\tvar activeCell = view.comments._activeComment.cell;\n\t\t\t\t\tif((activeCell && (activeCell.row != cell.row || activeCell.column != cell.column)) || !visible)\n\t\t\t\t\t\tview.callEvent(\"onCommand\",[{id: \"add-comment\", cell, viewonly: true }]);\n\t\t\t\t}\n\t\t\t\telse if(visible && !view.comments.commentsView.$view.contains(e.target))\n\t\t\t\t\tview.callEvent(\"onCommentHide\", []);\n\t\t\t}, true, [e], 250);\n\t\t};\n\t}());\n\n\t//in grid math\n\tif (view.config.math){\n\t\tgrid.config.editMath = true;\n\t}\n\n\t//saving value after edit\n\tgrid.attachEvent(\"onBeforeEditStop\", (st, ed) => {\n\t\t//ignore empty cells\n\t\tif (st.old === webix.undefined && st.value === \"\") return;\n\n\t\tif (st.value != st.old){\n\t\t\tview.setCellValue(ed.row, ed.column, st.value);\n\t\t\tgrid.refresh();\n\t\t}\n\t\tst.value = st.old;\n\t});\n\n\tgrid.attachEvent(\"onEnter\", function(ev){\n\t\tif (grid.getEditor()){\n\t\t\twebix.delay(function(){\n\t\t\t\tgrid.moveSelection(\"down\");\n\t\t\t});\n\t\t}\n\t\twebix.html.preventEvent(ev);\n\t});\n\n\t//prevent editing of locked cells\n\tview.attachEvent(\"onBeforeEditStart\", (row, column) => !view.isCellLocked(row, column));\n\tgrid.attachEvent(\"onAfterEditStart\", ({row, column}) => {\n\t\tlet v = view.getCellValue(row, column);\n\n\t\tif(grid.$anyKey){\n\t\t\tgrid.$anyKey = false;\n\t\t\tv = \"\";\n\t\t}\n\n\t\tgrid.getEditor().setValue(v);\n\t});\n\tgrid.attachEvent(\"onBeforeEditStart\", (editor) => \n\t\tview.callEvent(\"onBeforeEditStart\", [editor.row, editor.column]) );\n\n\t//column drag event checking\n\tlet dragStartColumn;\n\tlet dragEndColumn;\n\n\t//column and row selection\n\tgrid.attachEvent(\"onBeforeSelect\", (id) => id.column != \"rowId\" );\n\tgrid.attachEvent(\"onBeforeBlockSelect\", (start, end, finalStep) => {\n\t\tcop.highlightColRow(\n\t\t\tfinalStep ? start : webix.copy(start),\n\t\t\tfinalStep ? end : webix.copy(end),\n\t\t\tview\n\t\t);\n\t});\n\n\tfunction highlightHeaders(){\n\t\tlet ids = grid.getSelectedId(true);\n\t\tif(ids.length){\n\t\t\tlet start = ids[0];\n\t\t\tlet end = ids[ids.length-1]?ids[ids.length-1]:ids[0];\n\t\t\tcop.highlightColRow(start, end, view);\n\t\t}\n\t\telse {\n\t\t\tlet data = {row:0, column:0};\n\t\t\tcop.highlightColRow(data, data, view);\n\t\t}\n\t}\n\n\tgrid.attachEvent(\"onSelectChange\", () => highlightHeaders());\n\tgrid.attachEvent(\"onAfterColumnShow\", () => {\n\t\twebix.delay(() => highlightHeaders());\n\t});\n\tgrid.attachEvent(\"onColumnResize\", () => {\n\t\twebix.delay(() => highlightHeaders());\n\t});\n\n\twebix.event(grid.$view.firstChild, \"mousedown\", e => {\n\t\tconst resizeColumn = grid.config.resizeColumn;\n\t\tconst col = grid.locate(e);\n\n\t\tif(col && col.cind){\n\t\t\tif(resizeColumn){\n\t\t\t\tconst dx = grid.getColumnConfig(col.column).width;\n\t\t\t\tconst pos = webix.html.posRelative(e);\n\t\t\t\tif(pos.x < resizeColumn.size || dx-pos.x < resizeColumn.size+1)\n\t\t\t\t\treturn;\n\t\t\t}\n\t\t\tdragStartColumn = col.cind;\n\t\t}\n\t});\n\n\twebix.event(grid.$view.firstChild, \"mousemove\", e => {\n\t\tif(dragStartColumn){\n\t\t\tconst col = grid.locate(e);\n\n\t\t\tif(col){\n\t\t\t\tdragEndColumn = col.cind;\n\t\t\t\tcop.highlightColRow(\n\t\t\t\t\t{column: grid.columnId(dragStartColumn)},\n\t\t\t\t\t{column: grid.columnId(dragEndColumn||1)},\n\t\t\t\t\tview\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t});\n\n\tconst selectColumnHandler = webix.event(document.body, \"mouseup\", () => {\n\t\tif(dragStartColumn){\n\t\t\tif(dragEndColumn != null){\n\t\t\t\tcop.selectColumn(\n\t\t\t\t\tgrid.columnId(dragStartColumn),\n\t\t\t\t\tview,\n\t\t\t\t\tgrid.columnId(dragEndColumn||1)\n\t\t\t\t);\n\t\t\t\tdragEndColumn = null;\n\t\t\t}\n\t\t\tdragStartColumn = null;\n\t\t}\n\t});\n\n\tgrid.attachEvent(\"onItemDblClick\", (id) => {\n\t\tif (id.column === \"rowId\")\n\t\t\tcop.adjustRow(id.row, view);\n\t});\n\n\tlet lastHeaderClick = 0;\n\tgrid.attachEvent(\"onHeaderClick\", (id, e) => {\n\t\tif(id.column == \"rowId\"){\n\t\t\tcop.selectAll(view);\n\t\t\treturn;\n\t\t}\n\t\tlet headerClick = new Date();\n\t\tlet dblClick = (headerClick - lastHeaderClick <= 300);\n\n\t\tif (dblClick) {\n\t\t\tcop.adjustColumn(id.column, view);\n\t\t} else {\n\t\t\tlastHeaderClick = headerClick;\n\t\t\tif (e.shiftKey) {\n\t\t\t\tcop.selectColumns(id.column, view);\n\t\t\t} else {\n\t\t\t\tcop.selectColumn(id.column, view);\n\t\t\t}\n\t\t}\n\t});\n\n\t//select rows by shift click\n\tvar lastClickedRow = null;\n\tgrid.attachEvent(\"onItemClick\", (cell, e) => {\n\t\tif (cell.column === \"rowId\") {\n\t\t\tif (!e.shiftKey)\n\t\t\t\tcop.selectRow(cell.row, view);\n\t\t\telse {\n\t\t\t\tif (!lastClickedRow)\n\t\t\t\t\tcop.selectRow(cell.row, view);\n\t\t\t\telse\n\t\t\t\t\tcop.selectRow(lastClickedRow, view, cell.row);\n\t\t\t}\n\t\t\tlastClickedRow = cell.row;\n\t\t}\n\t});\n\n\t//reset API\n\tview.attachEvent(\"onReset\", () => reset(view));\n\n\tview.attachEvent(\"onBeforeSheetShow\", () => grid.editStop());\n\n\tgrid.attachEvent(\"onBlur\", function(){\n\t\t//after focus moved out, check and if it is somewhere\n\t\t//on the spreadsheet controls them move focus back to datatable\n\t\twebix.delay(function(){\n\t\t\tvar target = document.activeElement;\n\n\t\t\tif (target && target.tagName == \"INPUT\") return;\n\n\t\t\tvar focus = webix.UIManager.getFocus();\n\t\t\tvar need_focus = focus &&\n\t\t\t\tfocus != grid &&\n\t\t\t\tfocus.getTopParentView &&\n\t\t\t\tfocus.getTopParentView() === view;\n\n\t\t\tif (need_focus)\n\t\t\t\twebix.UIManager.setFocus(grid);\n\n\t\t}, this, [], 100);\n\t});\n\n\tsetDefaultCss(view);\n\n\tview.attachEvent(\"onDestruct\", () => {\n\t\twebix.eventRemove(showCommentHandler);\n\t\twebix.eventRemove(selectColumnHandler);\n\t});\n}\n\nexport function cell_template(view, obj, common, _v, column, valueOnly){\n\tconst col = column.id;\n\tconst row = obj.id;\n\n\tif (!view._mPage) return \"\";\n\tconst cell = view._mPage.getCell(row-1, col-1);\n\n\tlet value = cell ? cell.value : \"\";\n\tconst format = cell ? cell.format : \"\";\n\n\tconst math = view.getCellValue(row, col);\n\tif(math != value){\n\t\tconst locale = webix.i18n.spreadsheet.table;\n\t\tif(value == \"#REF!\")\n\t\t\tvalue = locale[\"math-ref-error\"];\n\t\telse if(value == \"#ERROR\")\n\t\t\tvalue = locale[\"math-error\"];\n\t}\n\n\tlet css = \"\";\n\tconst text = (!value && value !== 0) || isNaN(value);\n\tconst invalidDate = fmt.checkFormat(format, \"date\") && fmt.isDateInvalid(value);\n\n\tlet extra = \"\";\n\tif (!valueOnly){\n\t\textra += view.comments.get(row, col) ? \"<div class='ssheet_commented_sign'></div>\" : \"\";\n\t\textra += view.getCellFilter(row, col) ? \"<div class='ssheet_filter_sign'></div>\" : \"\";\n\t}\n\n\t//text can be formatted only in case of string number format\n\tif(!invalidDate && (!text || fmt.checkFormat(format, \"string\"))){\n\t\tif (format){\n\t\t\tconst cell = { css:\"\" };\n\t\t\tconst helper = fmt.getFormat(format);\n\t\t\tif (helper){\n\t\t\t\tlet newValue = helper(value, cell);\n\n\t\t\t\tif(newValue != webix.i18n.spreadsheet.table[\"format-error\"]){\n\t\t\t\t\tif (cell.css)\n\t\t\t\t\t\tcss = `class=\"${cell.css}\"`;\n\t\t\t\t\tvalue = newValue;\n\t\t\t\t}\n\t\t\t\telse if(!text)\n\t\t\t\t\tvalue = value * 1;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\tvalue = value * 1;\n\t}\n\n\t//print only cell values (td with position:relative ignores borders while printing)\n\tif(view._print && !(value || value === 0))\n\t\treturn \"\";\n\n\tif(webix.isUndefined(value) || value === null)\n\t\tvalue = \"\";\n\n\treturn `<div ${css}>${value}</div>${view._print ? \"\" : extra}`;\n}\n\nexport function reset(view){\n\tconst grid = view.$$(\"cells\");\n\tgrid.clearAll();\n\n\tconst columns = view.config.columnCount;\n\tconst rows = view.config.rowCount;\n\n\tconst cols = [{\n\t\tid:\"rowId\", header:\"\", width:40,\n\t\tcss:\"sheet_column_0\",\n\t\ttemplate:(el) => {\n\t\t\treturn el.id;\n\t\t}\n\t}];\n\n\tfor (let i=1; i<=columns; i++){\n\t\tcols.push({\n\t\t\tid:i,\n\t\t\teditor:\"text\",\n\t\t\theader:{\n\t\t\t\ttext: nms.encode[i]\n\t\t\t},\n\t\t\ttemplate:function(obj, common, value, column){\n\t\t\t\treturn cell_template(view, obj, common, value, column);\n\t\t\t},\n\t\t\tcssFormat:function(value, obj, row, column){\n\t\t\t\tconst rendered = getRenderedValue(view, row, column);\n\t\t\t\tconst cell = view._mPage.getCell(row-1, column-1);\n\t\t\t\tconst style = cell ? cell.style : \"\";\n\n\t\t\t\tconst conditional = getConditionCss(view, row, column, rendered);\n\n\t\t\t\treturn `${style} ${conditional}`;\n\t\t\t}\n\t\t});\n\t\tview.callEvent(\"onColumnInit\",[cols[i]]);\n\t}\n\tgrid.refreshColumns(cols);\n\n\tconst data = [];\n\tfor (let i=1; i<=rows; i++)\n\t\tdata.push({ id:i });\n\n\tgrid.parse(data);\n}\n\nexport function getRenderedValue(view, row, col){\n\tconst htmlFilter = /<[^>]*>/gi;\n\treturn cell_template(view, {id: row}, null, null, {id: col}, true).replace(htmlFilter, \"\");\n}\n\n// nowrap by default\nfunction setDefaultCss(view){\n\twebix.html.addStyle(\"#\"+view._table.$view.id+\".webix_dtable .webix_cell { white-space:nowrap;}\");\n}\n","import group from \"./operations/undo_group\";\nimport {selectAll} from \"./operations/column_operations\";\nimport {styleFormats} from \"./toolbar/buttons\";\n\nexport function init(view){\n\tconst grid = view.$$(\"cells\");\n\tconst key = webix.env.isMac ? \"command\" : \"ctrl\";\n\n\twebix.UIManager.addHotKey(key+\"-a\", () => { if(!grid.getEditor()) selectAll(view); }, grid);\n\n\tif(!view.config.readonly){\n\t\twebix.UIManager.addHotKey(\"any\", (view, ev) => {\n\t\t\tconst code = ev.which || ev.keyCode;\n\t\t\tconst f2 = code == 113;\n\n\t\t\t//ignore shift key, f1, f3 - f12 (f2 - edit)\n\t\t\tif (code == 16 || (code >= 112 && code <= 123 && !f2)) return;\n\n\t\t\tconst sel = view.getSelectedId(true);\n\t\t\tif (sel.length){\n\t\t\t\tif(!(view.config.liveEditor && f2))\n\t\t\t\t\tgrid.$anyKey = true;\n\t\t\t\tgrid.edit(sel[0]);\n\t\t\t}\n\t\t}, grid);\n\n\t\twebix.UIManager.addHotKey(\"enter\", (view) => {\n\t\t\tconst sel = view.getSelectedId(true);\n\t\t\tif (sel.length){\n\t\t\t\tif(!(view.config.liveEditor && !grid.callEvent(\"onBeforeLiveEditor\", [sel[0]])))\n\t\t\t\t\tgrid.edit(sel[0]);\n\t\t\t}\n\t\t}, grid);\n\n\t\twebix.UIManager.addHotKey(\"backspace\", () => del(view), grid);\n\t\twebix.UIManager.addHotKey(\"delete\", () => del(view), grid);\n\n\t\tvar redo = webix.env.isMac ? \"command-shift-z\" : \"ctrl-y\";\n\t\twebix.UIManager.addHotKey(redo, () => view.redo(), grid);\n\t\twebix.UIManager.addHotKey(key+\"-z\", () => view.undo(), grid);\n\n\t\twebix.UIManager.addHotKey(key+\"-b\", () => styleHotKey(view, \"font-weight\"), grid);\n\t\twebix.UIManager.addHotKey(key+\"-i\", () => styleHotKey(view, \"font-style\"), grid);\n\t\twebix.UIManager.addHotKey(key+\"-u\", (v, e) => ctrlU(view, e), grid);\n\t\twebix.UIManager.addHotKey(key+\"-p\", (v, e) => ctrlP(view, e), grid);\n\t}\n}\n\nfunction del(view) {\n\tif(!view.$$(\"cells\").getEditor())\n\t\tgroup.set(function(){\n\t\t\tview.eachSelectedCell((cell) => view.setCellValue(cell.row,cell.column, \"\"));\n\t\t\tview.refresh();\n\t\t});\n}\n\nfunction ctrlU(view, e) {\n\tstyleHotKey(view, \"text-decoration\");\n\treturn webix.html.preventEvent(e);\n}\nfunction ctrlP(view, e) {\n\tview.callEvent(\"onCommand\",[{id: \"print\"}]);\n\treturn webix.html.preventEvent(e);\n}\n\nfunction styleHotKey(view, attr) { \n\tvar cell = view.getSelectedId();\n\tif(cell){\n\t\tvar style = view.getStyle(cell.row, cell.column);\n\n\t\tvar elementOn = styleFormats[attr];\n\t\tvar elementOff = \"normal\";\n\n\t\tvar state = (style && style.props[attr] === elementOn)? elementOff : elementOn;\n\t\tview.callEvent(\"onStyleSet\", [attr, state]);\n\t}\n}","import {methods} from \"@xbs/muon\";\n\nlet methodsName = [];\nfor(let name in methods)\n\tmethodsName.push(name);\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\treturn {\n\t\tview:\"toolbar\",\n\t\tcss:\"webix_ssheet_toolbar\",\n\t\telements:[\n\t\t\t{\n\t\t\t\tview:\"label\",\n\t\t\t\tlabel:webix.i18n.spreadsheet.liveEditor[\"edit\"],\n\t\t\t\twidth:60\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"live-editor\",\n\t\t\t\tdisabled:true,\n\t\t\t\tid:\"liveEditor\",\n\t\t\t\tsuggestData: methodsName\n\t\t\t}\n\t\t]\n\t};\n}\n\nfunction ready(view){\n\tconst editor = view.$$(\"liveEditor\");\n\n\t//block native editor, and move focus to the custom input\n\t//edit by key press\n\tview._table.attachEvent(\"onBeforeEditStart\", function(cell){\n\t\tconst mode = view._table.$anyKey;\n\t\tview._table.$anyKey = false;\n\n\t\treturn startEdit(this, cell, mode);\n\t});\n\t//edit by enter key\n\tview._table.attachEvent(\"onBeforeLiveEditor\", function(cell){\n\t\treturn startEdit(this, cell, false);\n\t});\n\t//edit by dbl-click\n\tview._table.attachEvent(\"onItemDblClick\", function(cell){\n\t\tif(view.getCellEditor(cell.row, cell.column))\n\t\t\tthis.edit(cell);\n\t\telse\n\t\t\tstartEdit(this, cell, false);\n\t});\n\n\tview._table.attachEvent(\"onAfterScroll\", function(){\n\t\tif(editor.$view.contains(document.activeElement))\n\t\t\teditor.paintValue();\n\t});\n\n\tview.attachEvent(\"onCellChange\", (r,c,v) => {\n\t\tvar cell = editor.config.activeCell;\n\t\tif (cell && cell.row == r && cell.column == c)\n\t\t\teditor.setValue(v);\n\t});\n\n\tview.attachEvent(\"onAfterSelect\", (data) => {\n\t\tif (!view.$handleSelection){\n\t\t\tlet cell = data[0];\n\t\t\tfillEditor(cell);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onChange\", (mode) => {\n\t\tif (mode == \"update\" && editor.isEnabled()){\n\t\t\tconst cell = editor.config.activeCell;\n\t\t\tif(cell && editor.getValue() != view.getCellValue(cell.row, cell.column)){\n\t\t\t\tdelete editor._update_range;\n\t\t\t\teditor.showActiveSheet();\n\t\t\t\teditor.updateCellValue();\n\t\t\t}\n\t\t}\n\t});\n\n\tview.attachEvent(\"onBeforeSheetShow\", (name)=> {\n\t\tif(view._rangeDialog)\n\t\t\treturn;\n\t\tconst cell = editor.config.activeCell;\n\t\tif(cell){\n\t\t\tconst cursor = editor.getInputNode().selectionStart;\n\t\t\tconst val = editor.getValue();\n\t\t\tif(view.getCellValue(cell.row, cell.column) != val){\n\t\t\t\tif(!editor._activeMath)\n\t\t\t\t\teditor._activeMath = view.getActiveSheet();\n\t\t\t\twebix.delay(()=>{\n\t\t\t\t\tif(name == editor._activeMath){\n\t\t\t\t\t\tview.$handleSelection = null;\n\t\t\t\t\t\tconst cell = editor.config.activeCell;\n\t\t\t\t\t\tview._table.select(cell.row, cell.column);\n\t\t\t\t\t}\n\n\t\t\t\t\teditor.setValue(val);\n\t\t\t\t\t//update highlight\n\t\t\t\t\teditor.refresh();\n\n\t\t\t\t\teditor.getInputNode().setSelectionRange(cursor, cursor);\n\t\t\t\t\teditor.paintValue();\n\n\t\t\t\t\tview.$handleSelection = function(a,b,st,en){ return pasteRange(st, en, a); };\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t\tclearEditor();\n\t\t}\n\t});\n\n\tview.attachEvent(\"onReset\", () => {\n\t\tif(!view._rangeDialog)\n\t\t\tview.$handleSelection = null;\n\t});\n\tview.$$(\"cells\").attachEvent(\"onFocus\", ()=>{\n\t\t//ignore table clipboard logic\n\t\tif(editor._activeMath){\n\t\t\twebix.delay(()=>editor.focus());\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAfterLoad\", () => clearEditor());\n\n\tview.attachEvent(\"onAction\", function(name, options){\n\t\tconst cell = editor.config.activeCell;\n\t\tconst isActiveCell = cell && cell.row == options.row && cell.column == options.column;\n\t\tif(isActiveCell && (name == \"lock\" || name == \"dropdown\"))\n\t\t\tdisableEditor(options.row, options.column);\n\t});\n\n\tview.attachEvent(\"onFormatChange\", (r, c) => updateEditor(r, c));\n\tview.attachEvent(\"onCellChange\", (r, c) => updateEditor(r, c));\n\n\tfunction updateEditor(row, column){\n\t\tconst activeCell = editor.config.activeCell;\n\t\tif(activeCell && activeCell.row == row && activeCell.column == column)\n\t\t\tfillEditor({row, column});\n\t}\n\n\tfunction startEdit(table, cell, clear){\n\t\t//do not interfere with custom editors\n\t\tif (!view.getCellEditor(cell.row, cell.column) && fillEditor(cell, clear)){\n\t\t\teditor.focus();\n\n\t\t\tif(!clear){\n\t\t\t\teditor.paintValue();\n\n\t\t\t\tconst input = editor.getInputNode();\n\t\t\t\tconst symbols = input.value.length;\n\t\t\t\tinput.setSelectionRange(symbols, symbols);\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tfunction disableEditor(row,column){\n\t\tconst disabled = view.getCellEditor(row, column) || view.isCellLocked(row, column);\n\t\tif(disabled)\n\t\t\teditor.disable();\n\t\telse\n\t\t\teditor.enable();\n\t\treturn disabled;\n\t}\n\n\tfunction fillEditor(cell, clear){\n\t\tconst disabled = disableEditor(cell.row, cell.column);\n\t\teditor.config.activeCell = cell;\n\t\teditor.setValue( clear ? \"\" : editor.getCellValue(cell.row, cell.column) );\n\n\t\tif(!view._rangeDialog)\n\t\t\tview.$handleSelection = disabled ? null : function(a,b,st,en){ return pasteRange(st, en, a); };\n\n\t\treturn !disabled;\n\t}\n\n\tfunction pasteRange(st, en, cell){\n\t\tconst updateRange = editor._update_range;\n\t\tlet cursor = editor.getInputNode().selectionStart;\n\n\t\tlet sheet = \"\";\n\t\tif(editor._activeMath){\n\t\t\tconst activeSheet = view.getActiveSheet();\n\t\t\tif(editor._activeMath != activeSheet)\n\t\t\t\tsheet = editor.prepareSheet(activeSheet);\n\t\t}\n\n\t\tlet range;\n\t\tif(st == en){\n\t\t\tconst colon = editor.getValue()[ (updateRange ? updateRange.pos : cursor)-1 ] == \":\";\n\t\t\trange = colon ? st : sheet+st;\n\t\t}\n\t\telse\n\t\t\trange = `${sheet+st}:${en}`;\n\n\t\tif(updateRange && updateRange.pos == cursor - updateRange.len){\n\t\t\teditor.setRange(range, true);\n\t\t\tcursor = editor._update_range.pos + range.length;\n\t\t}\n\t\telse if(editor.expectOperator()){\n\t\t\teditor.setRange(range);\n\t\t\tcursor += range.length;\n\t\t}\n\t\telse\n\t\t\treturn endEdit(cell);\n\n\t\teditor.focus();\n\t\teditor.getInputNode().setSelectionRange(cursor, cursor);\n\t\teditor.paintValue();\n\n\t\treturn false;\n\t}\n\n\tfunction endEdit(st){\n\t\tif (editor.isEnabled()){\n\t\t\tconst cell = editor.config.activeCell;\n\t\t\teditor.showActiveSheet();\n\t\t\teditor.updateCellValue(cell);\n\t\t\teditor.setValue(st ? view.getCellValue(st.row, st.column) : \"\");\n\t\t}\n\t\treturn true;\n\t}\n\n\tfunction clearEditor(){\n\t\teditor.define({activeCell:null});\n\t\teditor.setValue(\"\");\n\t\teditor.disable();\n\t}\n}\n","export function find(arr, func){\n\tvar result = findIndex(arr, func);\n\treturn arr[result];\n}\n\nexport function findIndex(arr, func){\n\tvar result = -1;\n\tfor(var i =0; result<0 && i < arr.length; i++){\n\t\tif(func(arr[i]))\n\t\t\tresult = i;\n\t}\n\treturn result;\n}\n\nexport function getDimension(data, spans, rows, cols){\n\tfor(let i=0; i<data.length; i++){\n\t\t// data[i] - [ row, column, value, style]\n\t\tlet line = data[i];\n\t\tif (line[0]>rows) rows=line[0];\n\t\tif (line[1]>cols) cols=line[1];\n\t}\n\n\tif(spans)\n\t\tfor(let i = 0; i < spans.length; i++){\n\t\t\t// spans[i] - [ row, column, colCount, rowCount ]\n\t\t\tconst spanEndRow = spans[i][0] + spans[i][3] - 1;\n\t\t\tconst spanEndCol = spans[i][1] + spans[i][2] - 1;\n\n\t\t\tif(spanEndRow > rows) rows = spanEndRow;\n\t\t\tif(spanEndCol > cols) cols = spanEndCol;\n\t\t}\n\n\treturn [rows*1, cols*1];\n}","export function init(view){\n\t//parsing initial data\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data, config) => _serialize(view, data, config));\n\n\t// undo\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif(type == \"value\")\n\t\t\t_undoValue(view, row, column, value);\n\t});\n}\n\nfunction _serialize(view, obj, config){\n\tvar math = !config || config.math!==false;\n\n\tvar grid = view.$$(\"cells\");\n\tvar state = grid.getState();\n\tvar columns = state.ids.concat(state.hidden);\n\n\t// remove \"rowId\" column\n\tcolumns.splice(columns.indexOf(\"rowId\"), 1);\n\n\tobj.data = getSheetData(view, math);\n\n\tobj.table = {\n\t\tfrozenColumns : (view._frozenColumns || 0),\n\t\tfrozenRows : (view._frozenRows || 0)\n\t};\n}\n\nfunction _parse(view, obj){\n\tconst grid = view.$$(\"cells\");\n\n\tconst tconfig = obj.table || { frozenColumns : 0, frozenRows : 0 };\n\tview._frozenColumns = view._frozenRows = 0;\n\tif (tconfig){\n\t\tif (!webix.isUndefined(tconfig.frozenColumns))\n\t\t\tview.freezeColumns(tconfig.frozenColumns);\n\t\tif (!webix.isUndefined(tconfig.frozenRows))\n\t\t\tview.freezeRows(tconfig.frozenRows);\n\t}\n\n\tif(obj.sizes)\n\t\tgrid.define(\"fixedRowHeight\", false);\n\n\tfor (let i = 0; i < obj.data.length; i++){\n\t\tconst [ row, column, value, , type ] = obj.data[i];\n\n\t\tview.ignoreUndo(()=>{\n\t\t\t//cell format can be updated via types module\n\t\t\tview.callEvent(\"onCellChange\", [row, column, value, type]);\n\t\t});\n\t}\n}\n\nfunction _undoValue(view, row, column, value){\n\tview.setCellValue(row, column, value);\n}\n\nexport function getSheetData(view, math, page){\n\tpage = page ? view._mData.getPage(page) : view._mPage;\n\treturn page.serialize(math)\n\t\t.map(arr =>{\n\t\t\treturn [ ++arr[0], ++arr[1], arr[2].value, arr[2].style||\"\", arr[2].type];\n\t\t})\n\t\t.filter(arr => {\n\t\t\treturn arr[2] || arr[2] === 0 || arr[3];\n\t\t});\n}","import * as arr from \"./helpers/array\";\nimport {getSheetData} from \"./operations/data\";\nimport {DataStore} from \"@xbs/muon\";\nimport {loadCell} from \"./operations/types\";\nimport {removeUnusedStyles} from \"./operations/styles\";\n\nconst options = [\n\t\"rename-sheet\",\n\t\"remove-sheet\"\n];\n\nconst actionMap = {\n\t\"remove-sheet\": function(view){\n\t\tview.confirm({\n\t\t\ttext: webix.i18n.spreadsheet.labels[\"sheet-remove-confirm\"]\n\t\t}).then(()=>{\n\t\t\tremove(view, view._activeSheet);\n\t\t});\n\t},\n\t\"rename-sheet\": function(view){\n\t\tedit(view, view._activeSheet);\n\t},\n\t\"new-sheet\": function(view){\n\t\tadd(view);\n\t},\n\t\"copy-sheet\": function(view){\n\t\tcopy(view);\n\t}\n};\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n}\n\nexport function defaultBottom(view){\n\tvar readonly = view.config.readonly;\n\tvar tabWidth = view.config.sheetTabWidth;\n\tvar toolbar =  {\n\t\tview: \"toolbar\",\n\t\tid: \"bottom-toolbar\",\n\t\tcss: \"webix_ssheet_bottom_toolbar webix_layout_toolbar\",\n\t\tpaddingY: 0,\n\t\theight: 34,\n\t\telements:[\n\t\t\t{\n\t\t\t\tview: \"button\", type:\"htmlbutton\", width: 34, id: \"add-sheet\",\n\t\t\t\tlabel: \"<span class='webix_ssheet_icon_add_sheet'></span>\",\n\t\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[\"add-sheet\"]||\"\", hidden:readonly\n\t\t\t},\n\t\t\t{\n\t\t\t\tid:\"sheets\",\n\t\t\t\tview:\"sheets\",\n\t\t\t\twidth: 5 * tabWidth,\n\t\t\t\teditable:!readonly,\n\t\t\t\teditaction: \"dblclick\",\n\t\t\t\teditor:\"text\",\n\t\t\t\teditValue:\"value\",\n\t\t\t\ttype:{\n\t\t\t\t\twidth: tabWidth,\n\t\t\t\t\theight: 32,\n\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\treturn \"<div>\"+obj.value+\"</div>\"+\n\t\t\t\t\t\t\t(!readonly?\"<div class='webix_input_icon wxi-menu-down webix_ssheet_sheet_arrow'></div>\":\"\");\n\t\t\t\t\t},\n\t\t\t\t\t//remove skin selection css on dnd\n\t\t\t\t\tcss:\"ssheet_order_sheets\"\n\t\t\t\t},\n\t\t\t\tonClick:{\n\t\t\t\t\twebix_ssheet_sheet_arrow: function(e, id){\n\t\t\t\t\t\tinitSheetMenu(view, e, id);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ton:{\n\t\t\t\t\tonItemClick: function(id){\n\t\t\t\t\t\tif(id != view._activeSheet)\n\t\t\t\t\t\t\tview.showSheet(id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"button\", type:\"htmlbutton\", width: 34, id: \"prev-sheet\", disabled:true, hidden:true,\n\t\t\t\tlabel: \"<span class='webix_icon wxi-menu-left'></span>\", batch:\"pager\",\n\t\t\t\tclick:function(){scrollSheets(view, -1);}\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"button\", type:\"htmlbutton\", width: 34, id: \"next-sheet\", hidden:true,\n\t\t\t\tlabel: \"<span class='webix_icon wxi-menu-right'></span>\", batch:\"pager\",\n\t\t\t\tclick:function(){scrollSheets(view, 1);}\n\t\t\t}\n\t\t]\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"bottom-toolbar\", toolbar]);\n\n\treturn toolbar;\n}\n\nfunction scrollSheets(view, direction){\n\tvar sheets = view.$$(\"sheets\");\n\tsheets.scrollTo(sheets.getScrollState().x+(direction*view.config.sheetTabWidth), 0);\n}\n\nfunction menuInit(view){\n\tvar data = [];\n\tfor(var i=0; i < options.length;i++)\n\t\tdata.push({id: options[i], value:webix.i18n.spreadsheet.menus[options[i]]||options[i]});\n\n\tvar menu =  {\n\t\tview: \"ssheet-suggest\",\n\t\tdata: data\n\t};\n\tview.callEvent(\"onViewInit\", [\"sheet-menu\", menu]);\n\treturn menu;\n}\n\nexport function reset(view, obj){\n\tconst tabs = view.$$(\"sheets\");\n\tif (tabs){\n\t\ttabs.clearAll();\n\t\tconst set = [];\n\t\tobj.sheets.forEach(function(sheet){\n\t\t\tset.push({id:sheet.name, value: sheet.name});\n\t\t});\n\t\ttabs.parse(set);\n\t}\n}\n\nfunction ready(view){\n\tprepare(view);\n\n\tif(view.$$(\"add-sheet\"))\n\t\tview.$$(\"add-sheet\").attachEvent(\"onItemClick\", function(){\n\t\t\tadd(view);\n\t\t});\n\n\tview.attachEvent(\"onAfterSheetShow\", (name) => selectSheet(view,name));\n\n\tview.attachEvent(\"onCommand\", function(command){\n\t\tif(actionMap[command.id])\n\t\t\tactionMap[command.id](this);\n\t});\n\n\tif(view.$$(\"sheets\")){\n\t\tview.$$(\"sheets\").data.attachEvent(\"onStoreUpdated\", () => changePagerVisability(view));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterScroll\", () => changePagerStatus(view));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterDrop\", (context) => dataOrder(view,context.start,context.index));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterEditStop\", (state) => rename(view,state.old,state.value));\n\t}\n}\n\nfunction initSheetMenu(view, e, id){\n\tif(!view.$sheetMenu){\n\t\tview.$sheetMenu = webix.ui(menuInit(view));\n\t\tview._destroy_with_me.push(view.$sheetMenu);\n\t\tview.$sheetMenu.attachEvent(\"onItemClick\", (id)=> callAction(view,id));\n\t}\n\n\tif(view.$sheetMenu.getItem(\"remove-sheet\"))\n\t\tif(view.$$(\"sheets\").count() == 1)\n\t\t\tview.$sheetMenu.disableItem(\"remove-sheet\");\n\t\telse\n\t\t\tview.$sheetMenu.enableItem(\"remove-sheet\");\n\tif(view.callEvent(\"onBeforeSheetMenu\", [id])){\n\t\tview.$sheetMenu.show(e);\n\t}\n}\n\nfunction changePagerStatus(view){\n\tconst sheets = view.$$(\"sheets\");\n\tconst scrollPos = sheets.getScrollState().x;\n\n\tif(scrollPos == 0){\n\t\tview.$$(\"prev-sheet\").disable();\n\t}\n\telse{\n\t\tview.$$(\"prev-sheet\").enable();\n\t\tvar tabWidth = view.config.sheetTabWidth;\n\t\tif(scrollPos == (sheets.count()-(sheets.config.width/tabWidth))*tabWidth){\n\t\t\tview.$$(\"next-sheet\").disable();\n\t\t\treturn;\n\t\t}\n\t}\n\tview.$$(\"next-sheet\").enable();\n}\n\nfunction changePagerVisability(view){\n\tvar toolbar = view.$$(\"bottom-toolbar\");\n\tvar sheets = view.$$(\"sheets\");\n\n\tif(sheets.count() <= (sheets.config.width/view.config.sheetTabWidth))\n\t\ttoolbar.showBatch(\"pager\", false);\n\telse\n\t\ttoolbar.showBatch(\"pager\");\n}\n\nfunction dataOrder(view, name, num){\n\tfor (let id in view._sheets) {\n\t\tif (view._sheets[id].name == name) {\n\t\t\tconst item = view._sheets.splice(id, 1);\n\t\t\tview._sheets.splice(num, 0, item[0]);\n\t\t\tbreak;\n\t\t}\n\t}\n}\n\nexport function add(view, content){\n\tvar index, name, newIndex;\n\n\tindex = arr.findIndex(view._sheets, x => x.name == view._activeSheet);\n\tnewIndex = index>-1?index+1:view._sheets.length;\n\tname = getNewTitle(view);\n\tcontent = content || {data:[]};\n\tview._sheets.splice(newIndex, 0, {\n\t\tname: name,\n\t\tcontent: content\n\t});\n\tview.$$(\"sheets\").add({id: name, value: name},newIndex);\n\tview._mData.addPage(name);\n\n\tparseToStore(view, name, content);\n\n\tview.showSheet(name);\n\tview.callEvent(\"onSheetAdd\", [name]);\n\treturn name;\n}\n\nfunction getNewTitle(view){\n\tvar index = view._sheets.length+1;\n\twhile(getSheet(view, (webix.i18n.spreadsheet.labels.sheet+index)))\n\t\tindex++;\n\tvar name = webix.i18n.spreadsheet.labels.sheet+index;\n\treturn name;\n}\n\nfunction selectSheet(view,name){\n\tif(view.$$(\"sheets\")){\n\t\tview.$$(\"sheets\").select(name);\n\t\tview.$$(\"sheets\").showItem(name);\n\t}\n}\n\nexport function edit(view,name){\n\tview.$$(\"sheets\").edit(name);\n}\n\nexport function remove(view,name){\n\tvar index, newSheet;\n\tif(view._sheets.length >1){\n\t\tindex = arr.findIndex(view._sheets,x => x.name == name);\n\t\tview._sheets.splice(index,1);\n\t\tview._mData.removePage(name);\n\t\tif(!view._sheets[index])\n\t\t\tindex = 0;\n\t\tnewSheet = \tview._sheets[index];\n\t\tview._activeSheet = null;\n\t\tif(view.$$(\"sheets\")){\n\t\t\tview.$$(\"sheets\").remove(name);\n\t\t\tview.$$(\"sheets\").refresh();\n\t\t}\n\t\tview.showSheet(newSheet.name);\n\t\tview.callEvent(\"onSheetRemove\", [name]);\n\t}\n}\n\nexport function rename(view,name,newName){\n\tif (name == newName) return;\n\n\t//correct sheet name\n\tvar i = 1;\n\twhile (!newName || getSheet(view, newName)){\n\t\tnewName = webix.i18n.spreadsheet.labels.sheet + i;\n\t\ti++;\n\t}\n\tnewName = newName.replace(/[*?:[\\]\\\\/]/g,\"\").substring(0, 31);\n\n\tvar sheet = getSheet(view, name);\n\tvar sheets = view.$$(\"sheets\");\n\n\tsheet.name = newName;\n\tif(view._activeSheet == name)\n\t\tview._activeSheet = newName;\n\n\tif(sheets){\n\t\tlet item = sheets.getItem(name);\n\t\titem.value = newName;\n\t\tsheets.data.changeId(name,newName);\n\t\tsheets.refresh(newName);\n\t}\n\n\tview._mData.renamePage(name, newName);\n\tview.callEvent(\"onSheetRename\", [name, newName]);\n}\n\nexport function serialize(view, obj, config){\n\tgetSheet(view, view._activeSheet).content = obj;\n\n\tconst sheets = webix.copy(view._sheets);\n\n\tconst math = !config || config.math!==false;\n\tconst compactStyles = config && config.compactStyles;\n\n\tsheets.forEach(sheet => {\n\t\tif(sheet.name != view._activeSheet){\n\t\t\tsheet.content.data = getSheetData(view, math, sheet.name);\n\t\t\tif(compactStyles)\n\t\t\t\tsheet.content.styles = removeUnusedStyles(sheet.content);\n\t\t\tsheet.content.ranges = view.ranges.serialize(sheet.name);\n\t\t}\n\t});\n\n\treturn sheets;\n}\n\nfunction parseToStore(view, name, obj){\n\tview.ranges.parse(obj.ranges, name);\n\n\tconst page = view._mData.getPage(name);\n\tconst data = webix.copy(obj.data).map((arr, index) => {\n\t\tconst cell = loadCell(view, obj, arr);\n\n\t\tconst linkRegex = /^=link\\(/i;\n\n\t\tif(typeof cell.value == \"string\" && linkRegex.test(cell.value)){\n\t\t\t// LINK is deprecated\n\t\t\tcell.value = cell.value.replace(linkRegex, \"=HYPERLINK(\");\n\t\t}\n\n\t\tconst item = obj.data[index];\n\n\t\t//cell value and type can be changed via types module\n\t\titem[2] = cell.value;\n\t\titem[3] = item[3] || \"\";\n\t\titem[4] = cell.type;\n\n\t\treturn [ --arr[0], --arr[1], {\n\t\t\tvalue: cell.value,\n\t\t\ttype: cell.type,\n\t\t\tstyle: item[3],\n\t\t\t$format: cell.$format\n\t\t}];\n\t});\n\n\tpage.parse(data, true);\n}\n\nexport function load(view, obj){\n\tview._loading_data = true;\n\tobj = webix.isArray(obj)?{sheets:obj}:obj;\n\n\tif(!obj.sheets && view._activeSheet){\n\t\t//loading into active sheet\n\t\tconst name = view._activeSheet;\n\t\tgetSheet(view, name).content = obj;\n\t\tparseToStore(view, name, obj);\n\t\trefresh(view, obj);\n\t} else {\n\t\t//creating new set of sheets\n\t\tprepare(view, obj);\n\t}\n\tview._loading_data = false;\n}\n\nexport function prepare(view, obj){\n\tif(!obj) obj = {data:[]}; \n\tif(!obj.sheets){\n\t\tobj = newSheet(obj);\n\t}\n\n\tlet name;\n\tview._activeSheet = \"\";\n\tview._sheets = obj.sheets;\n\tview._mData = new DataStore();\n\n\t// first add all pages then parse data in them\n\tobj.sheets.forEach(sheet => {\n\t\tview._mData.addPage(sheet.name);\n\t});\n\n\tobj.sheets.forEach((sheet, index) => {\n\t\tconst page = view._mData.getPage(sheet.name);\n\t\tconst content = sheet.content;\n\t\tconst sheetName = sheet.name;\n\n\t\tparseToStore(view, sheetName, content);\n\n\t\tif(index == 0){\n\t\t\tname = sheetName;\n\t\t\tview._mPage = page;\n\t\t}\n\t});\n\n\treset(view, obj);\n\tshow(view, name);\n}\n\nexport function newSheet(obj){\n\treturn {\n\t\tsheets:[{\n\t\t\tname: webix.i18n.spreadsheet.labels.sheet + 1,\n\t\t\tcontent: obj\n\t\t}]\n\t};\n}\n\nexport function show(view,name){\n\tif (name == view._activeSheet) return;\n\n\tif(view.callEvent(\"onBeforeSheetShow\", [name])){\n\t\tif (view._activeSheet)\n\t\t\tgetSheet(view, view._activeSheet).content = view.serialize();\n\n\t\tview._activeSheet = name;\n\t\tconst obj = getSheet(view, name).content;\n\n\t\tview._mPage = view._mData.getPage(name);\n\n\t\trefresh(view, obj);\n\n\t\tview.callEvent(\"onAfterSheetShow\", [name]);\n\t}\n}\n\nexport function getSheet(view, name){\n\treturn arr.find(view._sheets, x => x.name == name);\n}\n\nexport function eachSheet(view, callback){\n\tfor (var i=0; i<view._sheets.length; i++)\n\t\tcallback(view._sheets[i].name);\n}\n\nexport function getActive(view){\n\treturn view._activeSheet;\n}\n\nfunction refresh(view, obj){\n\tconst data = getSheetData(view);\n\n\tlet [rows, cols] = arr.getDimension(data, obj.spans, view.config.rowCount, view.config.columnCount);\n\tview.callEvent(\"onReset\", []);\n\tif (rows != view.config.rowCount || cols != view.config.columnCount){\n\t\tview.config.rowCount = rows;\n\t\tview.config.columnCount = cols;\n\t\tview._resetTable();\n\t}\n\n\tview._loading_data = true;\n\tview.callEvent(\"onDataParse\", [obj]);\n\tview._loading_data = false;\n\n\tview._table.refresh();\n\tif(view.config.bottombar)\n\t\tview.$$(\"sheets\").refresh();\n}\n\nfunction copy(view){\n\tadd(view, view.serialize());\n}\n\nfunction callAction(view, id){\n\tif(!view.$sheetMenu.data.getMark(id, \"webix_disabled\"))\n\t\tactionMap[id](view);\n}\n\n","import \"../views/formlate\";\n\nexport class Dialog{\n\tconstructor(view){\n\t\tthis.view = view;\n\t}\n\t$init(){}\n\t$show(){}\n\t$hide(){}\n\topen(){\n\t\tif(!this.$dialog){\n\t\t\tthis.$dialog = webix.ui(this.$init());\n\t\t\tthis.view._destroy_with_me.push(this.$dialog);\n\t\t\tthis.$dialog.attachEvent(\"onHide\", ()=> {\n\t\t\t\tthis.$hide();\n\t\t\t\twebix.UIManager.setFocus(this.view);\n\t\t\t});\n\t\t\tthis.$dialog.attachEvent(\"onShow\", ()=> {\n\t\t\t\twebix.UIManager.setFocus(this.$dialog);\n\t\t\t});\n\t\t}\n\n\t\tconst form = this.$dialog.getBody();\n\t\tthis.$dialog.show();\n\t\tif (this.$show(this.$dialog, form) === false)\n\t\t\tthis.close();\n\t}\n\tclose(){\n\t\tthis.$dialog.hide();\n\t}\n}","export function image(url){\n\treturn `=IMAGE(\"${url}\")`;\n}\n\nexport function chart(config){\n\tlet result = `=SPARKLINE(${config.range},\"${config.type}\"`;\n\tif (config.type === \"bar\")\n\t\tresult += `,\"${config.color}\",\"${config.negativeColor}\"`;\n\telse if(config.color)\n\t\tresult += `,\"${config.color}\"`;\n\treturn result+\")\";\n\n}\n\nexport function parseImage(value){\n\tif (value && value.indexOf(\"=IMAGE(\") === 0)\n\t\treturn {\n\t\t\turl: unescape(value.substr(7, value.length-8))\n\t\t};\n}\n\nexport function parseChart(value){\n\tif (value && value.indexOf(\"=SPARKLINE(\") === 0){\n\t\tlet text = value.substr(11, value.length-12).split(\",\");\n\t\treturn {\n\t\t\trange: text[0],\n\t\t\ttype: unescape(text[1]),\n\t\t\tcolor: unescape(text[2]),\n\t\t\tnegativeColor: unescape(text[3])\n\t\t};\n\t}\n}\n\nfunction unescape(text){\n\tif (!text) return \"\";\n\n\ttext = text.trim();\n\tif (text[0] === \"\\\"\") \n\t\ttext = text.substr(1);\n\tif (text[text.length-1] === \"\\\"\")\n\t\ttext = text.substr(0, text.length-1);\n\treturn text;\n}","import {Dialog} from \"./common\";\nimport {parseImage} from \"../mathematics/writer\";\n\nexport const action = \"add-image-cell\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.cell = this.view.getSelectedId();\n\t\tif(!this.cell)\n\t\t\treturn false;\n\n\t\tform.elements.preview.setHTML(\"\");\n\t\tform.elements.url.setValue(\"\");\n\n\t\t//sync state of dialog to data with  the selected cell\n\t\tlet value = this.view.getCellValue(this.cell.row, this.cell.column);\n\t\tlet data = parseImage(value);\n\t\tif (data && data.url)\n\t\t\tform.elements.url.setValue(data.url);\n\n\t\tform.elements.url.focus();\n\t}\n\t$init(){\n\t\tconst save = this.view.config.save;\n\t\tconst server = (save && save.images) || null;\n\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"image-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"url\",  placeholder:webix.i18n.spreadsheet.labels[\"image-url\"], on:{\n\t\t\t\t\t\t\"onChange\":(image) => this.showPreview(image)\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"label\", label:webix.i18n.spreadsheet.labels[\"image-or\"], align: \"center\"},\n\t\t\t\t\t{ view:\"uploader\", label:webix.i18n.spreadsheet.labels[\"image-upload\"], upload:server, on:{\n\t\t\t\t\t\tonBeforeFileAdd: function(file){\n\t\t\t\t\t\t\tif (!this.config.upload){\n\t\t\t\t\t\t\t\tconst reader = new FileReader();\n\t\t\t\t\t\t\t\treader.onload = (e) => this.getFormView().elements.url.setValue(e.target.result);\n\t\t\t\t\t\t\t\treader.readAsDataURL(file.file);\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tthis.getFormView().elements.preview.setHTML(\"\");\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonFileUpload: function(item, response){\n\t\t\t\t\t\t\tthis.getFormView().elements.url.setValue(response.imageURL);\n\t\t\t\t\t\t}\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"formlate\", name:\"preview\", borderless: true, css: \"webix_ssheet_preview\", template:\"\", height:50 }\n\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tconst cell = this.cell;\n\t\tconst image = this.fillUrl(this.$dialog.getBody().elements.url.getValue());\n\t\tthis.view.addImage(cell.row, cell.column, image);\n\t\tthis.close();\n\t}\n\tfillUrl(url){\n\t\tif (!/^[/]|((https?:\\/|data:image)\\/)/i.test(url))\n\t\t\turl = \"http://\" + url;\n\t\treturn url;\n\t}\n\tshowPreview(image){\n\t\tif (image){\n\t\t\timage = webix.template.escape(this.fillUrl(image));\n\t\t\tthis.$dialog.queryView(\"form\").elements.preview.setHTML(\"<img class='webix_ssheet_cimage' src='\"+image+\"'></img>\");\n\t\t}\n\t}\n}","import * as box from \"./imagecell\";\n\nexport const action = \"add-image-top\";\n\nexport class DialogBox extends box.DialogBox{\n\topen(action){\n\t\tthis.config = action.config;\n\t\tthis.viewid = action.viewid;\n\n\t\tthis.view.callEvent(\"onUIEditStart\", [this.viewid, \"image\"]);\n\n\t\tbox.DialogBox.prototype.open.apply(this, arguments);\n\t}\n\t$hide(){\n\t\tthis.view.callEvent(\"onUIEditStop\", [this.viewid, \"image\"]);\n\t\tthis.config = this.viewid = null;\n\t}\n\t$init(){\n\t\tthis.view.attachEvent(\"onUIEditStart\", (id, type)=>{\n\t\t\tif(this.$dialog && this.$dialog.isVisible() && type != \"image\")\n\t\t\t\tthis.close();\n\t\t});\n\n\t\tthis.view.attachEvent(\"onCommand\", obj =>{\n\t\t\tif(obj.id == \"close-ui-editor\" && this.$dialog && this.$dialog.isVisible())\n\t\t\t\tthis.close();\n\t\t});\n\n\t\treturn box.DialogBox.prototype.$init.apply(this, arguments);\n\t}\n\t$show(box, form){\n\n\t\tform.elements.preview.setHTML(\"\");\n\t\tform.elements.url.setValue(\"\");\n\n\t\tif(this.config && this.config.data)\n\t\t\tform.elements.url.setValue(this.config.data);\n\n\t\tform.elements.url.focus();\n\t}\n\tokClick(){\n\t\tconst image = this.fillUrl(this.$dialog.getBody().elements.url.getValue());\n\t\tif(this.viewid)\n\t\t\tthis.view.views.update(this.viewid, image);\n\t\telse{\n\t\t\tconst id = this.view.views.add(null, null, \"image\", image);\n\t\t\tthis.view.views.highlight(id);\n\t\t}\n\t\tthis.close();\n\t}\n}","import {Dialog} from \"./common\";\nimport {range} from \"../helpers/column_names\";\nimport {parseChart} from \"../mathematics/writer\";\n\nexport const action = \"add-sparkline\";\n\nconst labels = webix.i18n.spreadsheet.labels;\n\nfunction getTypes(){\n\treturn  [\n\t\t{id:\"line\", value:labels[\"line-chart\"]},\n\t\t{id:\"spline\", value:labels[\"spline-chart\"]},\n\t\t{id:\"splineArea\", value:labels[\"splinearea-chart\"]},\n\t\t{id:\"area\", value:labels[\"area-chart\"]},\n\t\t{id:\"bar\", value:labels[\"bar-chart\"]},\n\t\t{id:\"pie\", value:labels[\"pie-chart\"]}\n\t];\n}\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.cell = this.view.getSelectedId();\n\t\tif(!this.cell)\n\t\t\treturn false;\n\n\t\tconst els = form.elements;\n\t\tthis.view.$handleSelection = function(st, end, a, b){\n\t\t\tels.range.setValue(a+\":\"+b);\n\t\t\treturn false;\n\t\t};\n\n\t\tels.range.setValue(\"\");\n\n\t\t//sync state of dialog to data with  the selected cell\n\t\tlet value = this.view.getCellValue(this.cell.row, this.cell.column);\n\t\tlet data = parseChart(value);\n\t\tif (data){\n\t\t\tform.blockEvent();\n\t\t\tels.type.setValue(data.type);\n\t\t\tels.range.setValue(data.range);\n\t\t\tif (data.color){\n\t\t\t\tels.color_def.setValue(data.color);\n\t\t\t\tels.color_pos.setValue(data.color);\t\t\n\t\t\t}\n\t\t\tif (data.negativeColor)\n\t\t\t\tels.color_neg.setValue(data.negativeColor);\n\t\t\tform.unblockEvent();\n\t\t\tthis.renderPreview();\n\t\t}\t\n\n\t\tels.range.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead:labels[\"sparkline-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\", visibleBatch:1, on:{ onChange : ()=> this.renderPreview() },  elements:[\n\t\t\t\t\t{view: \"richselect\", name:\"type\", label:labels[\"sparkline-type\"], value:\"line\", labelPosition:\"left\", suggest:{\n\t\t\t\t\t\tview:  \"ssheet-form-suggest\",\n\t\t\t\t\t\tdata:getTypes()\n\t\t\t\t\t}, on:{\n\t\t\t\t\t\tonChange: function(type){\n\t\t\t\t\t\t\tconst form = this.getFormView();\n\t\t\t\t\t\t\tswitch(type){\n\t\t\t\t\t\t\t\tcase \"pie\":\n\t\t\t\t\t\t\t\t\tform.showBatch(3);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase \"bar\":\n\t\t\t\t\t\t\t\t\tform.showBatch(2);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\tform.showBatch(1);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"text\", label:labels[\"sparkline-range\"], name:\"range\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:labels[\"sparkline-color\"], name:\"color_def\", id:\"add_sparkline_color\", value:\"#6666FF\", batch:\"1\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:labels[\"sparkline-positive\"], name:\"color_pos\", value:\"#6666FF\", batch:\"2\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:labels[\"sparkline-negative\"], name:\"color_neg\", value:\"#FF6666\", batch:\"2\"},\n\t\t\t\t\t{ view:\"formlate\", name:\"preview\", borderless:true, css:\"webix_ssheet_preview\", height:50 }\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tcheckRange(text){\n\t\tif(text && range(text, this.view))\n\t\t\treturn true;\n\t\tthis.view.alert({text:labels[\"error-range\"]});\n\t}\n\tokClick(){\n\t\tconst form = this.$dialog.getBody();\n\t\tconst data = form.getValues();\n\t\tdata.range = data.range.toUpperCase();\n\n\t\tif (data.range && this.checkRange(data.range)){\n\t\t\tconst config = this.sparkConfig(data);\n\n\t\t\tthis.view.addSparkline(this.cell.row, this.cell.column, config);\n\t\t\tthis.close();\n\t\t}\n\t}\n\n\trenderPreview(){\n\t\tconst form = this.$dialog.getBody();\n\t\tconst data = form.getValues();\n\t\tdata.range = data.range.toUpperCase();\n\n\t\tif (data.range && this.checkRange(data.range)){\n\t\t\tconst pos = range(data.range, this.view);\n\t\t\tlet i,\n\t\t\t\tvalues = this.view._mPage.getRange(pos[0]-1, pos[1]-1, pos[2]-1, pos[3]-1),\n\t\t\t\tconfig = this.sparkConfig();\n\t\t\tfor(i =0 ; i < values.length; i++)\n\t\t\t\tvalues[i] = values[i]||0;\n\t\t\tform.elements.preview.setValue(webix.Sparklines.getTemplate(config)(values, { width:200, height: 40 }));\n\t\t}\n\t\telse\n\t\t\tform.elements.preview.setValue(\"\");\n\t}\n\n\tsparkConfig(config){\n\t\tconst form = this.$dialog.getBody();\n\t\tconst data = form.getValues();\n\t\tconfig = config || { type: data.type  };\n\t\tif (data.type === \"bar\"){\n\t\t\tconfig.color = data.color_pos;\n\t\t\tconfig.negativeColor = data.color_neg;\n\t\t}\n\t\telse if(form.elements.color_def.isVisible())\n\t\t\tconfig.color = data.color_def;\n\n\t\treturn config;\n\t}\n}","import {Dialog} from \"./common\";\nimport {isRange, toSheetRange} from \"../helpers/column_names\";\nimport {getLastCharIndex} from \"../mathematics/parser\";\n\nexport const action = \"add-range\";\n\nexport class DialogBox extends Dialog{\n\t$show(box){\n\t\tconst form = box.$$(\"form\");\n\n\t\tform.clear();\n\t\tform.clearValidation();\n\n\t\tconst elements = form.elements;\n\n\t\telements.name.focus();\n\n\t\tlet selectedCell = this.view.getSelectedRange();\n\t\tif(selectedCell)\n\t\t\tselectedCell = this.view.getActiveSheet()+\"!\"+selectedCell;\n\n\t\tform.setValues({\n\t\t\trange: selectedCell,\n\t\t\tscope: \"$global\"\n\t\t});\n\n\t\tthis._updateData();\n\n\t\tthis.view._rangeDialog = true;\n\t\tthis.view.$handleSelection = (st, end, a, b)=>{\n\t\t\tform.elements.range.setValue(toSheetRange(a,b,this.view.getActiveSheet()));\n\t\t\treturn false;\n\t\t};\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t\tthis.view._rangeDialog = null;\n\t}\n\tsaveClick(){\n\t\tconst view = this.view;\n\t\tconst form = this.$dialog.$$(\"form\");\n\t\tconst data = form.getValues();\n\n\t\tif(data.range){\n\t\t\tconst rangeParts = data.range.split(\"!\");\n\n\t\t\tif(rangeParts.length == 1)\n\t\t\t\trangeParts.unshift( view.getActiveSheet() );\n\n\t\t\tdata.range = rangeParts[0]+\"!\"+rangeParts[1].toUpperCase();\n\t\t}\n\n\t\tdata.name = data.name.toUpperCase();\n\n\t\tform.setValues(data);\n\n\t\tif (form.validate()){\n\t\t\tconst table = this.$dialog.$$(\"table\");\n\n\t\t\tif(data.id){\n\t\t\t\tconst oldData = table.getItem(data.id);\n\n\t\t\t\tview.ranges.remove(oldData.name, this._getScope(oldData));\n\t\t\t\ttable.updateItem(data.id, data);\n\t\t\t}\n\t\t\telse\n\t\t\t\ttable.add(data);\n\n\t\t\tview.ranges.add(\n\t\t\t\tdata.name,\n\t\t\t\tdata.range,\n\t\t\t\tthis._getScope(data)\n\t\t\t);\n\n\t\t\tview.refresh();\n\n\t\t\ttable.unselect();\n\t\t\tform.setValues({scope: \"$global\"});\n\t\t}\n\t}\n\t_getScope(data){\n\t\treturn data.scope == \"$global\" ? true : data.scope;\n\t}\n\tremoveRange(id){\n\t\tconst view = this.view;\n\t\tview.confirm({\n\t\t\ttext: webix.i18n.spreadsheet.labels[\"range-remove-confirm\"]\n\t\t}).then(()=>{\n\t\t\tconst table = this.$dialog.$$(\"table\");\n\t\t\tconst item = table.getItem(id);\n\n\t\t\tview.ranges.remove(item.name, this._getScope(item));\n\n\t\t\tview.refresh();\n\t\t\ttable.remove(id);\n\t\t});\n\t}\n\teditRange(id){\n\t\tconst form = this.$dialog.$$(\"form\");\n\t\tconst table = this.$dialog.$$(\"table\");\n\n\t\tform.clearValidation();\n\t\tconst item = webix.copy(table.getItem(id));\n\n\t\tform.setValues(item);\n\t}\n\t$init(){\n\t\tthis.view.attachEvent(\"onSheetRename\", (name, newName)=> this._updateData(name, newName));\n\t\tthis.view.attachEvent(\"onSheetRemove\", (name)=> this._updateData(name));\n\t\tthis.view.attachEvent(\"onSheetAdd\", ()=> this._updateData());\n\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\tconst theform = {\n\t\t\tpadding:0,\n\t\t\ttype: \"clean\",\n\t\t\tcols:[\n\t\t\t\t{ view: \"ssheet-dialog-table\", id: \"table\", borderless:true, columns:[\n\t\t\t\t\t{ id:\"name\", header:locale[\"range-name\"], width: 120 },\n\t\t\t\t\t{ id:\"range\", header:locale[\"range-cells\"], width: 150 },\n\t\t\t\t\t{ id:\"scope\", header:locale[\"range-scope\"], width: 95, template: obj => {\n\t\t\t\t\t\treturn obj.scope == \"$global\" ? locale[\"range-global\"] : obj.scope;\n\t\t\t\t\t}},\n\t\t\t\t\t{ template:\"<span class='webix_icon ssheet_ranges_edit wxi-pencil'></span>\", width:44 },\n\t\t\t\t\t{ template:\"<span class='webix_icon ssheet_ranges_edit wxi-trash'></span>\", width:44 }\n\t\t\t\t],\n\t\t\t\tautowidth:true, height: 200, select:\"row\",\n\t\t\t\ton:{\n\t\t\t\t\tonBeforeSelect: id =>{\n\t\t\t\t\t\treturn id == this.$dialog.$$(\"form\").getValues().id;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonClick:{\n\t\t\t\t\t\"wxi-trash\":(ev, id) => this.removeRange(id),\n\t\t\t\t\t\"wxi-pencil\":(ev, id) => this.editRange(id)\n\t\t\t\t}},\n\t\t\t\t{ width: 270, view: \"form\", id:\"form\",\n\t\t\t\t\trules:{\n\t\t\t\t\t\tname: (_, obj)=> {\n\t\t\t\t\t\t\tconst notUnique = this.$dialog.$$(\"table\").find(item => {\n\t\t\t\t\t\t\t\treturn item.name == obj.name && item.scope == obj.scope && item.id != obj.id;\n\t\t\t\t\t\t\t}, true);\n\n\t\t\t\t\t\t\treturn !notUnique && !getLastCharIndex(obj.name);\n\t\t\t\t\t\t},\n\t\t\t\t\t\trange: isRange,\n\t\t\t\t\t\tscope: webix.rules.isNotEmpty\n\t\t\t\t\t},\n\t\t\t\t\telementsConfig:{\n\t\t\t\t\t\tlabelWidth: 95\n\t\t\t\t\t},\n\t\t\t\t\telements:[\n\t\t\t\t\t\t{ view: \"text\", name:\"name\", label: locale[\"range-name\"]},\n\t\t\t\t\t\t{ view: \"text\", name:\"range\", id:\"range\", label: locale[\"range-cells\"], on:{\n\t\t\t\t\t\t\tonFocus:()=>{\n\t\t\t\t\t\t\t\tconst value = this.$dialog.$$(\"range\").getValue();\n\t\t\t\t\t\t\t\tconst rangeParts = value.split(\"!\");\n\t\t\t\t\t\t\t\tif(rangeParts.length == 2 && this.view.getActiveSheet() != rangeParts[0])\n\t\t\t\t\t\t\t\t\tthis.view.showSheet(rangeParts[0]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}},\n\t\t\t\t\t\t{ view: \"richselect\", name:\"scope\", id:\"sheets\", label: locale[\"range-scope\"], suggest:{\n\t\t\t\t\t\t\tview: \"ssheet-form-suggest\",\n\t\t\t\t\t\t\tbody:{\n\t\t\t\t\t\t\t\tdata: []\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tmove:true,\n\t\t\thead: webix.i18n.spreadsheet.labels[\"range-title\"],\n\t\t\tautoheight: true,\n\t\t\twidth: 800,\n\t\t\tposition: \"center\",\n\t\t\tbody: theform,\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.saveClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\t_updateData(name, newName){\n\t\tif(!this.$dialog.isVisible())\n\t\t\treturn;\n\n\t\tconst ranges = this.view._mData.getRanges();\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\tconst table = this.$dialog.$$(\"table\");\n\t\tconst form = this.$dialog.$$(\"form\");\n\n\t\tlet editRange = table.getItem( form.getValues().id );\n\t\tif(editRange){\n\t\t\tlet rangeName = editRange.name;\n\n\t\t\tif(name == editRange.scope)\n\t\t\t\trangeName = newName ? newName+\"!\"+rangeName : null;\n\t\t\telse\n\t\t\t\trangeName = editRange.scope+\"!\"+rangeName;\n\n\t\t\teditRange = rangeName ? ranges.get(rangeName) : null;\n\t\t}\n\n\t\ttable.clearAll();\n\n\t\tconst allRanges = ranges.serialize();\n\t\tconst data = [];\n\n\t\tlet selectedId;\n\t\tfor(let i = 0; i < allRanges.length; i++){\n\t\t\tconst id = i+1;\n\t\t\tlet [name, range] = allRanges[i];\n \n\t\t\tif(editRange && ranges.get(name) == editRange)\n\t\t\t\tselectedId = id;\n\n\t\t\tconst nameParts = name.split(\"!\");\n\n\t\t\tdata.push({\n\t\t\t\tscope: nameParts.length == 1 ? \"$global\" : nameParts[0],\n\t\t\t\tname: nameParts[1] || nameParts[0],\n\t\t\t\trange,\n\t\t\t\tid\n\t\t\t});\n\t\t}\n\n\t\ttable.parse(data);\n\n\t\tform.setValues({id:selectedId}, true);\n\t\tif(selectedId)\n\t\t\ttable.select(selectedId);\n\n\t\tconst select = this.$dialog.$$(\"sheets\");\n\t\tconst selectList = select.getList();\n\n\t\tselectList.clearAll();\n\n\t\tconst sheets = [{\n\t\t\tid: \"$global\", value: locale[\"range-global\"]\n\t\t}];\n\t\tthis.view._sheets.forEach(sheet => {\n\t\t\tsheets.push({id:sheet.name, value: sheet.name});\n\t\t});\n\t\tselectList.parse(sheets);\n\n\t\tif(name){\n\t\t\tconst range = this.$dialog.$$(\"range\");\n\t\t\tconst rangeVal = range.getValue();\n\n\t\t\t//remove sheet\n\t\t\tnewName = newName || this.view.getActiveSheet();\n\n\t\t\tif(rangeVal.indexOf(name+\"!\") == 0)\n\t\t\t\trange.setValue((newName)+\"!\"+rangeVal.split(\"!\")[1]);\n\n\t\t\tif(select.getValue() == name)\n\t\t\t\tselect.setValue(newName);\n\t\t}\n\t}\n}","import {Dialog} from \"./common\";\nimport {range} from \"../helpers/column_names\";\nimport group from \"../operations/undo_group\";\n\nexport const action = \"add-dropdown\";\n\nexport class DialogBox extends Dialog{\n\t$show(){\n\t\tlet form = this.$dialog.$$(\"form\");\n\t\tthis.cell = this.view.getSelectedId(true);\n\t\tif (!this.cell.length)\n\t\t\treturn false;\n\n\t\tform.clear();\n\n\t\t//restore previosly selected range\n\t\tlet value = this.view.getCellEditor(this.cell[0].row, this.cell[0].column);\n\t\tif (value && value.options)\n\t\t\tform.elements.range.setValue(value.options);\n\n\t\tthis.view.$handleSelection = function(st, end, a, b){\n\t\t\tform.elements.range.setValue(a+\":\"+b);\n\t\t\treturn false;\n\t\t};\n\n\t\tform.elements.range.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\thead:webix.i18n.spreadsheet.labels[\"dropdown-title\"],\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tpadding:0, view:\"form\", id:\"form\", rows:[\n\t\t\t\t\t{ view:\"text\", label:webix.i18n.spreadsheet.labels[\"dropdown-range\"], name:\"range\" }\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tconst values = this.$dialog.$$(\"form\").elements.range.getValue();\n\n\t\tif (values){\n\t\t\tif(!range(values, this.view))\n\t\t\t\tthis.view.alert({text:webix.i18n.spreadsheet.labels[\"error-range\"]});\n\t\t\telse{\n\t\t\t\tgroup.set(function(){\n\t\t\t\t\tfor (let i = 0; i < this.cell.length; i++)\n\t\t\t\t\t\tthis.view.setCellEditor(this.cell[i].row, this.cell[i].column, { editor:\"ss_richselect\", options:values});\n\t\t\t\t}, this);\n\t\t\t\tthis.close();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\tthis.close();\n\t}\n}","import {range as getRangePos} from \"../helpers/column_names\";\nimport {cell_template} from \"../table\";\n\nclass Ranges{\n\tconstructor(view){\n\t\tthis._master = view;\n\t}\n\tclear(scope){\n\t\tconst sheet = typeof scope == \"string\" ? scope : this._master.getActiveSheet();\n\t\tconst ranges = this.serialize(sheet);\n\t\tranges.forEach(range => {\n\t\t\tif(scope === true){\n\t\t\t\tif(range[2])\n\t\t\t\t\tthis.remove(range[0], scope);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse\n\t\t\t\tthis.remove(range[0], scope);\n\t\t});\n\t}\n\t_normalizeName(name, scope){\n\t\tif(scope !== true)\n\t\t\tname = (scope || this._master.getActiveSheet())+\"!\"+name;\n\t\treturn name;\n\t}\n\t_normalizeRange(range, scope){\n\t\tconst rangeParts = range.split(\"!\");\n\t\tif(rangeParts.length == 1)\n\t\t\trange = (typeof scope == \"string\" ? scope : this._master.getActiveSheet()) + \"!\" + range;\n\t\treturn range;\n\t}\n\tadd(name, range, scope){\n\t\tconst view = this._master;\n\n\t\tview.callEvent(\"onAfterRangeSet\", [name, range, scope]);\n\n\t\tname = this._normalizeName(name, scope);\n\n\t\tview._mData.getRanges().add(name, this._normalizeRange(range, scope));\n\t\tview.callEvent(\"onMathRefresh\", []);\n\t}\n\tgetCode(name, scope){\n\t\tname = this._normalizeName(name, scope);\n\n\t\tconst range = this._master._mData.getRanges().get(name);\n\t\tif(range)\n\t\t\treturn range.source;\n\t}\n\tremove(name, scope){\n\t\tname = this._normalizeName(name, scope);\n\n\t\tthis._master._mData.getRanges().remove(name);\n\t\tthis._master.callEvent(\"onMathRefresh\", []);\n\t}\n\tparse(data, sheet){\n\t\tif(!data)\n\t\t\treturn;\n\t\tfor(let i = 0; i < data.length; i++){\n\t\t\tconst ranges = this._master._mData.getRanges();\n\t\t\tlet [name, range, globalRange] = data[i];\n\t\t\tname = this._normalizeName(name, globalRange||sheet);\n\n\t\t\tif(!ranges.get(name))\n\t\t\t\tranges.add(name, this._normalizeRange(range, sheet));\n\t\t}\n\t}\n\tserialize(sheet){\n\t\tsheet = sheet || this._master.getActiveSheet();\n\t\tconst allRanges = this._master._mData.getRanges().serialize();\n\t\tconst out = [];\n\n\t\tfor(let i = 0; i < allRanges.length; i++){\n\t\t\tconst arr = allRanges[i];\n\t\t\tconst nameParts = arr[0].split(\"!\");\n\t\t\tconst globalRange = nameParts.length == 1;\n\n\t\t\tif(globalRange || nameParts[0] == sheet)\n\t\t\t\tout.push([\n\t\t\t\t\tnameParts[ globalRange ? 0 : 1 ],\n\t\t\t\t\tarr[1],\n\t\t\t\t\tglobalRange\n\t\t\t\t]);\n\t\t}\n\n\t\treturn out;\n\t}\n\tgetRanges(sheet){\n\t\tconst data = this.serialize(sheet);\n\t\treturn data.map(arr => {\n\t\t\treturn {\n\t\t\t\tname: arr[0],\n\t\t\t\trange: arr[1],\n\t\t\t\tglobal: arr[2]\n\t\t\t};\n\t\t});\n\t}\n}\n\nexport function init(view) {\n\tview.ranges = new Ranges(view);\n\n\tview.attachEvent(\"onDataSerialize\", data => {\n\t\tdata.ranges = view.ranges.serialize();\n\t});\n}\n\nfunction nullFilter(){ \n\tconst locale = webix.i18n.spreadsheet.labels;\n\treturn { id:\"$empty\", value:\"\", $value:\"<span class='webix_ssheet_empty'>\"+locale[\"dropdown-empty\"]+\"</span>\" };\n}\n\nfunction getRange(view, r1, c1, r2, c2){\n\tconst out = [];\n\tconst activeSheet = view._mPage === this;\n\n\tfor (var i = r1-1; i <= r2-1; i++) {\n\t\tfor (var j = c1-1; j <= c2-1; j++){\n\t\t\tlet obj = this.getCell(i, j);\n\t\t\tlet cell;\n\n\t\t\tif(!obj)\n\t\t\t\tcell = {\n\t\t\t\t\tvalue: \"\"\n\t\t\t\t};\n\t\t\telse\n\t\t\t\tcell = webix.copy(obj);\n\n\t\t\tif(activeSheet)\n\t\t\t\tcell.$value = cell_template(view, {id: i+1}, null, null, {id:j+1}, true);\n\t\t\telse\n\t\t\t\tdelete cell.format;\n\n\t\t\tcell.id = cell.value;\n\t\t\tout.push(cell);\n\t\t}\n\t}\n\n\treturn out;\n}\n\nexport function rangeOptions(view, text, extra){\n\tlet values = [];\n\tif (typeof text == \"string\"){\n\t\tconst pos = getRangePos(text, view);\n\t\tif (pos){\n\t\t\tlet page = view._mPage;\n\t\t\tif(pos[4])\n\t\t\t\tpage = view._mData.getPage(pos[4]);\n\n\t\t\tvalues = page ? getRange.apply(page, [view, ...pos]) : [];\n\t\t}\n\t}\n\telse if (webix.isArray(text))\n\t\tfor (let i=0; i<text.length; i++){\n\t\t\tlet v = (text[i] || text[i] === 0) ? text[i] : \"\";\n\t\t\tv = (typeof v === \"object\") ? webix.copy(v) : { id:v, value:v };\n\t\t\tvalues.push(v);\n\t\t}\n\n\tif (extra){\n\t\tif (extra.unique){\n\t\t\tconst test = {};\n\t\t\tfor (let i=values.length-1; i>=0; i--){\n\t\t\t\tif (test[values[i].id])\n\t\t\t\t\tvalues.splice(i, 1);\n\t\t\t\telse\n\t\t\t\t\ttest[values[i].id] = true;\n\t\t\t}\n\t\t}\n\n\t\tlet empty = false;\n\t\tfor (let i=values.length-1; i>=0; i--){\n\t\t\tvalues[i].value = String(values[i].value);\n\t\t\tif (values[i].value === \"\"){\n\t\t\t\tvalues.splice(i, 1);\n\t\t\t\tempty = true;\n\t\t\t}\n\t\t}\n\n\t\tif (extra.order)\n\t\t\tvalues.sort(function(objA, objB){\n\t\t\t\tconst sorters = view.$$(\"cells\").data.sorting.as;\n\t\t\t\tconst a = objA.value;\n\t\t\t\tconst b = objB.value;\n\n\t\t\t\treturn webix.rules.isNumber(a) && webix.rules.isNumber(b) ? sorters.int(a, b) : sorters.string(a, b);\n\t\t\t});\n\n\t\tif (empty && extra.filter)\n\t\t\tvalues.unshift( nullFilter() );\n\n\t\tif (extra.empty)\n\t\t\tvalues.unshift({ id:\"$empty\", $empty:true, value:\"\" });\n\t}\n\treturn values;\n}","import group from \"./undo_group\";\nimport {getType} from \"./types\";\nimport {setSpanCss} from \"./spans\";\nimport {rangeOptions} from \"../mathematics/ranges\";\nimport {changeRange, eachRange, toRange} from \"../helpers/column_names\";\nimport {conditions} from \"../helpers/conditional\";\n\nexport function init(view){\n\tconst table = view._table;\n\n\tview.attachEvent(\"onReset\", () => reset(view));\n\treset(view);\n\n\ttable.on_click.ssheet_filter_sign = (e, id) => {\n\t\tconst filter = table._ssFilters[id.row][id.column];\n\t\tconst mode = filter.mode || getFilterMode(view, id.row, id.column);\n\n\t\tlet options = [];\n\t\tif (filter.options){\n\t\t\tif (typeof filter.options == \"string\")\n\t\t\t\toptions = rangeOptions(view, filter.options, { unique:true, order:true, filter:true });\n\t\t\telse if (webix.isArray(filter.options))\n\t\t\t\toptions = rangeOptions(view, filter.options, { filter:true });\n\t\t}\n\t\tview.callEvent(\"onCommand\", [{id:\"start-filter\", cell:id, mode, options, filter}]);\n\t};\n\ttable.on_dblclick.ssheet_filter_sign = () => false;\n\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"create-filter\")\n\t\t\ttoggleFilters(view);\n\t});\n\n\tlet refilter = false;\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif (type == \"filter\"){\n\t\t\tvalue = (typeof value == \"object\") ? value : null;\n\t\t\tview.setCellFilter(row, column, value);\n\t\t\trefilter = true;\n\t\t}\n\t\telse if (type == \"apply-filter\"){\n\t\t\tconst filter = view.getCellFilter(row, column);\n\n\t\t\tfilter.value = value;\n\t\t\tdelete filter.handler;\n\t\t\tif (value && value.condition){\n\t\t\t\tconst mode = filter.mode || getFilterMode(view, row, column);\n\t\t\t\tfilter.handler = getFilterFunction(mode, filter.value);\n\t\t\t}\n\t\t\trefilter = true;\n\n\t\t\t// update css\n\t\t\tconst add = value && isValueActive(value);\n\t\t\ttable[add?\"addCellCss\":\"removeCellCss\"](row, column, \"ss_filter_active\");\n\t\t\tsetSpanCss(view, row, column, \"ss_filter_active\", add);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAfterUndo\", () => {\n\t\tif (refilter){\n\t\t\tview.filterSpreadSheet();\n\t\t\trefilter = false;\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p) => {\n\t\tif (action == \"filter\"){\n\t\t\tsetSpanCss(view, p.row, p.column, \"ss_filter\", p.newValue);\n\t\t\tsetSpanCss(view, p.row, p.column, \"ss_filter_active\", (p.newValue && p.newValue.value && isValueActive(p.newValue.value)));\n\t\t\tmarkBarFilter(view);\n\t\t}\n\t\telse if (action == \"before-grid-change\")\n\t\t\tupdatePosition(view, p.name, p.inc, p.data, p.start);\n\t});\n}\n\nfunction reset(view){\n\tview._table._ssFilters = {};\n\tmarkBarFilter(view);\n}\n\nexport function getFilters(table){\n\tconst filters = table._ssFilters;\n\tconst all = [];\n\tfor (let row in filters)\n\t\tfor (let column in filters[row])\n\t\t\tall.push(filters[row][column]);\n\treturn all;\n}\n\nexport function serialize(view,data){\n\tconst filters = getFilters(view._table);\n\tconst result = data.filters = [];\n\n\tfor (let i = 0; i<filters.length; i++){\n\t\tlet {row, column, options, mode, value} = filters[i];\n\t\tvalue = value && webix.copy(value);\n\t\tresult.push([row, column, {value, options, mode}]);\n\t}\n}\n\nexport function load(view,data){\n\tconst filters = data.filters;\n\n\tif (filters){\n\t\tfor (let i = 0; i < filters.length; i++){\n\t\t\tview.setCellFilter(filters[i][0], filters[i][1], (filters[i][2] || {options:\"\"}));\n\t\t}\n\t\tview.filterSpreadSheet();\n\t}\n}\n\nexport function clearFilters(view, range){\n\tlet refilter = false;\n\teachRange(range, view, function(view, cell){\n\t\tlet filter = view._table._ssFilters[cell.row];\n\t\tif (filter){\n\t\t\tif (filter[cell.column]){\n\t\t\t\trefilter = true;\n\t\t\t\tdelete filter[cell.column];\n\n\t\t\t\tview._table.removeCellCss(cell.row, cell.column, \"ss_filter\");\n\t\t\t\tview._table.removeCellCss(cell.row, cell.column, \"ss_filter_active\");\n\n\t\t\t\tsetSpanCss(view, cell.row, cell.column, \"ss_filter\", false);\n\t\t\t\tsetSpanCss(view, cell.row, cell.column, \"ss_filter_active\", false);\n\t\t\t}\n\t\t}\n\t});\n\n\tif (refilter)\n\t\tview.filterSpreadSheet();\n}\n\nexport function isFilter(view, row, column){\n\tconst filters = view._table._ssFilters;\n\treturn filters[row] && !!filters[row][column];\n}\n\nexport function calibrateRange(view, row, column, range){\n\tif(!range)\n\t\trange = {end:{row:row}};\n\n\tif (range.end){\n\t\tvar endRow = range.end.row;\n\t\trange = getFilterRange(view, row, column, endRow);\n\t}\n\treturn range;\n}\n\nexport function isValueActive(value){\n\treturn !!(value.includes || (value.condition && value.condition.filter));\n}\n\nfunction isFilterExists(view){\n\tconst filters = view._table._ssFilters;\n\tfor (let row in filters)\n\t\tfor (let column in filters[row])\n\t\t\tif (filters[row][column]) return true;\n\treturn false;\n}\n\nfunction markBarFilter(view){\n\tconst value = isFilterExists(view);\n\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"create-filter\", value}]);\n}\n\n\nfunction getFilterRange(view, row, column, endRow){\n\tif (row === endRow){\n\t\tfor (endRow = row; endRow < view.config.rowCount; endRow++){\n\t\t\tif(!view.getCellValue(endRow+1, column))\n\t\t\t\tbreak;\n\t\t}\n\t}\n\treturn toRange(row+1, column, endRow, column);\n}\n\nexport function getFilterMode(view, row, column){\n\tfor (let i=row+1; i<view.config.rowCount; i++){\n\t\tconst value = view.getCellValue(i, column);\n\n\t\tif (value || value === 0){\n\t\t\tconst type = getType(view, i, column);\n\t\t\treturn (type == \"number\" || type == \"date\") ? type : \"text\";\n\t\t}\n\t\telse if (value !== \"\")\n\t\t\tbreak;\n\t}\n\treturn \"text\";\n}\n\nfunction toggleFilters(view){\n\tconst range = view._table.getSelectArea();\n\n\tif (isFilterExists(view)){\n\t\tgroup.set(function(){\n\t\t\tview.removeFilters();\n\t\t});\n\t\tif (range)\n\t\t\tview._table.addSelectArea(range.start, range.end);\n\t}\n\telse if (range)\n\t\tgroup.set(function(){\n\t\t\tlet row = range.start.row;\n\t\t\tfor (let i=range.start.column; i<=range.end.column; i++){\n\t\t\t\tview.setCellFilter(row, i, { options:range });\n\t\t\t}\n\t\t});\n\tmarkBarFilter(view);\n}\n\nfunction updatePosition(view, name, inc, data, start){\n\tconst filters = data.filters;\n\n\tif (inc){\n\t\tfor(let i=filters.length-1; i>=0; i--){\n\t\t\tlet [row,column,filter] = filters[i];\n\t\t\tif (name == \"row\" && row >= start.row || name == \"column\" && column >= start.column){\n\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc){\t//delete filter mark if row was deleted\n\t\t\t\t\t\tfilters.splice(i,1);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tfilters[i][0] = row*1 + inc;\n\t\t\t\t}\n\t\t\t\telse if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tfilters.splice(i, 1);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else \n\t\t\t\t\t\tfilters[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t\tfilter.options = changeRange(filter.options, name, inc, start);\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function pasteFilter(view, extra, row, col, cutted, translate){\n\tconst filter = extra.filter;\n\n\tfilter.options = changeRange(filter.options, \"row\", translate.row, {column:extra.col, row:extra.row});\n\tfilter.options = changeRange(filter.options, \"column\", translate.column, {column:extra.col, row:extra.row});\n\n\tdelete filter.value; delete filter.handler;\n\tview.setCellFilter(row, col, filter);\n}\n\nexport function getSingleOption(mode, type){\n\tconst c = conditions[mode];\n\tfor (let i=0; i<c.length; i++)\n\t\tif (c[i].id == type) return c[i];\n}\n\nexport function getConditions(name){\n\treturn webix.copy( conditions[name] );\n}\n\nexport function getFilterFunction(mode, value){\n\tconst { includes, condition } = value;\n\tconst opt = getSingleOption(mode, condition.type);\n\tconst handler = opt ? opt.handler : function(){ return true; };\n\n\tif (includes){\n\t\tfor (let i=0; i<includes.length; i++)\n\t\t\tincludes[i] = String(includes[i]);\n\t}\n\n\treturn function(value){\n\t\tif (includes){\n\t\t\treturn includes.indexOf(value) !== -1;\n\t\t} else {\n\t\t\treturn condition.filter === \"\" || handler(value, condition.filter);\n\t\t}\n\t};\n}","import {Dialog} from \"./common\";\nimport * as flt from \"../operations/filter\";\n\nexport const action = \"start-filter\";\n\nexport class DialogBox extends Dialog{\n\topen(action){\n\t\tthis.cell = action.cell;\n\t\tthis.$mode = action.mode;\n\t\tthis.$filter = action.filter;\n\n\t\t// cell not provided\n\t\tif (!this.cell || \n\t\t\t// cell is locked\n\t\t\t(this.view.isCellLocked(this.cell.row, this.cell.column))){\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.$dialog){\n\t\t\tthis.$dialog = webix.ui(this.$init());\n\t\t\tthis.view._destroy_with_me.push(this.$dialog);\n\t\t\tthis.$dialog.attachEvent(\"onHide\", () => this.$hide());\n\n\t\t\tconst table = this.view.$$(\"cells\");\n\t\t\ttable.attachEvent(\"onScrollY\", () => this.syncScroll());\n\t\t\ttable.attachEvent(\"onScrollX\", () => this.syncScroll());\n\t\t}\n\n\t\tif (this.$show(this.$filter.value, action.options) === false)\n\t\t\treturn this.close();\n\t\tthis.$dialog.show( this._getTargetNode() );\n\t}\n\t_getTargetNode(){\n\t\tconst table = this.view.$$(\"cells\");\n\t\tconst span = table.getSpan(this.cell.row, this.cell.column);\n\t\treturn span ? table.getSpanNode(this.cell) : table.getItemNode(this.cell);\n\t}\n\t$show(value, options){\n\t\tconst list = this.getList();\n\t\tconst filter = this.getFilter();\n\n\t\tif (filter.config.mode !== this.$mode){\n\t\t\tfilter.define(\"conditions\", this.getConditions(this.$mode));\n\t\t\tfilter.define(\"mode\", this.$mode);\n\t\t}\n\n\t\t// if the filter mode for the current column has been changed - reset the value\n\t\tconst type = value && value.conditions && value.conditions.type;\n\t\tif (type && !flt.getSingleOption(this.$mode, type))\n\t\t\tvalue = \"\";\n\n\t\tlist.clearAll();\n\t\tlist.data.importData(options);\n\n\t\t// filter data has been changed - reset value\n\t\tfilter.config.value = \"\";\n\t\tfilter.setValue( webix.copy(value||{}) );\n\t}\n\t$init(){\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\treturn {\n\t\t\tview:\"popup\",\n\t\t\tcss:\"ssheet_filter\",\n\t\t\tpadding:7,\n\t\t\trelative:\"right\",\n\t\t\tbody:{\n\t\t\t\tmargin:4,\n\t\t\t\trows:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"filter\",\n\t\t\t\t\t\tfield:\"value\",\n\t\t\t\t\t\tmode:\"text\",\n\t\t\t\t\t\tconditions:this.getConditions(\"text\"),\n\t\t\t\t\t\tinputs:[\n\t\t\t\t\t\t\t\"text\",\n\t\t\t\t\t\t\t{ view:\"ssheet-datepicker\", timepicker:true, batch:\"datepicker\", on:{\n\t\t\t\t\t\t\t\tonChange:() => this.getFilter().applyFilter()\n\t\t\t\t\t\t\t}},\n\t\t\t\t\t\t\t{ view:\"ssheet-daterangepicker\", timepicker:true, batch:\"daterangepicker\", on:{\n\t\t\t\t\t\t\t\tonChange:() => this.getFilter().applyFilter()\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t],\n\t\t\t\t\t\ttemplate:function(obj){\n\t\t\t\t\t\t\treturn obj.$value || obj.value;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t{ },\n\t\t\t\t\t\t{ view:\"button\", label:locale[\"cancel\"], autowidth:true, css:\"webix_transparent\", on:{\n\t\t\t\t\t\t\t\"onItemClick\": () => this.close()\n\t\t\t\t\t\t}},\n\t\t\t\t\t\t{ view:\"button\", label:locale[\"apply\"], autowidth:true, css:\"webix_secondary\", on:{\n\t\t\t\t\t\t\t\"onItemClick\": () => this.applyFilter()\n\t\t\t\t\t\t}},\n\t\t\t\t\t]}\n\t\t\t\t]\n\t\t\t}\n\t\t};\n\t}\n\tapplyFilter(){\n\t\tconst filter = this.getFilter();\n\t\tconst oldValue = this.$filter.value;\n\t\tconst value = this.$filter.value = filter.getValue();\n\t\tthis.$filter.handler = flt.getFilterFunction(this.$mode, value);\n\n\t\tthis.view.filterSpreadSheet();\n\t\tthis.view.callEvent(\"onAction\", [\"apply-filter\", { row:this.cell.row, column:this.cell.column, value:oldValue, newValue:value }]);\n\t\tthis.setCellStyle(this.cell.row, this.cell.column, \"ss_filter_active\", flt.isValueActive(value));\n\n\t\tthis.close();\n\t}\n\tsetCellStyle(row, column, css, add){\n\t\tconst table = this.view.$$(\"cells\");\n\t\tconst span = this.getSpan(table, row, column);\n\n\t\tif (span){\n\t\t\tif (add){\n\t\t\t\tif (span[3].indexOf(css) == -1)\n\t\t\t\t\tspan[3] += \" \" + css;\n\t\t\t} else {\n\t\t\t\tspan[3] = span[3].replace(\" \" + css, \"\");\n\t\t\t}\n\t\t}\n\t\ttable[add?\"addCellCss\":\"removeCellCss\"](row, column, css);\n\t}\n\tgetSpan(table, row, column){\n\t\tlet item = table.getSpan()[row];\n\t\tif (item)\n\t\t\treturn item[column];\n\t}\n\tgetList(){\n\t\treturn this.getFilter().getChildViews()[2];\n\t}\n\tgetFilter(){\n\t\treturn this.$dialog.getBody().getChildViews()[0];\n\t}\n\tsyncScroll(){\n\t\tif (this.$dialog.isVisible()){\n\t\t\tconst node = this._getTargetNode();\n\t\t\tconst table = this.view.$$(\"cells\");\n\n\t\t\tlet isHidden = false;\n\t\t\tif (node){\n\t\t\t\tconst nodeOffset = webix.html.offset( node );\n\t\t\t\tconst tableOffset = webix.html.offset( table.$view.getElementsByClassName(\"webix_ss_body\")[0] );\n\t\t\t\tconst ydiff = nodeOffset.y - tableOffset.y;\n\t\t\t\tconst xdiff = nodeOffset.x - tableOffset.x + nodeOffset.width;\n\n\t\t\t\tisHidden = (ydiff < 0 || ydiff+nodeOffset.height > tableOffset.height || \n\t\t\t\t\txdiff < 0 || xdiff-nodeOffset.width > tableOffset.width - webix.env.scrollSize);\n\t\t\t}\n\t\t\tif (!node || isHidden)\n\t\t\t\tthis.$dialog.show({x:-9999, y:-9999});\n\t\t\telse \n\t\t\t\tthis.$dialog.show(node);\n\t\t}\n\t}\n\tgetConditions(name){\n\t\tconst locale = webix.i18n.filter;\n\t\tconst conditions = flt.getConditions(name);\n\n\t\tfor (let i=0; i<conditions.length; i++)\n\t\t\tif (conditions[i].id)\n\t\t\t\tconditions[i].value = locale[conditions[i].id];\n\n\t\treturn conditions;\n\t}\n}","import {Dialog} from \"./common\";\nimport {getFormat} from \"../operations/styles\";\nimport * as fmt from \"../operations/formats\";\nimport group from \"../operations/undo_group\";\n\nexport const action = \"custom\";\n\nexport class DialogBox extends Dialog{\n\t$show(){\n\t\tthis.form = this.$dialog.$$(\"form\");\n\t\tthis.list = this.$dialog.$$(\"list\");\n\t\tthis.preview = this.$dialog.$$(\"preview\");\n\n\t\tthis.cell = this.view.getSelectedId(true);\n\t\tif (!this.cell.length)\n\t\t\treturn false;\n\n\t\tthis.fillForm(this.view);\n\n\t\tthis.view.$handleSelection = function(){\n\t\t\treturn false;\n\t\t};\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\tconst i18n = webix.i18n.spreadsheet;\n\t\tconst labelsLocale = i18n.labels;\n\t\tconst formatsLocale = i18n.formats;\n\n\t\tconst docsLink = \"https://webix-guides.gitbook.io/spreadsheet-user-guide/formatting_numbers#custom-number-format\";\n\t\tconst delimiters = fmt.getDelimiters(\"int\");\n\n\t\tconst commonConfig = [\n\t\t\t{\n\t\t\t\tname:\"zeros\",\n\t\t\t\tview:\"counter\",\n\t\t\t\tcss:\"webix_ssheet_counter\",\n\t\t\t\tlabel:labelsLocale[\"decimal-places\"],\n\t\t\t\tvalue:0,\n\t\t\t\tbatch:\"common\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"separator\",\n\t\t\t\tview:\"checkbox\",\n\t\t\t\tlabel:labelsLocale[\"separator\"],\n\t\t\t\tbatch:\"common\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"richselect\",\n\t\t\t\tname:\"symbol\",\n\t\t\t\tlabel:labelsLocale[\"currency-symbol\"],\n\t\t\t\toptions:fmt.currencies,\n\t\t\t\tbatch:\"common\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"formlist\",\n\t\t\t\tlabel:labelsLocale[\"negative\"],\n\t\t\t\theight: 160,\n\t\t\t\tname:\"negative\",\n\t\t\t\tbatch:\"common\",\n\t\t\t\tcss:\"webix_ssheet_format_negative\",\n\t\t\t\ttemplate: obj => {\n\t\t\t\t\tif(this.list){\n\t\t\t\t\t\tlet format = this.getFormat(obj.id);\n\t\t\t\t\t\tformat = fmt.format2code(format.fmt, format.delimiters);\n\t\t\t\t\t\tconst style = {css:\"\"};\n\t\t\t\t\t\tconst value = format(-1234.56789, style);\n\n\t\t\t\t\t\treturn \"<span class='\"+style.css+\"'>\"+value+\"</span>\";\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tdata:[{id:1}, {id:2}, {id:3}, {id:4}]\n\t\t\t}\n\t\t];\n\n\t\tconst customConfig = [\n\t\t\t{\n\t\t\t\tview:\"text\",\n\t\t\t\tlabel: labelsLocale[\"format-pattern\"],\n\t\t\t\tname:\"format\",\n\t\t\t\tlabelPosition:\"top\",\n\t\t\t\tbatch:\"custom\",\n\t\t\t\tplaceholder:\"[>100]0\"+delimiters.groupSign+\"000\"+delimiters.decimalSign+\"00;[>0]None\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: \"docs\",\n\t\t\t\ttemplate: \"<a href='\"+docsLink+\"' target='_blank' class = 'docs'>\"+labelsLocale[\"format-docs\"]+\"</a>\",\n\t\t\t\tborderless:true,\n\t\t\t\tbatch:\"custom\"\n\t\t\t}\n\t\t];\n\n\t\tconst dateConfig = [\n\t\t\t{\n\t\t\t\tname:\"date\",\n\t\t\t\tbatch:\"date\",\n\t\t\t\tview:\"formlist\",\n\t\t\t\tlabelWidth: 90,\n\t\t\t\theight: 160,\n\t\t\t\tlabel:labelsLocale[\"date-format\"],\n\t\t\t\tcss:\"webix_ssheet_format_date\",\n\t\t\t\ttemplate: obj => fmt.format2code(obj.value, delimiters)(45000),\n\t\t\t\tdata:[\n\t\t\t\t\tformatsLocale.dateFormat,\n\t\t\t\t\tformatsLocale.timeFormat,\n\t\t\t\t\tformatsLocale.fullDateFormat,\n\t\t\t\t\tformatsLocale.longDateFormat\n\t\t\t\t]\n\t\t\t}\n\t\t];\n\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\twidth:460,\n\t\t\thead: labelsLocale[\"format-title\"],\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tpadding:0,\n\t\t\t\tcols:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"list\",\n\t\t\t\t\t\tid:\"list\",\n\t\t\t\t\t\tcss:\"webix_ssheet_format_type\",\n\t\t\t\t\t\twidth:120,\n\t\t\t\t\t\tscroll:false,\n\t\t\t\t\t\tdata:this.getFormats(),\n\t\t\t\t\t\tselect:true,\n\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\tonSelectChange: (id)=>{\n\t\t\t\t\t\t\t\tthis.updateForm();\n\t\t\t\t\t\t\t\tswitch(id[0]){\n\t\t\t\t\t\t\t\t\tcase \"custom\":\n\t\t\t\t\t\t\t\t\tcase \"date\":\n\t\t\t\t\t\t\t\t\t\tthis.form.showBatch(id[0]);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tdefault:{\n\t\t\t\t\t\t\t\t\t\tconst elements = this.form.elements;\n\t\t\t\t\t\t\t\t\t\tthis.form.showBatch(\"common\");\n\n\t\t\t\t\t\t\t\t\t\telements.separator[ id[0] == \"percent\" ? \"hide\" : \"show\" ]();\n\t\t\t\t\t\t\t\t\t\telements.symbol[ id[0] == \"price\" ? \"show\" : \"hide\" ]();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"form\",\n\t\t\t\t\t\tid:\"form\",\n\t\t\t\t\t\theight:340,\n\t\t\t\t\t\tpaddingY:0,\n\t\t\t\t\t\tpaddingX:20,\n\t\t\t\t\t\telements:[\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid: \"preview\",\n\t\t\t\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\t\t\t\tif(obj.value == i18n.table[\"format-error\"])\n\t\t\t\t\t\t\t\t\t\treturn obj.value;\n\t\t\t\t\t\t\t\t\treturn \"<span class ='\"+obj.css+\"'>\"+obj.value+\"</span>\";\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tcss: \"webix_ssheet_format_preview\",\n\t\t\t\t\t\t\t\tautoheight: true,\n\t\t\t\t\t\t\t\tborderless:true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t].concat(commonConfig, customConfig, dateConfig),\n\t\t\t\t\t\telementsConfig: {\n\t\t\t\t\t\t\tlabelWidth: 140\n\t\t\t\t\t\t},\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonChange: () => this.updateForm()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.closeWin()\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tlet type = this.list.getSelectedId();\n\t\tlet values = (type == \"custom\")?{format:this.form.getValues().format}:this.form.getValues();\n\t\tvalues.type = type;\n\n\t\tgroup.set(()=>{\n\t\t\tfor (let i = 0; i < this.cell.length; i++)\n\t\t\t\tfmt.addFormat(this.view, this.cell[i].row, this.cell[i].column, values.format, values);\n\t\t});\n\n\t\tthis.view.$$(\"cells\").refresh();\n\t\tthis.closeWin();\n\t}\n\tcloseWin(){\n\t\tconst format = getFormat(this.view, this.cell[0].row, this.cell[0].column);\n\t\tconst name = format || \"common\";\n\n\t\t//default format\n\t\tif(!fmt.isCustom(name))\n\t\t\tthis.view.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"format\", value:name}]);\n\t\tthis.close();\n\t}\n\tgetFormat(negative){\n\t\tconst type = this.list.getSelectedId();\n\t\tlet values = this.form.getValues();\n\n\t\tvalues.negative = negative || values.negative;\n\t\tif(type != \"custom\"){\n\t\t\tif(type != \"date\")\n\t\t\t\tvalues.date = \"\";\n\n\t\t\tvalues = fmt.formToValues(type, values);\n\t\t\treturn {\n\t\t\t\tfmt: fmt.serializeFormat(values),\n\t\t\t\tdelimiters:fmt.getDelimiters(type)\n\t\t\t};\n\t\t}\n\t\telse\n\t\t\treturn {\n\t\t\t\tfmt: values.format,\n\t\t\t\tdelimiters: fmt.getDelimiters(type)\n\t\t\t};\n\t}\n\tfillForm(view){\n\t\tconst locale = webix.i18n.spreadsheet;\n\t\tconst format = getFormat(view, this.cell[0].row, this.cell[0].column);\n\t\tlet values = { zeros:0, separator: 0, negative: 1, date: locale.formats.dateFormat, symbol:fmt.currencies[0].value, format: \"\"};\n\t\tlet type;\n\n\t\tlet name = format || \"\";\n\n\t\tvalues.format = fmt.getFormatSource(name || \"price\");\n\n\t\tif(!name)\n\t\t\ttype = name = \"price\";\n\t\telse if(name == \"string\")\n\t\t\ttype = name = \"custom\";\n\t\telse\n\t\t\ttype = fmt.formatHelpers[name].values.type;\n\n\t\tif(type != \"custom\")\n\t\t\twebix.extend(values, fmt.formatHelpers[name].values, true);\n\n\t\tconst item = this.view.$$(\"cells\").getItem(this.cell[0].row);\n\t\tconst col = this.cell[0].column;\n\n\t\tthis.value = webix.isUndefined(item[col]) ? \"\" : item[col];\n\n\t\tthis.form.setValues(values);\n\t\tthis.list.select(type);\n\t\tthis.updateForm();\n\t}\n\tupdateForm(){\n\t\tconst form = this.form.elements;\n\t\tconst format = this.getFormat();\n\t\tlet value = this.value;\n\n\t\tconst isText = value === \"\" || isNaN(value);\n\n\t\tif(fmt.checkFormat(format, \"date\") && (isText || fmt.isDateInvalid(value)))\n\t\t\tvalue = 45000;\n\t\telse if(isText && !fmt.checkFormat(format, \"string\"))\n\t\t\tvalue = 1234.56789;\n\n\t\tlet style = {css:\"\"};\n\t\tvalue = fmt.format2code(format.fmt, format.delimiters)(value, style);\n\n\t\t//preview values\n\t\tthis.preview.parse({value:value, css:style.css});\n\t\tform.negative.refresh();\n\t\tform.date.refresh();\n\n\t\t//set new format string\n\t\tform.format.setValue(format.fmt);\n\t}\n\tgetFormats(){\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\treturn [\n\t\t\t{id: \"price\", value: locale.currency},\n\t\t\t{id: \"int\", value: locale.number},\n\t\t\t{id: \"percent\", value: locale.percent},\n\t\t\t{id: \"date\", value: locale.date},\n\t\t\t{id: \"custom\", value: locale[\"custom-format\"]}\n\t\t];\n\t}\n}","import {Dialog} from \"./common\";\nimport {getJsDateFromExcel, getExcelDateFromJs} from \"../mathematics/methods\";\nimport {isDateInvalid} from \"../operations/formats\";\nimport {getDateEditFormat} from \"../operations/formats\";\nimport {getType} from \"../operations/types\";\n\nexport const action = \"conditional-format\";\n\nfunction getConditionStyle(data){\n\treturn data.map(item => {\n\t\titem.id = item.css;\n\t\treturn item;\n\t});\n}\n\nexport class DialogBox extends Dialog{\n\t_rulesToArr(){\n\t\tconst conditions = this.view.conditions.handlers;\n\t\treturn [\n\t\t\t{\n\t\t\t\tvalue: webix.i18n.spreadsheet.labels[\"common\"],\n\t\t\t\tdisabled:true,\n\t\t\t\t$css:\"webix_ssheet_cformats_type\"\n\t\t\t},\n\t\t\t...conditions.date, //number rules equal to date\n\t\t\t{\n\t\t\t\tvalue: webix.i18n.spreadsheet.labels[\"text\"],\n\t\t\t\tdisabled:true,\n\t\t\t\t$css:\"webix_ssheet_cformats_type\"\n\t\t\t},\n\t\t\t...conditions.text\n\t\t].map(rule => {\n\t\t\tif(!rule.value)\n\t\t\t\trule.value = webix.i18n.filter[ rule.id ];\n\t\t\treturn rule;\n\t\t});\n\t}\n\t_getCondition() {\n\t\tlet view = this.view;\n\t\tlet forms = this.$dialog.getBody().getChildViews()[0].getChildViews();\n\t\tlet data = [];\n\n\t\tforms.forEach(form => {\n\t\t\tif (!form.getValues) return;\n\t\t\tlet values = form.getValues();\n\t\t\tlet item = [];\n\t\t\titem.push(values.condition);\n\n\t\t\tif(values.condition != \"between\" && values.condition != \"notBetween\")\n\t\t\t\titem.push(this._normalizeValue(values.value, values.condition));\n\t\t\telse\n\t\t\t\titem.push([\n\t\t\t\t\tthis._normalizeValue(values.value, values.condition),\n\t\t\t\t\tthis._normalizeValue(values.value2, values.condition)\n\t\t\t\t]);\n\n\t\t\titem.push(values.style);\n\t\t\tfor(let i=0; i < item.length; i++){\n\t\t\t\tif(item[i] === \"\" || (webix.isArray(item[i]) && item[i].indexOf(\"\") != -1))\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\tdata.push(item);\n\t\t});\n\n\t\tview.callEvent(\"onConditionSet\", [data]);\n\t}\n\t_safeInt(a){\n\t\tconst num = parseFloat(a);\n\t\tif (num == a) return num;\n\t\treturn a;\n\t}\n\t_setCondition() {\n\t\tconst view = this.view;\n\t\tconst collection = view.conditions.get(this.cell.row, this.cell.column);\n\n\t\tif(collection){\n\t\t\tlet forms = this.$dialog.getBody().getChildViews()[0].getChildViews();\n\t\t\tcollection.forEach((item, i) => {\n\t\t\t\tconst values = {};\n\t\t\t\tvalues.condition = item[0];\n\t\t\t\tif(webix.isArray(item[1])){\n\t\t\t\t\tvalues.value = this._formatValue(item[1][0], values.condition);\n\t\t\t\t\tvalues.value2 = this._formatValue(item[1][1], values.condition);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tvalues.value = this._formatValue(item[1], values.condition);\n\n\t\t\t\tvalues.style = item[2];\n\t\t\t\tforms[i+1].setValues(values);\n\t\t\t});\n\t\t}\n\t}\n\n\t_formatValue(value, condition){\n\t\tif(!(condition && this._isNotDateRule(condition))){\n\t\t\tif(this.editFormat && value !== \"\" && value[0] != \"=\"){\n\t\t\t\tvalue = getJsDateFromExcel(value);\n\t\t\t\treturn this.editFormat(value);\n\t\t\t}\n\t\t}\n\t\treturn value.toString();\n\t}\n\n\t_normalizeValue(value, condition){\n\t\tif(!this._isNotDateRule(condition)){\n\t\t\tif(this.editFormat){\n\t\t\t\tif(isNaN(value)){\n\t\t\t\t\tif(value[0] != \"=\"){\n\t\t\t\t\t\tconst parser = webix.Date.strToDate( webix.i18n.spreadsheet.formats.parseDateTime );\n\t\t\t\t\t\tvalue = parser(value);\n\t\t\t\t\t\tvalue = isNaN(value) ? \"\" : getExcelDateFromJs(value);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tvalue = isDateInvalid(value) ? \"\" : value;\n\t\t\t}\n\t\t\telse\n\t\t\t\tvalue = this._safeInt(value, 10);\n\t\t}\n\t\treturn value;\n\t}\n\n\t_clean() {\n\t\tlet forms = this.$dialog.getBody().getChildViews()[0].getChildViews();\n\t\tforms.forEach(form => {\n\t\t\tif (form.setValues) form.setValues({condition: \"\", value: \"\", value2: \"\", style: \"\"});\n\t\t});\n\t}\n\n\t_isNotDateRule(condition){\n\t\tif(condition == \"equal\" || condition == \"notEqual\")\n\t\t\treturn false;\n\t\treturn this.view.conditions.handlers.text.find(obj => obj.id == condition);\n\t}\n\n\tokClick(){\n\t\tthis._getCondition();\n\t\tthis.close();\n\t}\n\n\t$show(){\n\t\tthis.cell = this.view.getSelectedId();\n\t\tif(!this.cell)\n\t\t\treturn false;\n\n\t\tconst type = getType(this.view, this.cell.row, this.cell.column);\n\n\t\tif(type == \"date\")\n\t\t\tthis.editFormat = getDateEditFormat(this.view, this.cell.row, this.cell.column);\n\n\t\tthis.$dialog.queryView(\"text\", \"all\").forEach(view => {\n\t\t\tview.define({placeholder: type == \"date\" ? this._formatValue(45000) : \"\"});\n\t\t\tview.refresh();\n\t\t});\n\n\t\tthis.view.$handleSelection = (st, end, a, b)=>{\n\t\t\tif (this.activeValue && a == b){\n\t\t\t\tthis.activeValue.setValue(\"=\"+a);\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t\tthis._setCondition();\n\t}\n\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t\tdelete this.editFormat;\n\t\tthis._clean();\n\t}\n\n\tgetRows(data, count){\n\t\tconst dialog = this;\n\t\tlet headers = {\n\t\t\theight: 36,\n\t\t\tpadding:{\n\t\t\t\tleft: 12\n\t\t\t},\n\t\t\tcols: [\n\t\t\t\t{ view:\"label\", width:131, label: webix.i18n.spreadsheet.labels.display },\n\t\t\t\t{ view:\"label\", width: 161, label: webix.i18n.spreadsheet.labels.condition },\n\t\t\t\t{ view:\"label\", label: webix.i18n.spreadsheet.labels.value }\n\t\t\t]\n\t\t};\n\t\tlet arr = [headers];\n\n\t\tlet item = {\n\t\t\tview: \"form\",\n\t\t\tpadding: 0,\n\t\t\tborderless: true,\n\t\t\tcss:\"webix_ssheet_cformats\",\n\t\t\telements: [{\n\t\t\t\tmargin: 10,\n\t\t\t\tcols: [\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"richselect\",\n\t\t\t\t\t\tname: \"style\",\n\t\t\t\t\t\twidth:120,\n\t\t\t\t\t\tplaceholder: webix.i18n.spreadsheet.labels[\"conditional-style\"],\n\t\t\t\t\t\tcss: \"webix_ssheet_cformat_select\",\n\t\t\t\t\t\tsuggest: {\n\t\t\t\t\t\t\tpadding:0,\n\t\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\t\tcss: \"webix_ssheet_cformat_list\",\n\t\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\t\ttemplate(obj) {\n\t\t\t\t\t\t\t\t\tconst css = \"webix_ssheet_cformat \"+obj.css;\n\t\t\t\t\t\t\t\t\treturn `<div class=\"${css}\">${obj.name}</div>`;\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"richselect\",\n\t\t\t\t\t\twidth: 150,\n\t\t\t\t\t\tname: \"condition\",\n\t\t\t\t\t\tplaceholder: webix.i18n.spreadsheet.labels[\"conditional-operator\"],\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonChange: function(newv) {\n\t\t\t\t\t\t\t\tconst elements = this.getFormView().elements;\n\n\t\t\t\t\t\t\t\tif(dialog.editFormat){\n\t\t\t\t\t\t\t\t\tif(dialog._isNotDateRule(newv))\n\t\t\t\t\t\t\t\t\t\telements.value.define({placeholder: \"\"});\n\t\t\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\t\t\tconst value = dialog._normalizeValue(elements.value.getValue(), newv);\n\t\t\t\t\t\t\t\t\t\telements.value.setValue(dialog._formatValue(value, newv));\n\t\t\t\t\t\t\t\t\t\telements.value.define({placeholder: dialog._formatValue(45000)});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telements.value.refresh();\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif(newv == \"between\" || newv == \"notBetween\")\n\t\t\t\t\t\t\t\t\telements.value2.show();\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\telements.value2.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsuggest:{\n\t\t\t\t\t\t\tview: \"ssheet-form-suggest\",\n\t\t\t\t\t\t\tbody:{\n\t\t\t\t\t\t\t\tdata: this._rulesToArr()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonFocus: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tthis.activeValue = current_view;\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tonBlur: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tlet value = current_view.getValue();\n\t\t\t\t\t\t\t\t\t\tif(value !== \"\"){\n\t\t\t\t\t\t\t\t\t\t\tconst elements = current_view.getFormView().elements;\n\t\t\t\t\t\t\t\t\t\t\tconst condition = elements.condition.getValue();\n\t\t\t\t\t\t\t\t\t\t\tvalue = this._normalizeValue(value, condition);\n\t\t\t\t\t\t\t\t\t\t\tcurrent_view.setValue(this._formatValue(value, condition));\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tname: \"value\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\t\tname: \"value2\",\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonFocus: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tthis.activeValue = current_view;\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tonBlur: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tlet value = current_view.getValue();\n\t\t\t\t\t\t\t\t\t\tif(value !== \"\"){\n\t\t\t\t\t\t\t\t\t\t\tconst elements = current_view.getFormView().elements;\n\t\t\t\t\t\t\t\t\t\t\tconst condition = elements.condition.getValue();\n\t\t\t\t\t\t\t\t\t\t\tvalue = this._normalizeValue(value, condition);\n\t\t\t\t\t\t\t\t\t\t\tcurrent_view.setValue(this._formatValue(value, condition));\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\thidden: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\t{ view:\"icon\", css:\"webix_ssheet_cformat_clear\", icon:\"wxi-trash\", click: function(){\n\t\t\t\t\t\tconst form = this.getFormView();\n\t\t\t\t\t\tform.clear();\n\t\t\t\t\t}}\n\t\t\t\t]}\n\t\t\t]};\n\n\t\twhile(count--){\n\t\t\tarr.push(item);\n\t\t}\n\t\treturn arr;\n\t}\n\n\t$init(){\n\t\tconst margin = webix.skin.$active.layoutMargin.form;\n\t\t//[IMPROVE] can be optimized by using datalayout instead of nested forms\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"conditional-format\"],\n\t\t\tposition:\"center\",\n\t\t\twidth: 770,\n\t\t\tmove: true,\n\t\t\tmargin,\n\t\t\tbody:{\n\t\t\t\tview: \"form\",\n\t\t\t\tpadding:0,\n\t\t\t\tborderless: true,\n\t\t\t\trows: this.getRows(getConditionStyle(this.view.config.conditionStyle), 3)\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}","import {Dialog} from \"./common\";\n\nexport const action = \"excel-export\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.view.$handleSelection = function(){\n\t\t\treturn false;\n\t\t};\n\n\t\tform.elements.sheets.setValue(this.getSheets());\n\t\tform.elements.filename.setValue(\"Data\");\n\t\tform.elements.filename.getInputNode().select();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"export-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"filename\",  placeholder:webix.i18n.spreadsheet.labels[\"export-name\"]},\n\t\t\t\t\t{ view:\"multicheckbox\", name:\"sheets\"}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tgetSheets(){\n\t\tconst view = this.view;\n\t\tconst sheets = view._sheets;\n\t\tlet value = [];\n\n\t\tfor(let i = 0; i < sheets.length; i++)\n\t\t\tvalue.push({\n\t\t\t\tname: sheets[i].name,\n\t\t\t\tactive: view._activeSheet === sheets[i].name ? 1 : 0\n\t\t\t});\n\n\t\treturn value;\n\t}\n\tokClick(){\n\t\tconst values = this.$dialog.getBody().getValues();\n\t\twebix.toExcel(this.view, values);\n\t\tthis.close();\n\t}\n}","import {Dialog} from \"./common\";\n\nexport const action = \"add-link\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tconst cell = this.view.getSelectedId();\n\t\tif(!cell)\n\t\t\treturn false;\n\t\tif (!this.restoreValue(form))\n\t\t\tform.clear();\n\t\tform.elements.name.focus();\n\t}\n\trestoreValue(form){\n\t\tconst cell = this.view.getSelectedId();\n\t\tif (cell){\n\t\t\tconst value = this.view.getCellValue(cell.row, cell.column);\n\t\t\tif (value && typeof value == \"string\" && value.indexOf(\"=HYPERLINK\") === 0){\n\t\t\t\tconst parts = value.split(\"\\\"\");\n\t\t\t\tform.setValues({\n\t\t\t\t\tname: (parts[3] || \"\"),\n\t\t\t\t\turl: (parts[1] || \"\")\n\t\t\t\t});\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"link-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"name\",  placeholder:webix.i18n.spreadsheet.labels[\"link-name\"]},\n\t\t\t\t\t{ view:\"text\", name:\"url\",  placeholder:webix.i18n.spreadsheet.labels[\"link-url\"]}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\n\tokClick(){\n\t\tconst cell = this.view.getSelectedId();\n\t\tconst data = this.$dialog.getBody().getValues();\n\n\t\tlet text = \"\";\n\t\tif (data.url){\n\t\t\tdata.name = data.name || data.url;\n\t\t\tif (!/^https?:\\/\\//i.test(data.url))\n\t\t\t\tdata.url = \"http://\" + data.url;\n\t\t\ttext = `=HYPERLINK(\"${data.url}\",\"${data.name}\")`;\n\t\t}\n\n\t\tthis.view.setCellValue(cell.row, cell.column, text);\n\t\tthis.view.refresh();\n\t\tthis.close();\n\t}\n}","import {Dialog} from \"./common\";\n\nexport const action = \"print\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tform.setValues({\n\t\t\tdata:\"current\",\n\t\t\tpaper:\"A4\",\n\t\t\tfit:\"page\",\n\t\t\tmode:\"landscape\",\n\t\t\tsheetnames:1,\n\t\t\tmargin:0\n\t\t});\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"print-title\"],\n\t\t\tmove: true,\n\t\t\tmodal:true,\n\t\t\twidth:530, height:520,\n\t\t\tposition: \"center\",\n\t\t\tbuttons:false,\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ type:\"section\", template: webix.i18n.spreadsheet.labels[\"print-settings\"]},\n\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t{ view:\"radio\", name:\"data\",vertical:true, options:[\n\t\t\t\t\t\t\t{ id:\"current\", value:webix.i18n.spreadsheet.labels[\"current-sheet\"]},\n\t\t\t\t\t\t\t{ id:\"all\", value:webix.i18n.spreadsheet.labels[\"all-sheets\"]},\n\t\t\t\t\t\t\t{ id:\"selection\", value:webix.i18n.spreadsheet.labels[\"selection\"]}\n\t\t\t\t\t\t], on:{\n\t\t\t\t\t\t\tonChange:function(newv){\n\t\t\t\t\t\t\t\tif(newv == \"all\"){\n\t\t\t\t\t\t\t\t\tconst form = this.getFormView();\n\t\t\t\t\t\t\t\t\tform.elements.sheetnames.setValue(1);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}},\n\t\t\t\t\t\t{ rows:[\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"sheetnames\", labelRight:webix.i18n.spreadsheet.labels[\"sheet-names\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"borderless\", labelRight:webix.i18n.spreadsheet.labels[\"borderless\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"skiprows\", labelRight:webix.i18n.spreadsheet.labels[\"skip-rows\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"margin\", labelRight:webix.i18n.spreadsheet.labels[\"margin\"]}\n\t\t\t\t\t\t]}\n\t\t\t\t\t]},\n\t\t\t\t\t{ type:\"section\", template: webix.i18n.spreadsheet.labels[\"print-paper\"]},\n\t\t\t\t\t{ view:\"radio\", name:\"paper\", options:[\n\t\t\t\t\t\t{ id:\"letter\", value:webix.i18n.spreadsheet.labels[\"page-letter\"]},\n\t\t\t\t\t\t{ id:\"A4\", value:webix.i18n.spreadsheet.labels[\"page-a4\"]},\n\t\t\t\t\t\t{ id:\"A3\", value:webix.i18n.spreadsheet.labels[\"page-a3\"]}\n\t\t\t\t\t]},\n\t\t\t\t\t{ type:\"section\", template: webix.i18n.spreadsheet.labels[\"print-layout\"]},\n\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t{view:\"radio\", name:\"fit\", options:[\n\t\t\t\t\t\t\t{ id:\"page\", value:webix.i18n.spreadsheet.labels[\"page-width\"]},\n\t\t\t\t\t\t\t{ id:\"data\", value:webix.i18n.spreadsheet.labels[\"page-actual\"]}\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{ width:25},\n\t\t\t\t\t\t{ view:\"radio\", width:220, name:\"mode\", options:[\n\t\t\t\t\t\t\t{ id:\"portrait\", value:webix.i18n.spreadsheet.labels[\"page-portrait\"]},\n\t\t\t\t\t\t\t{ id:\"landscape\", value:webix.i18n.spreadsheet.labels[\"page-landscape\"]}\n\t\t\t\t\t\t]}\n\t\t\t\t\t]},\n\t\t\t\t\t{\n\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t{ },\n\t\t\t\t\t\t\t{ view: \"button\", css:\"ssheet_cancel_button\", hotkey:\"esc\",\n\t\t\t\t\t\t\t\tvalue: webix.i18n.spreadsheet.labels.cancel, autowidth:true,\n\t\t\t\t\t\t\t\tclick: () => this.close()\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{ view: \"button\", value: webix.i18n.spreadsheet.labels.print, hotkey:\"enter\", autowidth:true,\n\t\t\t\t\t\t\t\tclick: () => this.okClick()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tconst data = this.$dialog.getBody().getValues();\n\t\tdata.margin = data.margin?0:{};\n\t\tthis.close();\n\t\twebix.print(this.view, data);\n\t}\n}\n","import {Dialog} from \"./common\";\n\nexport const action = \"add-comment\";\n\nexport class DialogBox extends Dialog{\n\topen(action){\n\t\t//we get cell only on hover commented cell\n\t\tthis.cell = action.cell ? action.cell : this.view.getSelectedId();\n\n\t\t// cell not provided\n\t\tif (!this.cell || \n\t\t\t// cell is locked and in the edit mode\n\t\t\t(this.view.isCellLocked(this.cell.row, this.cell.column) && !action.viewonly) ||\n\t\t\t// action blocked by user's code\n\t\t\t!(this.view.callEvent(\"onBeforeCommentShow\", [this.cell.row, this.cell.column, !action.viewonly]))){\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.view.comments._activeComment = {editStatus: !action.viewonly, cell: this.cell};\n\n\t\tif(!this.$dialog){\n\t\t\tthis.$dialog = webix.ui(this.$init());\n\t\t\tthis.view._destroy_with_me.push(this.$dialog);\n\t\t\tthis.view.comments.commentsView = this.$dialog;\n\t\t\tthis.$dialog.attachEvent(\"onHide\", ()=>this.$hide());\n\t\t\tthis.view.attachEvent(\"onCommentHide\", ()=>this.$dialog.hide());\n\t\t}\n\n\t\tconst form = this.$dialog.getBody();\n\n\t\tconst span = this.view.$$(\"cells\").getSpan(this.cell.row, this.cell.column);\n\t\tconst item = span ? {row: this.cell.row, column:(span[1]*1+span[2]-1)} : this.cell;\n\n\t\twebix.delay(()=>{\n\t\t\tthis.$dialog.show(this.view.$$(\"cells\").getItemNode(item));\n\t\t\tthis._setComment();\n\t\t});\n\t\tif (this.$show(this.$dialog, form) === false)\n\t\t\tthis.close();\n\t}\n\t$show(){\n\t\tthis.textarea = this.$dialog.queryView({view:\"textarea\"});\n\t\tthis.template = this.$dialog.queryView({view:\"template\"});\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tcss:\"ssheet_comments\",\n\t\t\tminWidth:250,\n\t\t\tminHeight:150,\n\t\t\trelative:\"right\",\n\t\t\tresize:true,\n\t\t\ton:{\n\t\t\t\tonViewResize:()=>{\n\t\t\t\t\tthis.$dialog.hide();\n\t\t\t\t\tthis.$dialog.show();\n\t\t\t\t\tif(this.textarea.isVisible())\n\t\t\t\t\t\tthis.textarea.focus();\n\t\t\t\t}\n\t\t\t},\n\t\t\tbody:{\n\t\t\t\tanimate:false,\n\t\t\t\tcells:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"template\",\n\t\t\t\t\t\tcss:\"ssheet_comment_view\",\n\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\tscroll:\"auto\",\n\t\t\t\t\t\tonClick:{\n\t\t\t\t\t\t\t\"ssheet_comment_view\":() => {\n\t\t\t\t\t\t\t\tif(!(this.view.config.readonly || this.view.isCellLocked(this.cell.row, this.cell.column)))\n\t\t\t\t\t\t\t\t\tthis.showInput(this.view.comments.get(this.cell.row, this.cell.column));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"textarea\",\n\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\tonChange:()=>{\n\t\t\t\t\t\t\t\tthis.addComment();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonFocus:()=>{\n\t\t\t\t\t\t\t\tthis.view.comments._activeComment = {editStatus: true, cell: this.cell};\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonBlur:()=>{\n\t\t\t\t\t\t\t\tthis.view.comments._activeComment = {};\n\t\t\t\t\t\t\t\tthis.$dialog.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t};\n\t}\n\t_setComment(){\n\t\tconst comment = this.view.comments.get(this.cell.row, this.cell.column);\n\t\tif(this.view.comments._activeComment.editStatus)\n\t\t\tthis.showInput(comment);\n\t\telse\n\t\t\tthis.showTemplate(comment);\n\t}\n\tshowTemplate(text){\n\t\tthis.template.show();\n\t\tthis.template.setHTML(text);\n\t}\n\tshowInput(text){\n\t\tthis.view.$$(\"cells\").select(this.cell.row, this.cell.column);\n\t\twebix.delay(()=>{\n\t\t\tthis.changeTextarea(text);\n\t\t\tthis.textarea.show();\n\t\t\tthis.textarea.focus();\n\t\t});\n\t}\n\taddComment(){\n\t\tthis.view.comments.add(this.cell.row, this.cell.column, this.textarea.getValue());\n\t}\n\tchangeTextarea(text){\n\t\tthis.textarea.blockEvent();\n\t\tthis.textarea.setValue(text||\"\");\n\t\tthis.textarea.unblockEvent();\n\t}\n}","import {Dialog} from \"./common\";\nexport const action = \"resize\";\n\nexport class DialogBox extends Dialog{\n\topen(action){\n\t\tthis.group = action.group;\n\t\tthis.header = action.value;\n\t\tDialog.prototype.open.apply(this, arguments);\n\t}\n\t$show(){\n\t\tconst sel = this.view.getSelectedId();\n\t\tif(!sel)\n\t\t\treturn false;\n\t\tthis.view.$handleSelection = ()=>{\n\t\t\treturn false;\n\t\t};\n\n\t\tconst elements = this.$dialog.getBody().elements;\n\t\tthis.type = elements[\"type\"];\n\t\tthis.size = elements[\"size\"];\n\n\t\tthis.$dialog.getHead().getChildViews()[0].setHTML(this.header);\n\t\tconst grid = this.view.$$(\"cells\");\n\n\t\tlet value;\n\t\tif(this.group == \"row\")\n\t\t\tvalue = grid.getItem(sel.row).$height || grid.config.rowHeight;\n\t\telse\n\t\t\tvalue = grid.getColumnConfig(sel.column).width || grid.config.columnWidth;\n\n\t\tthis.type.getOption(1).value = webix.i18n.spreadsheet.labels[this.group == \"row\" ? \"height\" : \"width\"];\n\t\tthis.type.setValue(1);\n\t\tthis.type.refresh();\n\n\t\tthis.size.setValue(value);\n\t\tthis.size.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\tokClick(){\n\t\tconst type = this.type.getValue();\n\n\t\tlet size = \"auto\";\n\t\tif(type == 1)\n\t\t\tsize = this.size.getValue()*1;\n\t\telse if(type == 3)\n\t\t\tsize = this.view.$$(\"cells\").config[this.group == \"row\" ? \"rowHeight\" : \"columnWidth\"];\n\n\t\tif(this.group == \"row\")\n\t\t\tthis.view.setRowHeight(null, size);\n\t\telse\n\t\t\tthis.view.setColumnWidth(null, size);\n\n\t\tthis.close();\n\t}\n\t$init(){\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\twidth: 300,\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tpadding:0,\n\t\t\t\tcols:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"radio\", name:\"type\", vertical:true, optionHeight:40,\n\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\tonChange: id => {\n\t\t\t\t\t\t\t\tif(id == 1)\n\t\t\t\t\t\t\t\t\tthis.size.enable();\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\tthis.size.disable();\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\toptions:[\n\t\t\t\t\t\t\t{id:1, value: \"\"},\n\t\t\t\t\t\t\t{id:2, value: locale[\"fit-content\"]},\n\t\t\t\t\t\t\t{id:3, value: locale[\"default-size\"]},\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\t{rows: [\n\t\t\t\t\t\t{view:\"text\", name: \"size\", width:120},\n\t\t\t\t\t]}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}","import * as imc from \"./imagecell\";\nimport * as imt from \"./imagetop\";\nimport * as asw from \"./sparkline\";\nimport * as rgs from \"./ranges\";\nimport * as dpd from \"./dropdown\";\nimport * as flt from \"./filter\";\nimport * as fmt from \"./format\";\nimport * as cnd from \"./conditional\";\nimport * as exp from \"./export\";\nimport * as lnk from \"./link\";\nimport * as pnt from \"./print\";\nimport * as cmt from \"./comments\";\nimport * as siz from \"./sizing\";\n\nconst bases = [ imt, imc, asw, rgs, dpd, flt, fmt, cnd, exp, lnk, pnt, cmt, siz ];\n\nexport function init(view){\n\tconst dialogs = {};\n\tconst viewBases = view.config.readonly ? [cmt] : bases;\n\n\tfor (let i = 0; i < viewBases.length; i++)\n\t\tdialogs[viewBases[i].action] = new viewBases[i].DialogBox(view);\n\n\tview.attachEvent(\"onCommand\", function(action){\n\t\tconst box = dialogs[action.id];\n\t\tif (box) box.open(action);\n\t});\n\n\tview.attachEvent(\"onAction\", function(id, values){\n\t\t//hide win when the external ui is removed\n\t\tif(id == \"add-view\" && !values.newValue){\n\t\t\tconst box = dialogs[\"add-image-top\"];\n\t\t\tif(box && box.viewid == values.row){\n\t\t\t\tbox.close();\n\t\t\t}\n\t\t}\n\t});\n}","import {isCellLocked} from \"./lock_cell\";\nimport group from \"./undo_group\";\n\n\nvar ignoreUndoReset = false;\n\nexport function init(view){\n\treset(view);\n\tundoHandlers(view);\n\tview.attachEvent(\"onHardReset\", () => reset(view));\n\tview.attachEvent(\"onAfterSheetShow\", () => reset(view));\n\t// styles\n\tview.attachEvent(\"onBeforeStyleChange\", (row, column, nstyle, ostyle) =>{\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"style\", row:row, column: column, value: ostyle, newValue: nstyle, group: group.value});\n\t});\n\t// editing\n\tview.attachEvent(\"onBeforeValueChange\", (row, column, nvalue, ovalue) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"value\", row:row, column: column, value: ovalue, newValue: nvalue, group: group.value});\n\t});\n\t// merge cells\n\tview.attachEvent(\"onBeforeSpan\", (row, column, value) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"span\", row:row, column: column, value: value, newValue:value, group: group.value});\n\t});\n\t// split cells\n\tview.attachEvent(\"onBeforeSplit\", (row, column, value) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"split\", row:row, column: column, value: value, newValue:value, group: group.value});\n\t});\n\t// Any abstract undo actions\n\tview.attachEvent(\"onAction\", (action, obj) =>\n\t\taddToHistory(\n\t\t\tview,\n\t\t\t{\n\t\t\t\taction: action,\n\t\t\t\trow: obj.row || null,\n\t\t\t\tcolumn: obj.column || null,\n\t\t\t\tvalue: obj.value || null,\n\t\t\t\tnewValue: obj.newValue || null,\n\t\t\t\tgroup: group.value\n\t\t\t}\n\t\t)\n\t);\n\n\t// column resize\n\tview.$$(\"cells\").attachEvent(\"onColumnResize\", (column, nvalue, ovalue) =>\n\t\taddToHistory(view, {action: \"c-resize\", row:0, column:column, value: ovalue, newValue: nvalue, group: group.value})\n\t);\n\t// column hide\n\tview.attachEvent(\"onColumnOperation\", (action, start, end) => {\n\t\tif (action.id !== \"add\" && action.id !== \"del\")\n\t\t\taddToHistory(view, { action:action, row:0, column:{ start, end } });\n\t});\n\t// row hide\n\tview.attachEvent(\"onRowOperation\", (action, start, end) => {\n\t\tif (action.id !== \"add\" && action.id !== \"del\")\n\t\t\taddToHistory(view, { action:action, row:{ start, end }, column:0 });\n\t});\n\t// row resize\n\tview.$$(\"cells\").attachEvent(\"onRowResize\", (row,  nvalue, ovalue) =>\n\t\taddToHistory(view, {action: \"r-resize\", row: row, column:0, value: ovalue, newValue: nvalue, group: group.value})\n\t);\n\n\t// condition formats\n\tview.attachEvent(\"onBeforeConditionSet\", (row, column, value, nvalue) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\n\t\tvalue = value ? webix.copy(value) : null;\n\t\taddToHistory(view, {action: \"condition\", row: row, column: column, value: value, newValue: nvalue, group: group.value});\n\t});\n\tview.$skipHistory = 0;\n}\n\nexport function undo(view){\n\trestoreHistory(view,-1);\n}\n\nexport function redo(view){\n\trestoreHistory(view,1);\n}\n\nexport function reset(view){\n\tif(!ignoreUndoReset){\n\t\tview._ssUndoHistory = [];\n\t\tview._ssUndoCursor = -1;\n\t}\n}\n\nfunction addToHistory(view, data){\n\tif(!view.$skipHistory && !view._loading_data){\n\t\t// remove futher history\n\t\tview._ssUndoHistory.splice(view._ssUndoCursor+1);\n\t\t// add to an array and increase cursor\n\t\tview._ssUndoHistory.push(data);\n\t\tview._ssUndoCursor++;\n\t}\n}\n\nexport function ignoreUndo(func, view){\n\tview.$skipHistory++;\n\ttry{\n\t\tfunc.call(view);\n\t}\n\tfinally {\n\t\tview.$skipHistory--;\n\t}\n}\n\nexport function ignoreReset(func){\n\tignoreUndoReset = true;\n\tfunc();\n\tignoreUndoReset = false;\n}\n\nfunction restoreHistory(view, step){\n\tvar data = view._ssUndoHistory[step>0?(view._ssUndoCursor+step):view._ssUndoCursor];\n\tif(data){\n\t\tvar value = step > 0 ? data.newValue : data.value;\n\t\tvar direction = step>0;\n\t\tvar params = [data.action, data.row, data.column, value, direction];\n\n\t\tview._ssUndoCursor += step;\n\n\t\t// group support\n\t\tvar group = data.group;\n\t\tvar prevData = view._ssUndoHistory[step>0?(view._ssUndoCursor+step):view._ssUndoCursor];\n\n\t\tignoreUndo(function(){\n\t\t\tview.callEvent(\"onUndo\", params);\n\t\t\tif (!group || !(prevData && group == prevData.group)){\n\t\t\t\tview.refresh();\n\t\t\t\tview.callEvent(\"onAfterUndo\", []);\n\t\t\t}\n\t\t},view);\n\n\t\tif(prevData && group && group == prevData.group){\n\t\t\trestoreHistory(view, step);\n\t\t}\n\t}\n}\n\nfunction undoHandlers(view){\n\tview.attachEvent(\"onUndo\", function(type, row, column, value) {\n\t\tswitch (type) {\n\t\t\tcase \"freeze-row\":\n\t\t\t\tview.freezeRows(value);\n\t\t\t\tbreak;\n\t\t\tcase \"freeze-column\":\n\t\t\t\tview.freezeColumns(value);\n\t\t\t\tbreak;\n\t\t}\n\t});\n}","import {range, toRange, changeRange, encode, isRange} from \"../helpers/column_names\";\nimport {ignoreUndo} from \"./undo\";\n\nexport function init(view){\n\tconst grid = view._table.$view.querySelector(\".webix_ss_center\");\n\n\tview.views = {\n\t\tregister:function(type, render, track){\n\t\t\tif(!this._types[type])\n\t\t\t\tthis._types[type] = { render:render, track:track };\n\t\t},\n\t\tmove: function(id, x, y){\n\t\t\tconst win = webix.$$(id);\n\t\t\tconst old = webix.copy(this._pull[id]);\n\t\t\tthis._pull[id].x = _correctPos(view, win, x, \"x\");\n\t\t\tthis._pull[id].y = _correctPos(view, win, y, \"y\");\n\t\t\tview.callEvent(\"onAction\", [\"move-view\", { row:id, newValue:webix.copy(this._pull[id]), value:old} ]);\n\t\t\t_showOne(view, win, this._pull[id]);\n\t\t},\n\t\tadd: function(x, y, type, data, config, id){\n\t\t\tconfig = config || {};\n\t\t\tif(type == \"chart\"){\n\t\t\t\tconfig = webix.extend(config, {\n\t\t\t\t\ttype: \"line\",\n\t\t\t\t\tdataSeries:\"columns\"\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst height =  config.height || 300;\n\t\t\tconst width = config.width || 500;\n\n\t\t\tconst win = webix.ui({ \n\t\t\t\tid:id || \"$ssheet-ui\"+webix.uid(), // fixed id is for undo only\n\t\t\t\tview: \"ssheet-ui\",\n\t\t\t\tcontainer:grid, master:view._table.config.id,\n\t\t\t\twidth:width, height:height\n\t\t\t});\n\n\t\t\twin.attachEvent(\"onViewMoveEnd\", (x, y) => {\n\t\t\t\tconst state = view._table.getScrollState();\n\t\t\t\tthis.move(id, x, y+state.y);\n\t\t\t});\n\t\t\twin.attachEvent(\"onViewResize\", () => {\n\t\t\t\tconst conf =  this._pull[id];\n\t\t\t\tconst old = webix.copy(conf);\n\n\t\t\t\tconf.config.height = win.$height;\n\t\t\t\tconf.config.width = win.$width;\n\t\t\t\tview.callEvent(\"onAction\", [\"resize-view\", { row:id, newValue:webix.copy(conf), value:old } ]);\n\t\t\t});\n\t\t\twin.attachEvent(\"onViewEdit\", () => {\n\t\t\t\tconst config = this._pull[id];\n\t\t\t\tconst command = this._commands[config.type] || config.type;\n\t\t\t\tview.callEvent(\"onCommand\", [{ id:command, viewid:id, config }]);\n\t\t\t});\n\t\t\twin.attachEvent(\"onViewRemove\", () => this.remove(id));\n\n\t\t\tid = win.config.id;\n\n\t\t\tx = _correctPos(view, win, x, \"x\");\n\t\t\ty = _correctPos(view, win, y, \"y\");\n\n\t\t\tthis._pull[id] = { x, y, type, data, config };\n\t\t\tthis.update(id, data, config, true);\n\t\t\t_showOne(view, win, this._pull[id]);\n\n\t\t\treturn id; \n\t\t},\n\t\tremove: function(id){\n\t\t\tconst old = this._pull[id];\n\t\t\twebix.$$(id).close();\n\t\t\tdelete this._pull[id];\n\n\t\t\tview.callEvent(\"onAction\", [\"add-view\", { row:id, newValue:null, value:old } ]);\n\t\t},\n\t\tget:function(id){\n\t\t\treturn webix.$$(id).getBody();\n\t\t},\n\t\tgetConfig:function(id){\n\t\t\treturn this._pull[id];\n\t\t},\n\t\tupdate:function(id, data, config, inner){\n\t\t\tconst old = inner ? null : webix.copy(this._pull[id]);\n\t\t\tconst conf = this._pull[id];\n\t\t\tconst actions = this._types[conf.type];\n\n\t\t\tdata = data || config.data || \"\";\n\t\t\tconfig = config || {};\n\n\t\t\tdelete config.data;\n\n\t\t\tif(conf.type == \"chart\"){\n\t\t\t\tconst type = config.type;\n\t\t\t\tif(type && !_isPie(type) && !config.series){\n\t\t\t\t\tconst xAxis = config.xAxis && config.xAxis.range;\n\t\t\t\t\tconst legend = config.legend && config.legend.range;\n\n\t\t\t\t\tconst oldXaxis = old && old.config && old.config.xAxis && old.config.xAxis.fromData;\n\n\t\t\t\t\tconfig.series = _getSeries(view, data, config.dataSeries, {xAxis, legend}, oldXaxis);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst win = webix.$$(id);\n\n\t\t\tconst height = config.height || 300;\n\t\t\tconst width = config.width || 500;\n\n\t\t\tif(win.$width != width && win.$height != height){\n\t\t\t\twin.define({width, height});\n\t\t\t\twin.resize();\n\t\t\t}\n\n\t\t\tconf.data = data;\n\t\t\tconf.config = config;\n\n\t\t\tlet node = this.get(id);\n\n\t\t\tdata = _fromRange(view, conf);\n\n\t\t\tif(actions.render){\n\t\t\t\tconst renderConfig = webix.copy(conf);\n\n\t\t\t\t//clear width and height for inner view resizing\n\t\t\t\trenderConfig.config.width = renderConfig.config.height = 0;\n\n\t\t\t\tnode = actions.render(node, renderConfig, data);\n\t\t\t\t_processTables(node);\n\t\t\t}\n\n\t\t\tif(actions.track)\n\t\t\t\t_trackOne(view, node, actions.track, conf);\n\n\t\t\tview.callEvent(\"onAction\", [\"add-view\", { row:id, newValue:webix.copy(this._pull[id]), value:old} ]);\n\t\t},\n\t\thighlight:function(id){\n\t\t\tconst win = webix.$$(id);\n\t\t\tconst css = \"webix_ssheet_ui_focused\";\n\n\t\t\tconst oldWin = webix.$$(this._activeWin);\n\t\t\tif(oldWin && !oldWin.$destructed)\n\t\t\t\twebix.html.removeCss(oldWin.$view, css);\n\n\t\t\tif(win){\n\t\t\t\tthis._activeWin = id;\n\t\t\t\twebix.html.addCss(win.$view, css);\n\t\t\t}\n\t\t\telse\n\t\t\t\tdelete this._activeWin;\n\t\t},\n\t\t_commands:{\n\t\t\t\"image\":\"add-image-top\",\n\t\t\t\"chart\":\"add-chart\"\n\t\t},\n\t\t_types:{},\n\t\t_pull:{}\n\t};\n\n\t// handle events\n\tview._table.attachEvent(\"onResize\", () => _showAll(view) );\n\tview._table.attachEvent(\"onScrollY\", () => _showAll(view) );\n\tview._table.attachEvent(\"onScrollX\", () => _showAll(view) );\n\n\tview.attachEvent(\"onReset\", () => _reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tconst move = type === \"move-view\";\n\t\tif (move || type == \"resize-view\" || type === \"add-view\")\n\t\t\t_undoUI(view, move, row, value);\n\t});\n\tview.attachEvent(\"onAction\", (action, p) => {\n\t\tif(action == \"header-hide\")\n\t\t\t_showAll(view);\n\t\telse if(action == \"before-grid-change\")\n\t\t\t_updateData(view, p.name, p.inc, p.data, p.start);\n\t});\n\tview.attachEvent(\"onColumnOperation\", () =>  _showAll(view, true));\n\tview.attachEvent(\"onRowOperation\", () => _showAll(view, true));\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data, config) => _serialize(view, data, config));\n\tview.attachEvent(\"onCellChange\", () => _trackAll(view));\n\tview.attachEvent(\"onMathRefresh\", () => _trackAll(view));\n\n\tview.attachEvent(\"onDestruct\", () => {\n\t\tfor(let i in view.views._pull) webix.$$(i).destructor();\n\t});\n\n\tlet editUIType;\n\twebix.attachEvent(\"onClick\", function(ev){\n\t\tlet focus = webix.$$(ev);\n\t\tif(focus && focus.config.externalUI)\n\t\t\tfocus = webix.$$(focus.config.externalUI);\n\n\t\tconst ui = focus && (focus.queryView(\"ssheet-ui\",\"self\") || focus.queryView(\"ssheet-ui\",\"parent\"));\n\n\t\tif(ui){\n\t\t\tview.views.highlight(ui);\n\t\t\tconst id = ui.config.id;\n\n\t\t\tif(editUIType){\n\t\t\t\tif(view.views.getConfig(id).type == editUIType)\n\t\t\t\t\tui.callEvent(\"onViewEdit\", []); //start editing if any editor is open\n\t\t\t\telse\n\t\t\t\t\tview.callEvent(\"onCommand\", [{ id:\"close-ui-editor\" }]);\n\t\t\t}\n\t\t}\n\t\telse if(!editUIType)\n\t\t\tview.views.highlight();\n\t});\n\n\tview.attachEvent(\"onUIEditStart\", function(id, type){\n\t\tview.views.highlight(id);\n\t\teditUIType = type;\n\t});\n\n\tview.attachEvent(\"onUIEditStop\", function(id, type){\n\t\tif(editUIType == type)\n\t\t\twebix.delay(()=>{ // after onClick handler (to save focus)\n\t\t\t\teditUIType = null;\n\t\t\t});\n\t});\n\n\t// set default views\n\tview.views.register(\"chart\", (node, conf, data) => {\n\t\tconst dataRange = _getNames(view, conf);\n\t\tconst config = _genChartConfig(conf, data, dataRange);\n\t\treturn webix.ui(config, node);\n\t}, (view, data) => {\n\t\tview.clearAll();\n\t\tview.parse(data);\n\t});\n\n\tview.views.register(\"image\", (node, conf, data) => {\n\t\tconst config = webix.extend({ css:\"webix_ssheet_bgimage\", template:`<img src=\"${data}\"/>` }, conf.config||{}, true );\n\t\treturn webix.ui(config, node);\n\t});\n}\n\nfunction _parse(view, data){\n\tconst views = data.views;\n\tif(views){\n\t\tignoreUndo(function(){\n\t\t\tviews.forEach(obj => view.views.add.apply(view.views, obj));\n\t\t}, view);\n\t}\n}\n\nfunction _serialize(view, data, config){\n\tdata.views = [];\n\tfor(let i in view.views._pull){\n\t\tconst conf = view.views._pull[i];\n\t\tconst one = [conf.x, conf.y, conf.type, conf.data, conf.config];\n\t\tif(config && config.viewIds)\n\t\t\tone.push(i);\n\t\tdata.views.push(one);\n\t}\n}\n\nlet thread;\nfunction _trackAll(view){\n\tclearTimeout(thread);\n\tthread = webix.delay(() => {\n\t\tconst ui = view.views;\n\t\tfor(let id in ui._pull){\n\t\t\tconst conf = ui._pull[id];\n\n\t\t\tconst viewMethods = ui._types[conf.type];\n\t\t\tconst render = viewMethods.render;\n\t\t\tconst track = viewMethods.track;\n\n\t\t\tif(track)\n\t\t\t\t_trackOne(view, ui.get(id), track, conf, render);\n\t\t}\n\t});\n}\n\nfunction _trackOne(view, node, track, conf, render){\n\tconst data = _fromRange(view, conf);\n\n\tif(conf.type == \"chart\"){\n\t\tif(render)\n\t\t\tnode = render(node, conf, data, true);\n\n\t\tconst config = conf.config;\n\t\tif(config && !_isPie(config.type))\n\t\t\t_removeLegend(data, conf, view);\n\t}\n\n\ttrack(node, data);\n}\n\nfunction _updateData(view, name, inc, data, start){\n\tconst views = data.views;\n\tfor(let i = 0; i < views.length; i++){\n\t\tif(_isRange(views[i][3])){\n\t\t\tconst series = views[i][4].series;\n\t\t\tif(series){\n\t\t\t\tseries.forEach(obj => {\n\t\t\t\t\tobj.range = changeRange(obj.range, name, inc, start);\n\t\t\t\t\tobj.active = changeRange(obj.active, name, inc, start);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst legend = views[i][4].legend && views[i][4].legend.range;\n\t\t\tif(legend)\n\t\t\t\tviews[i][4].legend.range = _getDataParts(legend).map(range => changeRange(range, name, inc, start)).join(\",\");\n\n\t\t\tconst xAxis = views[i][4].xAxis && views[i][4].xAxis.range;\n\t\t\tif(xAxis)\n\t\t\t\tviews[i][4].xAxis.range = changeRange(xAxis, name, inc, start);\n\n\t\t\tviews[i][3] = _getDataParts(views[i][3]).map(range => changeRange(range, name, inc, start)).join(\",\");\n\t\t}\n\t}\n}\n\nfunction _showAll(view, pos){\n\t//close possibly open menus of embedded ui\n\twebix.callEvent(\"onClick\", []);\n\n\tfor(let id in view.views._pull){\n\t\tconst win = webix.$$(id);\n\t\tconst conf = view.views._pull[id];\n\t\tif(pos){\n\t\t\tconf.x = _correctPos(view, win, conf.x, \"x\");\n\t\t\tconf.y = _correctPos(view, win, conf.y, \"y\");\n\t\t}\n\t\t_showOne(view, win, conf);\n\t}\n}\n\nfunction _showOne(view, win, conf){\n\tconst state = view._table.getScrollState();\n\n\twin.show({\n\t\tx:conf.x,\n\t\ty:conf.y-state.y\n\t});\n}\n\nfunction _correctPos(view, win, v, type){\n\tif(!v && v !==0 )\n\t\tv = view._table.getScrollState()[type]+50;\n\telse{\n\t\tconst size = type == \"x\" ? _getWidth(view)-win.$width : _getHeight(view)-win.$height;\n\t\tv = Math.min(Math.max(v, 0), size);\n\t}\t\n\treturn v;\n}\n\nfunction _reset(view){\n\tignoreUndo(function(){\n\t\tfor(let id in view.views._pull)\n\t\t\tview.views.remove(id);\n\t}, view);\n}\n\nfunction _undoUI(view, move, id, value){\n\tif(value){\n\t\tconst {x, y, type, data, config} = value;\n\t\tif(view.views._pull[id]){\n\t\t\tif(move)\n\t\t\t\tview.views.move(id, x, y);\n\t\t\telse\n\t\t\t\tview.views.update(id, data, config);\n\t\t}\n\t\telse\n\t\t\tview.views.add(x, y, type, data, config, id);\n\n\t\tconst editor = view.$$(\"chartEditor\");\n\t\tif(editor && editor.viewId == id)\n\t\t\teditor.queryView(\"form\").setValues(config);\n\t}\n\telse\n\t\tview.views.remove(id);\n}\n\nfunction _getWidth(view){\n\tlet width = 0;\n\tview._table.eachColumn(function(id){\n\t\tif(id !== \"rowId\")\n\t\t\twidth += this.getColumnConfig(id).width;\n\t});\n\treturn width;\n}\n\nfunction _getHeight(view){\n\tlet height = 0;\n\tview._table.data.each(function(obj){\n\t\theight += obj.$height || webix.skin.$active.rowHeight;\n\t});\n\treturn height;\n}\n\n//disable datatables not to interfere with ss table events\nfunction _processTables(node){\n\tconst query = function(view){\n\t\treturn view.name == \"datatable\" || view.name == \"treetable\";\n\t};\n\tlet tables = node.queryView(query, \"self\");\n\tif(tables) tables = [tables];\n\telse tables = node.queryView(query, \"all\");\n\ttables.forEach((dt) => dt.disable());\n}\n\n/* chart-specific helpers */\n\nfunction _genChartConfig(conf, data, dataRange){\n\tconst htmlFilter = /<[^>]*>/gi;\n\tlet config = webix.copy(conf.config);\n\n\tconfig = _normalizeConfig(config);\n\n\tconst scale = config.scale.lines;\n\tconst scaleColor = config.scale.color || undefined;\n\n\tconst type = config.type;\n\n\tif(_isPie(type))\n\t\tdelete config.series;\n\n\tconst legendConfig = config.legend;\n\tlet legendRange = !legendConfig.fromData && legendConfig.range;\n\tif(legendRange){\n\t\tconst switchDirection =  config.dataSeries == \"rows\";\n\t\tlegendRange = _getParts(legendConfig.range, switchDirection, dataRange);\n\t}\n\n\tconst legend = {\n\t\theight:24,\n\t\talign: legendConfig.align || \"center\",\n\t\tvalign: legendConfig.valign || \"bottom\"\n\t};\n\n\tlegend.layout = legend.valign == \"middle\" ? \"y\" : \"x\";\n\n\tif(_isPie(type))\n\t\t_pieConfig(data, config, legend, legendRange);\n\telse if(config.series){\n\t\tlegend.values = [];\n\n\t\tconst lines = config.series;\n\t\tconfig.series = [];\n\n\t\tconst xAxis = config.xAxis;\n\t\tif(xAxis.fromData)\n\t\t\txAxis.range = legendRange ? Object.keys(data[0]).filter(line => legendRange.indexOf(line) == -1)[0] : \"data0\";\n\t\telse if(xAxis.range)\n\t\t\txAxis.range = dataRange[xAxis.range];\n\n\t\tfor(let i = 0; i < lines.length; i++){\n\t\t\tconst color = lines[i].color;\n\t\t\tconst item = dataRange[lines[i].range];\n\n\t\t\tif(item != xAxis.range){\n\t\t\t\tconst s = {\n\t\t\t\t\tvalue:`#${item}#`,\n\t\t\t\t\tlabel: lines[i].label ? `#${item}#` : \"\",\n\t\t\t\t\ttooltip:{\n\t\t\t\t\t\ttemplate: lines[i].tooltip ? `#${item}#` : \"\"\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tif(type == \"radar\" || type == \"line\" || type == \"spline\"){\n\t\t\t\t\ts.line = { color:color };\n\t\t\t\t\ts.item = { borderColor:color, type:lines[i].marker };\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\ts.color = color;\n\t\t\t\tif(type == \"area\" || type == \"splineArea\")\n\t\t\t\t\ts.alpha = 0.7;\n\n\t\t\t\tif(data[0] && (legendRange || legendConfig.fromData)){\n\t\t\t\t\tconst val = legendRange ? data[0][legendRange[i]] : data[0][item];\n\t\t\t\t\tconst text = (val || val === 0) ? (val+\"\").replace(htmlFilter, \"\") : \"\";\n\t\t\t\t\tlegend.values.push({text, color});\n\t\t\t\t}\n\n\t\t\t\tconfig.series.push(s);\n\t\t\t}\n\t\t}\n\n\t\tconfig.xAxis = {\n\t\t\ttemplate: obj => {\n\t\t\t\tconst val = obj[xAxis.range];\n\t\t\t\treturn (val || val === 0) ? (val+\"\").replace(htmlFilter, \"\") : \"\";\n\t\t\t},\n\t\t\ttitle: config.xAxis.title,\n\t\t\tlineColor: scaleColor,\n\t\t\tcolor: scaleColor,\n\t\t\tlines: scale\n\t\t};\n\n\t\tif(legend.values.length)\n\t\t\tconfig.legend = legend;\n\t\telse\n\t\t\tdelete config.legend;\n\t}\n\n\tconfig.yAxis = config.yAxis||{};\n\tfor(let property in config.yAxis)\n\t\tif(config.yAxis[property] === \"\")\n\t\t\tdelete config.yAxis[property];\n\n\tconfig.yAxis = webix.extend(config.yAxis, {\n\t\tlineColor: scaleColor,\n\t\tcolor: scaleColor,\n\t\tlines: scale,\n\t\tlineShape: config.scale.circle ? \"arc\" : \"default\"\n\t});\n\n\treturn webix.extend({\n\t\tview:\"chart\",\n\t\tpadding:{\n\t\t\tleft:80\n\t\t}\n\t}, config, true);\n}\n\nfunction _pieConfig(data, config, legend, legendRange){\n\tconst htmlFilter = /<[^>]*>/gi;\n\tfor(var i in data[0]){\n\t\tif(config.legend.fromData){\n\t\t\tlegend.template = obj => {\n\t\t\t\tconst val = obj[i];\n\t\t\t\treturn (val || val === 0) ? (val+\"\").replace(htmlFilter, \"\") : \"\";\n\t\t\t}; //data0\n\t\t\tconfig.value = `#${i.replace(\"0\", \"1\")}#`; //data1\n\t\t}\n\t\telse{\n\t\t\tif(config.legend.range)\n\t\t\t\tlegend.template = obj => {\n\t\t\t\t\tconst val = obj[legendRange[0]];\n\t\t\t\t\treturn (val || val === 0) ? (val+\"\").replace(htmlFilter, \"\") : \"\";\n\t\t\t\t};\n\t\t\tconfig.value = `#${i}#`;\n\t\t}\n\t\tbreak; \n\t}\n\tif(legend.template)\n\t\tconfig.legend = legend;\n\telse\n\t\tdelete config.legend;\n\n\tif(config.pieInnerText)\n\t\tconfig.pieInnerText = config.value;\n}\n\nfunction _isRange(data){\n\treturn typeof data == \"string\" && data.indexOf(\"data:image\") === -1;\n}\n\nfunction _fromRange(view, conf){\n\tlet data = conf.data;\n\n\tif(/^(http|data:image|\\/)/i.test(data))\n\t\treturn data;\n\n\tconst arr = [];\n\tif(data){\n\t\tconst config = conf.config;\n\t\tconst switchDirection = config.dataSeries == \"rows\";\n\t\tlet lastIndex = 0;\n\n\t\tdata = _getDataParts(data);\n\t\tfor(let i = 0; i < data.length; i++){\n\t\t\tconst cells = _isRange(data[i]) ? range(data[i], view) : null;\n\t\t\tif(cells){\n\t\t\t\tconst page = cells[4] ? view._mData.getPage(cells[4]) : view._mPage;\n\t\t\t\tcells[5] = lastIndex;\n\n\t\t\t\tif(page){\n\t\t\t\t\tconst subdata = switchDirection ? getRangeRows.apply(page, cells) : getRangeCols.apply(page, cells);\n\t\t\t\t\tlastIndex += subdata[2];\n\t\t\t\t\tfor(let i = 0; i < subdata[0].length; i++){\n\t\t\t\t\t\tif(!arr[i])\n\t\t\t\t\t\t\tarr[i] = {};\n\t\t\t\t\t\twebix.extend(arr[i], subdata[0][i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn arr;\n}\n\nfunction _removeLegend(arr, conf, view){\n\tconst config = conf.config;\n\tif(typeof(config.legend) != \"object\")\n\t\tconfig.legend = {fromData: !!config.legend};\n\n\tconst legend = config.legend;\n\n\tif(legend.fromData)\n\t\tarr.shift();\n\telse if(legend.range){\n\t\tconst names = _getNames(view, conf);\n\t\tconst switchDirection = config.dataSeries == \"rows\";\n\t\tconst legendRange = _getParts(legend.range, switchDirection, names);\n\t\tfor (let i = 0; i < legendRange.length; i++){\n\t\t\tconst item = legendRange[i];\n\t\t\tdelete arr[0][item];\n\t\t}\n\t}\n}\n\nfunction _getNames(view, conf){\n\tlet data = conf.data;\n\n\tif(/^(http|data:image|\\/)/i.test(data))\n\t\treturn;\n\n\tlet names = {};\n\tif(data){\n\t\tconst config = conf.config;\n\t\tconst switchDirection = config.dataSeries == \"rows\";\n\t\tlet lastIndex = 0;\n\n\t\tdata = _getDataParts(data);\n\t\tfor(let i = 0; i < data.length; i++){\n\t\t\tconst cells = _isRange(data[i]) ? range(data[i], view) : null;\n\t\t\tif(cells){\n\t\t\t\tconst page = cells[4] ? view._mData.getPage(cells[4]) : view._mPage;\n\t\t\t\tcells[5] = lastIndex;\n\n\t\t\t\tif(page){\n\t\t\t\t\tconst subdata = switchDirection ? getRangeRows.apply(page, cells) : getRangeCols.apply(page, cells);\n\t\t\t\t\tlastIndex += subdata[2];\n\t\t\t\t\twebix.extend(names, subdata[1]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn names;\n}\n\nexport function _getDataParts(data){\n\treturn data.replace(/\\s/g, \"\").split(\",\");\n}\n\nexport function _isPie(type){\n\treturn /pie|donut/.test(type);\n}\n\nexport function _getSeries(view, data, dataSeries, active, oldXaxis){\n\tconst dir = dataSeries == \"rows\";\n\tlet vals = [];\n\n\tif(data){\n\t\tlet xAxis = [];\n\t\tlet legend = [];\n\t\tlet activeVals = [];\n\n\t\tif(active){\n\t\t\tif(active.legend)\n\t\t\t\tlegend = _getParts(active.legend, dir);\n\t\t\tif(active.xAxis)\n\t\t\t\txAxis = _getParts(active.xAxis, dir);\n\t\t\tif(active.series)\n\t\t\t\tactiveVals = active.series.filter(val => legend.indexOf(val.range) == -1 && xAxis.indexOf(val.range) == -1);\n\t\t}\n\n\t\tdata = _getDataParts(data);\n\t\tlet colorIndex = 0;\n\t\tlet firstRange = 1;\n\t\tdata.forEach(subdata => {\n\t\t\tconst series = isRange(subdata) ? range(subdata, view) : null;\n\t\t\tif(series){\n\t\t\t\tconst start = dir ? series[0] : series[1];\n\t\t\t\tconst end = dir ? series[2] : series[3];\n\n\t\t\t\tlet inActiveSeries;\n\t\t\t\tfor(let i = start; i <= end; i++){\n\t\t\t\t\tconst range = dir ? toRange(i, series[1], i, series[3], series[4]) : toRange(series[0], i, series[2], i, series[4]);\n\t\t\t\t\tconst seria = activeVals.find(val => val.range == range && (!val.active || val.active == subdata));\n\n\t\t\t\t\tif(seria){\n\t\t\t\t\t\tif(!seria.active)\n\t\t\t\t\t\t\tseria.active = subdata;\n\t\t\t\t\t\tinActiveSeries = 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor(let i = start; i <= end; i++){\n\t\t\t\t\tconst range = dir ? toRange(i, series[1], i, series[3], series[4]) : toRange(series[0], i, series[2], i, series[4]);\n\t\t\t\t\tif(legend.indexOf(range) != -1 || xAxis.indexOf(range) != -1)\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tconst activeVal = activeVals.filter(val => val.range == range && val.active == subdata)[0];\n\n\t\t\t\t\tif(inActiveSeries && !activeVal && !(oldXaxis && firstRange && i == start))\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tvals.push(activeVal || {\n\t\t\t\t\t\tactive: subdata,\n\t\t\t\t\t\trange,\n\t\t\t\t\t\tmarker: \"square\",\n\t\t\t\t\t\ttooltip: 1,\n\t\t\t\t\t\tcolor: _getColor(colorIndex)\n\t\t\t\t\t});\n\n\t\t\t\t\tcolorIndex++;\n\t\t\t\t}\n\t\t\t\tfirstRange = 0;\n\t\t\t}\n\t\t});\n\t}\n\treturn vals;\n}\n\nexport function _getParts(ranges, dir, dataRange){\n\tconst parts = [];\n\n\tranges = _getDataParts(ranges);\n\tranges.forEach(subRange => {\n\t\tsubRange = isRange(subRange) ? range(subRange) : null;\n\t\tif(subRange){\n\t\t\tconst start = dir ? subRange[0] : subRange[1];\n\t\t\tconst end = dir ? subRange[2] : subRange[3];\n\n\t\t\tfor(let i = start; i <= end; i++){\n\t\t\t\tconst range = dir ?\n\t\t\t\t\ttoRange(i, subRange[1], i, subRange[3], subRange[4]):\n\t\t\t\t\ttoRange(subRange[0], i, subRange[2], i, subRange[4]);\n\n\t\t\t\tparts.push(dataRange ? dataRange[range] : range);\n\t\t\t}\n\t\t}\n\t});\n\n\treturn parts;\n}\n\nexport function _normalizeConfig(config){\n\tif(typeof(config.xAxis) != \"object\")\n\t\tconfig.xAxis = {fromData: !!config.xAxis};\n\n\tif(typeof(config.legend) != \"object\")\n\t\tconfig.legend = {fromData: !!config.legend};\n\n\tconfig.legend = webix.extend(config.legend, {\n\t\tlayout:\"x\",\n\t\talign:\"center\",\n\t\tvalign:\"bottom\"\n\t});\n\n\tif(!config.scale)\n\t\tconfig.scale = {\n\t\t\tlines:1\n\t\t};\n\n\treturn config;\n}\n\nfunction _getColor(index){\n\tconst colors = [\n\t\t\"#e06666\", \"#6aa84f\", \"#3c78d8\", \"#e69138\", \"#783f04\", \"#134f5c\", \"#674ea7\", \"#c27ba0\"\n\t];\n\treturn colors[index%colors.length];\n}\n\nfunction getRangeCols(r1,c1,r2,c2,sheetName,lastIndex){\n\tconst data = [];\n\tconst rangeToData = {};\n\tfor (let i = r1, rind = 0; i <= r2; i++, rind++){\n\t\tdata[rind] = {};\n\t\tfor (let j = c1, cind = lastIndex; j <= c2; j++, cind++){\n\t\t\tif(i == r2){\n\t\t\t\trangeToData[`${sheetName ? sheetName+\"!\" : \"\"}${encode[j]}${r1}:${encode[j]}${r2}`] = `data${cind}`;\n\t\t\t\tlastIndex++;\n\t\t\t}\n\t\t\tdata[rind][`data${cind}`] = this.getValue(i-1,j-1);\n\t\t}\n\t}\n\treturn [data, rangeToData, lastIndex];\n}\n\nfunction getRangeRows(r1,c1,r2,c2,sheetName,lastIndex){\n\tconst data = [];\n\tconst rangeToData = {};\n\tfor (let i = c1, cind = 0; i <= c2; i++, cind++){\n\t\tdata[cind] = {};\n\t\tfor (let j = r1, rind = lastIndex; j <= r2; j++, rind++){\n\t\t\tif(i == c2){\n\t\t\t\trangeToData[`${sheetName ? sheetName+\"!\" : \"\"}${encode[c1]}${j}:${encode[c2]}${j}`] = `data${rind}`;\n\t\t\t\tlastIndex++;\n\t\t\t}\n\t\t\tdata[cind][`data${rind}`] = this.getValue(j-1,i-1);\n\t\t}\n\t}\n\treturn [data, rangeToData, lastIndex];\n}","import {range, toRange} from \"./helpers/column_names\";\nimport {_getSeries, _isPie, _normalizeConfig, _getDataParts} from \"./operations/views\";\n\nconst labels = webix.i18n.spreadsheet.labels;\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\tconst activeSkin = webix.skin.$active;\n\tconst padding = activeSkin.dataPadding-2;\n\tconst margin = activeSkin.layoutMargin.form;\n\n\treturn {\n\t\twidth:440,\n\t\thidden: true,\n\t\tid:\"chartEditor\",\n\t\tcss:\"ssheet_chart\",\n\t\trows:[\n\t\t\t{\n\t\t\t\theight: activeSkin.barHeight,\n\t\t\t\tcss: \"ssheet_chart_wizard_head\",\n\t\t\t\tpadding:{ left: 2 },\n\t\t\t\tcols: [\n\t\t\t\t\t{ view: \"icon\", hotkey:\"esc\", icon:\"webix_ssheet_icon ssi-arrow-left\", click: () => closeEditor(view)  },\n\t\t\t\t\t{ type:\"header\", borderless:true, template: labels[\"chart-edit\"] }\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"form\",\n\t\t\t\tcomplexData:true,\n\t\t\t\tborderless: true,\n\t\t\t\tpadding:{\n\t\t\t\t\ttop: 0\n\t\t\t\t},\n\t\t\t\telementsConfig:{\n\t\t\t\t\tlabelWidth:180\n\t\t\t\t},\n\t\t\t\telements:[{\n\t\t\t\t\tview:\"tabview\",\n\t\t\t\t\tid:\"chartTabs\",\n\t\t\t\t\tcells:[\n\t\t\t\t\t\t{ id:\"common\", borderless:true, type:\"form\", paddingX:0, header:labels[\"chart-common\"], rows:[\n\t\t\t\t\t\t\t{view:\"scrollview\", body:{\n\t\t\t\t\t\t\t\tmargin,\n\t\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t\taddRichselect(\"type\", \"chart-type\", getTypes()),\n\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"stacked-chart\"], name:\"stacked\", hidden:true},\n\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-pie-3d\"], name:\"3D\", hidden:true},\n\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-range\"], name:\"range\"},\n\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-col-xAxis\"], name:\"xAxis.fromData\", batch:\"axis\"},\n\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-pie-text\"], name:\"pieInnerText\", hidden:true},\n\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-row-legend\"], name:\"legend.fromData\"},\n\t\t\t\t\t\t\t\t\t{ view:\"radio\", label:labels[\"chart-data-from\"], name:\"dataSeries\", vertical:true, options:[\n\t\t\t\t\t\t\t\t\t\t{id:\"columns\", value:labels[\"chart-columns\"]},\n\t\t\t\t\t\t\t\t\t\t{id:\"rows\", value:labels[\"chart-rows\"]}\n\t\t\t\t\t\t\t\t\t]},\n\t\t\t\t\t\t\t\t\t{}\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{ id:\"advanced\", borderless:true, type:\"form\", paddingX:0, padding:{bottom:0}, header:labels[\"chart-series\"], rows:[\n\t\t\t\t\t\t\t{ view: \"ssheet-series\", name:\"series\" },\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{ id:\"extras\", borderless:true, type:\"form\", paddingX:0, header:labels[\"chart-extras\"], rows:[\n\t\t\t\t\t\t\t{view:\"scrollview\", body:{\n\t\t\t\t\t\t\t\tview: \"accordion\",\n\t\t\t\t\t\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\t\t\t\t\t\tcss: \"webix_ssheet_accordion\",\n\t\t\t\t\t\t\t\tmulti: true,\n\t\t\t\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t\t{ header:labels[\"chart-legend\"], body:{\n\t\t\t\t\t\t\t\t\t\tmargin,\n\t\t\t\t\t\t\t\t\t\tpadding,\n\t\t\t\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t\t\t\t{ view: \"text\", label:labels[\"chart-legend-range\"], name:\"legend.range\"},\n\t\t\t\t\t\t\t\t\t\t\taddRichselect(\"legend.align\", \"chart-legend-align\", getLegendAlign()),\n\t\t\t\t\t\t\t\t\t\t\taddRichselect(\"legend.valign\", \"chart-legend-valign\", getLegendValign())\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}},\n\t\t\t\t\t\t\t\t\t{ header:labels[\"chart-scale\"], batch:\"axis\", id:\"scale\", body:{\n\t\t\t\t\t\t\t\t\t\tmargin,\n\t\t\t\t\t\t\t\t\t\tpadding,\n\t\t\t\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-lines\"], name:\"scale.lines\", batch:\"axis\"},\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-radar-circle\"], name:\"scale.circle\", hidden:true},\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:labels[\"chart-scale-color\"], name:\"scale.color\", batch:\"axis\"}\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}},\n\t\t\t\t\t\t\t\t\t{ header:labels[\"chart-x-axis\"], batch:\"axis\", body:{\n\t\t\t\t\t\t\t\t\t\tmargin,\n\t\t\t\t\t\t\t\t\t\tpadding,\n\t\t\t\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-xAxis-range\"], name:\"xAxis.range\", range:true, batch:\"axis\" },\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-xAxis-title\"], name:\"xAxis.title\", batch:\"axisTitle\" },\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}},\n\t\t\t\t\t\t\t\t\t{ header:labels[\"chart-y-axis\"], batch:\"axis\", body:{\n\t\t\t\t\t\t\t\t\t\tmargin,\n\t\t\t\t\t\t\t\t\t\tpadding,\n\t\t\t\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-yAxis-title\"], name:\"yAxis.title\", batch:\"axisTitle\" },\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-yAxis-origin\"], name:\"origin\", batch:\"axis\", attributes:{ type:\"number\" } },\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"label\", label:labels[\"chart-yAxis-note\"], css:\"ssheet_note\", height:20},\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-yAxis-start\"], name:\"yAxis.start\", batch:\"axis\", attributes:{ type:\"number\" } },\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-yAxis-end\"], name:\"yAxis.end\", batch:\"axis\", attributes:{ type:\"number\" } },\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-yAxis-step\"], name:\"yAxis.step\", batch:\"axis\", attributes:{ type:\"number\" } }\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}},\n\t\t\t\t\t\t\t\t\t{}\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t]}\n\t\t\t\t\t]\n\t\t\t\t}]\n\t\t\t}\n\t\t]\n\t};\n}\n\nfunction ready(view){\n\tconst chartEditor = view.$$(\"chartEditor\");\n\tconst form = chartEditor.queryView(\"form\");\n\tconst elements = form.elements;\n\n\tview.attachEvent(\"onCommand\", action => {\n\t\tif(action.id == \"add-chart\"){\n\t\t\tconst config = action.config;\n\t\t\tlet values = config && config.config || {};\n\n\t\t\tchartEditor.show();\n\n\t\t\tview.$handleSelection = function(st, end, a, b){\n\t\t\t\tconst focus = webix.UIManager.getFocus();\n\n\t\t\t\tif(chartEditor.queryView(view => view == focus)){\n\t\t\t\t\tif(focus == elements.range || focus == elements[\"legend.range\"]){\n\t\t\t\t\t\tlet val = focus.getValue();\n\t\t\t\t\t\tconst last = val.lastIndexOf(\",\");\n\n\t\t\t\t\t\tval = last == -1 ? \"\" : val.substring(0, last + 1);\n\t\t\t\t\t\tfocus.setValue(val + a+\":\"+b);\n\t\t\t\t\t}\n\t\t\t\t\telse if(focus.config.range)\n\t\t\t\t\t\tfocus.setValue(a+\":\"+b);\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t};\n\n\t\t\tform.clear();\n\t\t\tview.$$(\"chartTabs\").setValue(\"common\");\n\n\t\t\tvalues = _normalizeConfig(values);\n\n\t\t\tvalues.range = config ? config.data : view.getSelectedRange();\n\t\t\tchartEditor.viewId = action.viewid ? action.viewid : view.views.add(null, null, \"chart\", values.range, values);\n\n\t\t\tview.callEvent(\"onUIEditStart\", [chartEditor.viewId, \"chart\"]);\n\n\t\t\tupdateValign(values.legend.align);\n\t\t\tupdateAlign(values.legend.valign);\n\t\t\tupdateType(values.type);\n\n\t\t\tform.setValues(inValues(values));\n\n\t\t\tif(values.legend.fromData)\n\t\t\t\tupdateLegendRange(values.legend.fromData);\n\t\t\tif(values.xAxis.fromData)\n\t\t\t\tupdateXaxisRange(values.xAxis.fromData);\n\n\t\t\tupdateSeries();\n\n\t\t\tform.queryView(\"accordionitem\", \"all\").forEach(view => view.expand());\n\n\t\t\telements.range.focus();\n\t\t}\n\t});\n\n\tview.attachEvent(\"onUIEditStart\", (id, type)=>{\n\t\tif(chartEditor.isVisible() && type != \"chart\")\n\t\t\tcloseEditor(view);\n\t});\n\n\tview.attachEvent(\"onCommand\", obj =>{\n\t\tif(obj.id == \"close-ui-editor\" && chartEditor.isVisible())\n\t\t\tcloseEditor(view);\n\t});\n\n\tview.attachEvent(\"onAction\", (id, values) => {\n\t\tif(id == \"add-view\" && !values.newValue){\n\t\t\tif(chartEditor.isVisible() && chartEditor.viewId == values.row)\n\t\t\t\tcloseEditor(view);\n\t\t}\n\t});\n\n\tform.attachEvent(\"onChange\", function(val, oldVal){\n\t\tconst source = this.$eventSource;\n\n\t\t//upper case ranges\n\t\tif(source === elements.range || source === elements[\"xAxis.range\"] || source === elements[\"legend.range\"]){\n\t\t\tconst parts = val.split(\"!\");\n\t\t\tconst upper = parts.length == 2 ? parts[0]+\"!\"+parts[1].toUpperCase() : val.toUpperCase();\n\n\t\t\tif(val != upper){\n\t\t\t\tval = upper;\n\t\t\t\tsetSilentValue(source, upper);\n\t\t\t}\n\t\t}\n\n\t\tswitch (source){\n\t\t\tcase elements.type:\n\t\t\t\tupdateType(val);\n\t\t\t\tbreak;\n\t\t\tcase elements.range:\n\t\t\tcase elements.dataSeries:\n\t\t\t\tif(this.$eventSource == elements.dataSeries)\n\t\t\t\t\tswitchRowsCols();\n\t\t\t\tif(elements[\"legend.fromData\"].getValue())\n\t\t\t\t\thandlePieLegend();\n\t\t\t\tif(elements[\"xAxis.fromData\"].getValue())\n\t\t\t\t\tsetSilentValue(elements[\"xAxis.range\"], getLeftColumn());\n\t\t\t\tupdateSeries();\n\t\t\t\tbreak;\n\t\t\tcase elements[\"xAxis.fromData\"]:\n\t\t\t\tupdateXaxisRange(val);\n\t\t\t\tupdateSeries(oldVal);\n\t\t\t\tbreak;\n\t\t\tcase elements[\"legend.fromData\"]:\n\t\t\t\tupdateLegendRange(val);\n\t\t\t\tupdateSeries();\n\t\t\t\tbreak;\n\t\t\tcase elements[\"legend.align\"]:\n\t\t\t\tupdateValign(val);\n\t\t\t\tbreak;\n\t\t\tcase elements[\"legend.valign\"]:\n\t\t\t\tupdateAlign(val);\n\t\t\t\tbreak;\n\t\t\tcase elements[\"xAxis.range\"]:\n\t\t\t\tif(elements[\"xAxis.fromData\"].getValue())\n\t\t\t\t\tsetSilentValue(elements[\"xAxis.fromData\"]);\n\t\t\t\tupdateRange(val, oldVal);\n\t\t\t\tbreak;\n\t\t\tcase elements[\"legend.range\"]:\n\t\t\t\tif(elements[\"legend.fromData\"].getValue())\n\t\t\t\t\tsetSilentValue(elements[\"legend.fromData\"]);\n\t\t\t\tupdateRange(val, oldVal);\n\t\t\t\tbreak;\n\t\t}\n\n\t\tconst config = outValues(form.getValues());\n\t\tview.views.update(chartEditor.viewId, config.range, config);\n\t});\n\n\telements.series.attachEvent(\"onRangeChange\", updateRange);\n\n\tfunction handlePieLegend(){\n\t\tif(elements[\"legend.fromData\"].getValue()){\n\t\t\tconst handler = _isPie(elements.type.getValue()) ? getLeftColumn : getTopRow;\n\t\t\tsetSilentValue(elements[\"legend.range\"], handler());\n\t\t}\n\t}\n\n\tfunction updateLegendRange(val){\n\t\tif(val){\n\t\t\tconst legendRange = elements[\"legend.range\"].getValue();\n\t\t\tupdateRange(\"\", legendRange);\n\t\t}\n\n\t\tconst handler = _isPie(elements.type.getValue()) ? getLeftColumn : getTopRow;\n\t\tval = val ? handler() : \"\";\n\n\t\tsetSilentValue(elements[\"legend.range\"], val);\n\t}\n\n\tfunction updateXaxisRange(val){\n\t\tif(val){\n\t\t\tconst xAxisRange = elements[\"xAxis.range\"].getValue();\n\t\t\tupdateRange(\"\", xAxisRange);\n\t\t}\n\n\t\tval = val ? getLeftColumn() : \"\";\n\n\t\tsetSilentValue(elements[\"xAxis.range\"], val);\n\t}\n\n\tfunction setSilentValue(element, val){\n\t\telement.blockEvent();\n\t\telement.setValue(val);\n\t\telement.unblockEvent();\n\t}\n\n\tfunction getLeftColumn(){\n\t\tconst data = elements.range.getValue();\n\t\tconst dataSeries = elements.dataSeries.getValue();\n\t\tconst legendRange = elements[\"legend.range\"].getValue();\n\t\tlet leftColumn = \"\";\n\n\t\tconst series = _getSeries(view, data, dataSeries, {legend: legendRange || \"\"});\n\n\t\tif(series.length)\n\t\t\tleftColumn = series[0].range;\n\n\t\treturn leftColumn;\n\t}\n\n\tfunction getTopRow(){\n\t\tconst data = _getDataParts(elements.range.getValue());\n\t\tconst dir = elements.dataSeries.getValue() == \"rows\";\n\t\tconst xAxisRange = _getDataParts(elements[\"xAxis.range\"].getValue());\n\t\tlet topRow = [];\n\n\t\tdata.forEach(subdata => {\n\t\t\tif(xAxisRange.indexOf(subdata) == -1){\n\t\t\t\tconst part = range(subdata, view);\n\t\t\t\tif(part){\n\t\t\t\t\tconst range = dir ?\n\t\t\t\t\t\ttoRange(part[0], part[1], part[2], part[1], part[4]) :\n\t\t\t\t\t\ttoRange(part[0], part[1], part[0], part[3], part[4]);\n\n\t\t\t\t\tif(data.indexOf(range) == -1)\n\t\t\t\t\t\ttopRow.push(range);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn topRow.join(\",\");\n\t}\n\n\tfunction updateRange(val, oldVal){\n\t\tlet data = elements.range.getValue();\n\n\t\tconst legend = elements[\"legend.range\"].getValue();\n\t\tconst xAxis = elements[\"xAxis.range\"].getValue();\n\t\tconst dataSeries = elements.dataSeries.getValue();\n\n\t\tconst series = _getSeries(view, data, dataSeries, {legend, xAxis});\n\n\t\toldVal = _getDataParts(oldVal);\n\n\t\tdata = _getDataParts(data).filter(val => oldVal.indexOf(val) == -1);\n\n\t\tif(val){\n\t\t\tval = _getDataParts(val);\n\t\t\tval.forEach(range => {\n\t\t\t\tconst exist = series.filter(obj => obj.range == range);\n\t\t\t\tif(!exist.length)\n\t\t\t\t\tdata.push(range);\n\t\t\t});\n\t\t}\n\n\t\tsetSilentValue(elements.range, data.join(\",\"));\n\t}\n\n\tfunction updateAlign(val){\n\t\tconst align = elements[\"legend.align\"];\n\t\tconst list = align.getList();\n\n\t\tif(val == \"middle\"){\n\t\t\tif(list.exists(\"center\"))\n\t\t\t\tlist.remove(\"center\");\n\t\t}\n\t\telse if(!list.exists(\"center\"))\n\t\t\tlist.add({id:\"center\", value:labels[\"chart-legend-center\"]}, 1);\n\t}\n\n\tfunction updateValign(val){\n\t\tconst align = elements[\"legend.valign\"];\n\t\tconst list = align.getList();\n\n\t\tif(val == \"center\"){\n\t\t\tif(list.exists(\"middle\"))\n\t\t\t\tlist.remove(\"middle\");\n\t\t}\n\t\telse if(!list.exists(\"middle\"))\n\t\t\tlist.add({id:\"middle\", value:labels[\"chart-legend-middle\"]}, 1);\n\t}\n\n\tfunction updateType(val){\n\t\tconst tabs = view.$$(\"chartTabs\").getTabbar();\n\t\tswitchRowsCols();\n\t\thandlePieLegend();\n\n\t\tconst series = elements.series;\n\t\tconst markersVisible = val == \"radar\" || val == \"line\" || val == \"spline\";\n\t\tseries.hideSubviews(\"marker\", markersVisible);\n\t\tseries.hideSubviews(\"label\", markersVisible || val == \"bar\");\n\n\t\tif(val == \"area\" || val == \"bar\") elements.stacked.show();\n\t\telse hideField(elements.stacked);\n\n\t\tif(val == \"radar\")\n\t\t\telements[\"scale.circle\"].show();\n\t\telse\n\t\t\thideField(elements[\"scale.circle\"]);\n\n\t\tif(val == \"pie\")\n\t\t\telements[\"3D\"].show();\n\t\telse\n\t\t\thideField(elements[\"3D\"]);\n\n\t\tif(_isPie(val)){\n\t\t\thideBatch(\"axis\");\n\t\t\telements.pieInnerText.show();\n\t\t\ttabs.hideOption(\"advanced\");\n\t\t}\n\t\telse{\n\t\t\thideBatch(\"axis\", true);\n\t\t\thideField(elements.pieInnerText);\n\t\t\ttabs.showOption(\"advanced\");\n\t\t}\n\n\t\tif(_isPie(val) || val == \"radar\")\n\t\t\thideBatch(\"axisTitle\");\n\t\telse\n\t\t\thideBatch(\"axisTitle\", true);\n\t}\n\n\tfunction updateSeries(oldXaxis){\n\t\tlet data = elements.range.getValue();\n\n\t\tlet series = elements.series.getValue();\n\t\tconst legend = elements[\"legend.range\"].getValue();\n\t\tconst xAxis = elements[\"xAxis.range\"].getValue();\n\t\tconst dataSeries = elements.dataSeries.getValue();\n\n\t\tseries = _getSeries(view, data, dataSeries, {series, legend, xAxis}, oldXaxis);\n\n\t\telements.series.setValue(series);\n\t}\n\n\tfunction switchRowsCols(){\n\t\tconst dir = elements.dataSeries.getValue() == \"rows\";\n\t\tconst pie = _isPie(elements.type.getValue());\n\t\tif((!pie && dir) || (!dir && pie)){\n\t\t\telements[\"legend.fromData\"].define(\"label\", labels[\"chart-col-legend\"]);\n\t\t\telements[\"xAxis.fromData\"].define(\"label\", labels[\"chart-row-xAxis\"]);\n\t\t}\n\t\telse{\n\t\t\telements[\"legend.fromData\"].define(\"label\", labels[\"chart-row-legend\"]);\n\t\t\telements[\"xAxis.fromData\"].define(\"label\", labels[\"chart-col-xAxis\"]);\n\t\t}\n\t\telements[\"legend.fromData\"].refresh();\n\t\telements[\"xAxis.fromData\"].refresh();\n\t}\n\n\tfunction hideField(field){\n\t\tif(field.setValue)\n\t\t\tsetSilentValue(field);\n\t\tfield.hide();\n\t}\n\n\tfunction hideBatch(batch, visible){\n\t\tform.queryView({batch:batch}, \"all\").forEach(field => {\n\t\t\tif(visible)\n\t\t\t\tfield.show();\n\t\t\telse\n\t\t\t\thideField(field);\n\t\t});\n\t}\n\n\tfunction inValues(values){\n\t\tif(/stacked|3D/.test(values.type))\n\t\t\tvalues.type = values.type.replace(/stacked|3D/, \"\").toLowerCase();\n\t\treturn values;\n\t}\n\n\tfunction outValues(values){\n\t\tif(values.stacked)\n\t\t\tvalues.type = \"stacked\"+values.type.charAt(0).toUpperCase()+values.type.substr(1);\n\t\telse if(values[\"3D\"])\n\t\t\tvalues.type += \"3D\";\n\n\t\treturn values;\n\t}\n}\n\nfunction closeEditor(view){\n\tconst chartEditor = view.$$(\"chartEditor\");\n\tview.callEvent(\"onUIEditStop\", [chartEditor.viewId, \"chart\"]);\n\tchartEditor.viewId = null;\n\tview.$handleSelection = null;\n\tchartEditor.hide();\n}\n\nfunction addRichselect(name, label, data){\n\treturn { view: \"richselect\", name:name, label:labels[label], suggest:{\n\t\tview: \"ssheet-form-suggest\",\n\t\tdata: data\n\t}};\n}\n\nfunction getTypes(){\n\treturn [\n\t\t{id:\"line\", value:labels[\"line-chart\"]},\n\t\t{id:\"spline\", value:labels[\"spline-chart\"]},\n\t\t{id:\"splineArea\", value:labels[\"splinearea-chart\"]},\n\t\t{id:\"area\", value:labels[\"area-chart\"]},\n\t\t{id:\"bar\", value:labels[\"bar-chart\"]},\n\t\t{id:\"radar\", value:labels[\"radar-chart\"]},\n\t\t{id:\"pie\", value:labels[\"pie-chart\"]},\n\t\t{id:\"donut\", value:labels[\"donut-chart\"]}\n\t];\n}\n\nfunction getLegendAlign(){\n\treturn [\n\t\t{id:\"left\", value:labels[\"chart-legend-left\"]},\n\t\t{id:\"center\", value:labels[\"chart-legend-center\"]},\n\t\t{id:\"right\", value:labels[\"chart-legend-right\"]}\n\t];\n}\n\nfunction getLegendValign(){\n\treturn [\n\t\t{id:\"top\", value:labels[\"chart-legend-top\"]},\n\t\t{id:\"middle\", value:labels[\"chart-legend-middle\"]},\n\t\t{id:\"bottom\", value:labels[\"chart-legend-bottom\"]}\n\t];\n}","import {ignoreReset, ignoreUndo}  from \"../operations/undo\";\nimport group  from \"../operations/undo_group\";\nimport {adjustSpan}  from \"../operations/spans\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (action, start, end) => {\n\t\tif (action.id == \"add\" || action.id == \"del\"){\n\t\t\tvar area = view._table.getSelectArea();\n\t\t\tif(area && !(start && end)){\n\t\t\t\tstart = area.start;\n\t\t\t\tend = area.end;\n\t\t\t}\n\n\t\t\tif (start && end){\n\t\t\t\tgroup.set(function(){\n\t\t\t\t\tprocess(action, start, end, view);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif (action == \"grid-change\"){\n\t\t\tloadChangedData(view, value);\n\t\t}\n\t});\n}\n\nfunction process(action, start, end, view) {\n\tlet select = view._table.getSelectArea();\n\tconst state = view._table.getScrollState();\n\n\tconst oldData = view.serialize({math: true, viewIds:true});\n\tconst newData = webix.copy(oldData);\n\tconst data = {value:oldData, newValue:newData};\n\n\tconst spanData = [];\n\tconst spans = newData.spans;\n\tfor (let i in spans){\n\t\tconst span = adjustSpan(spans[i], action, start, end, view, newData.data, spanData);\n\t\tif (span[2] <= 0 || span[3] <= 0)\n\t\t\tspans.splice(i, 1);\n\t}\n\n\tconst values = getUpdateValues(action, start, end);\n\tignoreUndo(function(){\n\t\tview.callEvent(\"onAction\", [\"before-grid-change\", {\n\t\t\tname: values.name,\n\t\t\tinc: values.inc,\n\t\t\tdata: newData,\n\t\t\tstart: start\n\t\t}]);\n\t},view);\n\n\tif (action.group == \"column\"){\n\t\tif (action.id == \"add\")\n\t\t\t_addColumn(action, start, end, view);\n\t\telse if (action.id == \"del\")\n\t\t\t_delColumn(action, start, end, view);\n\t}\n\telse if (action.group == \"row\") {\n\t\tif (action.id == \"add\")\n\t\t\t_addRow(action, start, end, view);\n\t\telse if (action.id == \"del\")\n\t\t\t_delRow(action, start, end, view);\n\t}\n\n\t// muon updates data and ranges\n\tconst updatedData = view.serialize({math: true});\n\tnewData.data = updatedData.data;\n\tnewData.ranges = updatedData.ranges;\n\n\tspanData.forEach(item => {\n\t\tnewData.data.push(item);\n\t});\n\n\tview.callEvent(\"onAction\", [\"grid-change\", data]);\n\n\tignoreUndo(function() {\n\t\tloadChangedData(view, newData);\n\t\tview._table.scrollTo(state.x, state.y);\n\t},view);\n\n\tif (select){\n\t\tconst grid = view.$$(\"cells\");\n\t\tselect = fixSelectArea(select, grid);\n\t\tif (select)\n\t\t\tgrid.addSelectArea(select.start, select.end);\n\t}\n}\n\nfunction fixSelectArea(select, grid){\n\tvar rows = grid.count();\n\tvar cols = grid.config.columns.length;\n\tif (select.start.row*1 > rows) return null;\n\tif (select.end.row*1 > rows) return null;\n\tif (select.start.column*1 > cols) return null;\n\tif (select.end.column*1 > cols) return null;\n\t\n\treturn select;\n}\n\nfunction loadChangedData(view, data){\n\t// data loading resets undo history, and\n\t// we need to preserve it\n\tignoreReset(function(){\n\t\tview.$handleSelection = null;\n\t\tview.parse(data);\n\t});\n}\n\nfunction getUpdateValues( action, start, end){\n\tvar name = action.group,\n\t\tinc = action.id==\"add\"?1:(action.id==\"del\"?-1:0);\n\n\tif(inc) {\n\t\t// span support\n\t\tif (name == \"row\")\n\t\t\tinc += inc * (end.row - start.row);\n\t\tif (name == \"column\")\n\t\t\tinc += inc * (end.column - start.column);\n\t}\n\treturn {name: name, inc: inc};\n}\n\nfunction _addColumn(action, start, end, view) {\n\tlet count = end.column - start.column + 1;\n\n\tview._mPage.addColumn(start.column-1, count);\n\tview.config.columnCount += count;\n\n\tview.callEvent(\"onColumnOperation\", [action, start, end]); //add item to history\n}\n\nfunction _delColumn(action, start, end, view) {\n\tlet count = end.column - start.column + 1;\n\n\tif (view.config.columnCount === count){\n\t\tif (start.column == end.column)\n\t\t\treturn; //deleting last column, ignoring\n\t\t//prevent deleting all columns\n\t\tend.column--;\n\t\tcount--;\n\t}\n\n\tview._mPage.removeColumn(start.column-1, count);\n\tview.config.columnCount -= count;\n\n\tview.callEvent(\"onColumnOperation\", [action, start, end]);\n}\n\nfunction _addRow(action, start, end, view) {\n\tlet count = end.row - start.row + 1;\n\n\tview._mPage.addRow(start.row-1, count);\n\tview.config.rowCount += count;\n\n\tview.callEvent(\"onRowOperation\", [action, start, end]);\n}\n\nfunction _delRow(action, start, end, view) {\n\tlet count = end.row - start.row + 1;\n\n\tif (view.config.rowCount === count){\n\t\tif (start.row == end.row)\n\t\t\treturn; //deleting last column, ignoring\n\t\t//prevent deleting all columns\n\t\tend.row--;\n\t\tcount--;\n\t}\n\n\tview._mPage.removeRow(start.row-1, count);\n\tview.config.rowCount -= count;\n\n\tview.callEvent(\"onRowOperation\", [action, start, end]);\n}","import group from \"./undo_group\";\nimport {setSpanCss} from \"./spans\";\nimport {rangeOptions} from \"../mathematics/ranges\";\nimport * as fmt from \"../operations/formats\";\nimport {changeRange, eachRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tconst table = view._table;\n\n\tview.attachEvent(\"onReset\", () => reset(view));\n\treset(view);\n\n\ttable.attachEvent(\"onBeforeEditStart\", function(id){\n\t\tlet col = this.getColumnConfig(id.column);\n\t\tif (this._ssEditors[id.row]){\n\t\t\tlet ed = this._ssEditors[id.row][id.column];\n\t\t\tif (ed){\n\t\t\t\twebix.extend(col, ed, true);\n\t\t\t\twebix.extend(col, {row: view.getRow(id.row)}, true);\n\t\t\t\tif (ed.options){\n\t\t\t\t\tif (typeof ed.options == \"string\")\n\t\t\t\t\t\tcol.options = rangeOptions(view, ed.options, { unique:true, order:true, empty:true });\n\t\t\t\t\telse if (webix.isArray(ed.options))\n\t\t\t\t\t\tcol.options = rangeOptions(view, ed.options, { empty:true });\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// update format if editor supports this feature\n\ttable.attachEvent(\"onBeforeEditStop\", function(state, editor, ignore){\n\t\tif (!ignore && editor.getFormat){\n\t\t\tconst value = editor.getValue();\n\t\t\tlet format = editor.getFormat(value);\n\n\t\t\tgroup.set(function(){\n\t\t\t\tview.setCellValue(editor.row, editor.column, value);\n\t\t\t\tif (format){\n\t\t\t\t\tfmt.addFormat(view, editor.row, editor.column, fmt.getFormatSource(format));\n\t\t\t\t} else\n\t\t\t\t\tfmt.removeFormat(view, editor.row, editor.column);\n\t\t\t});\n\n\t\t\tconst cell = view.getSelectedId();\n\t\t\tif (cell && cell.row == editor.row && cell.column == editor.column){\n\t\t\t\tformat = format || \"common\";\n\t\t\t\tformat = fmt.isCustom(format) ? \"custom\" : format;\n\t\t\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"format\", value:format}]);\n\t\t\t}\n\t\t}\n\t});\n\n\ttable.attachEvent(\"onAfterEditStop\", function(state, editor){\n\t\tconst col = this.getColumnConfig(editor.column);\n\n\t\tcol.editor = \"text\";\n\t\tdelete col.popup; delete col.$popup; delete col.row;\n\t});\n\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif (type == \"dropdown\")\n\t\t\tview.setCellEditor(row, column, value);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p) => {\n\t\tif (action == \"dropdown\"){\n\t\t\tsetSpanCss(view, p.row, p.column, \"ss_editor\", p.newValue);\n\t\t}\n\t\telse if (action == \"before-grid-change\")\n\t\t\tupdatePosition(view, p.name, p.inc, p.data, p.start);\n\t});\n}\n\nfunction reset(view){\n\tview._table._ssEditors = {};\n}\n\nexport function serialize(view,data){\n\tvar row, column,\n\t\ttblEditors = view._table._ssEditors,\n\t\teditors = [];\n\n\tfor (row in tblEditors){\n\t\tfor (column in tblEditors[row])\n\t\t\teditors.push([row, column, tblEditors[row][column]]);\n\t}\n\tdata.editors = editors;\n}\n\nexport function load(view,data){\n\tconst editors = data.editors;\n\n\tif (editors)\n\t\tfor (let i=0; i<editors.length; i++)\n\t\t\tview.setCellEditor.apply(view, editors[i]);\n}\n\nexport function clearEditors(view, range){\n\tview._table.editStop();\n\teachRange(range, view, function(view, cell){\n\t\tlet editor = view._table._ssEditors[cell.row];\n\t\tif (editor){\n\t\t\tif (editor[cell.column]){\n\t\t\t\tdelete editor[cell.column];\n\t\t\t\tview._table.removeCellCss(cell.row, cell.column, \"ss_editor\");\n\t\t\t\tsetSpanCss(view, cell.row, cell.column, \"ss_editor\", false);\n\t\t\t}\n\t\t}\n\t});\n}\n\nexport function isEditor(view, row, column){\n\tconst editor = view._table._ssEditors;\n\treturn editor[row] && !!editor[row][column];\n}\n\n// called on column/row add, delete, hide,show\nfunction updatePosition(view, name, inc, data, start){\n\tconst editors = data.editors;\n\n\tif (inc){\n\t\t// create new editors\n\t\tfor(let i=editors.length-1; i>=0; i--){\n\t\t\tlet [row,column,editor] = editors[i];\n\t\t\tif (name == \"row\" && row >= start.row || name == \"column\" && column >= start.column){\n\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc){\t//delete editor mark if row was deleted\n\t\t\t\t\t\teditors.splice(i,1);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\teditors[i][0] = row*1 + inc;\n\t\t\t\t}\n\t\t\t\telse if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\teditors.splice(i, 1);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else \n\t\t\t\t\t\teditors[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t\teditor.options = changeRange(editor.options, name, inc, start);\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function pasteDropdown(view, extra, row, col, cutted){\n\tconst editor = extra.dropdown;\n\n\tview.setCellEditor(row, col, editor);\n\tif (cutted === 1)\n\t\tview.setCellEditor(extra.row, extra.col, {});\n}","import group from \"./undo_group\";\nimport {pasteCondition} from \"../operations/conditional_formats\";\nimport {pasteDropdown} from \"../operations/dropdown\";\nimport {pasteFilter} from \"../operations/filter\";\nimport {pasteSpan} from \"../operations/spans\";\n\nvar styledata, clipdata, origin, cutted, updateFilters;\n\nexport function init(view){\n\tconst clipboard = view.config.clipboard;\n\tif(clipboard === false)\n\t\treturn;\n\n\twebix.clipbuffer.init();\n\n\tconst keyC = 67; //keyboard 'c' code\n\tconst keyX = 88; //keyboard 'x' code\n\tvar grid = view.$$(\"cells\");\n\n\tgrid.attachEvent(\"onAfterAreaAdd\", () => _sel_to_clip(view));\n\n\tgrid.attachEvent(\"onKeyPress\", (code, e) => {\n\t\tif((code === keyC || code === keyX) && (e.ctrlKey || e.metaKey) && grid.getSelectedId()){\n\t\t\tstyledata = _get_sel_style(view, grid);\n\t\t\tclipdata = document.querySelector(\".webix_clipbuffer\").value;\n\t\t\torigin = grid.getSelectArea();\n\t\t\tcutted = (code === keyX)*1;\n\t\t\tif(cutted && Object.keys(view._table._ssFilters).length !== 0)\n\t\t\t\tupdateFilters = allFiltersInZone(view._table._ssFilters, origin, view.config.columnCount);\n\t\t}\n\t});\n\n\tif (!view.config.readonly) {\n\t\tgrid.attachEvent(\"onPaste\", (text) => {\n\t\t\t_clip_to_sel(view, grid, text);\n\t\t});\n\t}\n}\n\nfunction _sel_to_clip(view){\n\tconst grid = view.$$(\"cells\");\n\tif(grid.getSelectedId())\n\t\twebix.delay(()=>{\n\t\t\tconst data = [];\n\t\t\tgrid.mapSelection(function(value, row, col, row_ind) {\n\t\t\t\tvalue = view._mPage.getValue(row-1, col-1);\n\t\t\t\tconst delimiter = view.config.clipboardDecimalDelimiter;\n\t\t\t\tif(!webix.isUndefined(delimiter))\n\t\t\t\t\tvalue = _updateDelimiter(value, delimiter);\n\t\t\t\tif (!data[row_ind]) data[row_ind] = [];\n\t\t\t\tdata[row_ind].push(value);\n\t\t\t});\n\t\t\tconst clipdata = webix.csv.stringify(data, grid.config.delimiter);\n\n\t\t\tdocument.querySelector(\".webix_clipbuffer\").focus();\n\n\t\t\twebix.clipbuffer.set(clipdata);\n\t\t\twebix.UIManager.setFocus(grid);\n\t\t});\n}\n\nfunction _updateDelimiter(value, clipboardDecimalDelimiter) {\n\tif(webix.rules.isNumber(value))\n\t\tvalue = value.toString().replace(\".\", clipboardDecimalDelimiter);\n\treturn value;\n}\n\nfunction _clip_to_sel(view, grid, text){\n\tvar leftTop = grid.getSelectArea();\n\tif (!leftTop) return;\n\tvar start = leftTop.start;\n\tvar fromSheet = text === clipdata;\n\n\tvar data = fromSheet ? styledata : webix.csv.parse(text, grid.config.delimiter);\n\tif(!fromSheet && view.config.clipboardDecimalDelimiter)\n\t\tdata = _changeDelimiter(data, view.config.clipboardDecimalDelimiter);\n\n\tvar translate = { id:\"move\", column:0, row: 0, cut:cutted };\n\tif (fromSheet){\n\t\ttranslate.column = start.column - origin.start.column;\n\t\ttranslate.row = start.row - origin.start.row;\n\t} else {\n\t\tcutted = 0;\n\t}\n\n\tgroup.set(function(){\n\t\tif (updateFilters)\n\t\t\tview.removeFilters();\n\n\t\t_add_row_col(view, start, data);\n\n\t\tif (cutted === 1) {\n\t\t\tfor (let row = origin.start.row; row <= origin.end.row; row++) {\n\t\t\t\tfor (let column = origin.start.column; column <= origin.end.column; column++) {\n\t\t\t\t\tview.setCellValue(row, column, null);\n\t\t\t\t\tview.setStyle(row, column, null);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (data.length == 1 && data[0].length == 1 && !updateFilters) {\n\t\t\tview.eachSelectedCell(function(cell) {\n\t\t\t\tvar subtrans = {\n\t\t\t\t\tid: \"move\",\n\t\t\t\t\tcolumn: translate.column + cell.column * 1 - start.column,\n\t\t\t\t\trow: translate.row + cell.row * 1 - start.row,\n\t\t\t\t\tcut:cutted\n\t\t\t\t};\n\t\t\t\t_clipboardToTable(view, cell.row, cell.column, data[0][0], fromSheet, subtrans);\n\t\t\t});\n\t\t} else {\n\t\t\tgrid.mapCells(\n\t\t\t\tstart.row,\n\t\t\t\tstart.column,\n\t\t\t\tdata.length,\n\t\t\t\tnull,\n\t\t\t\tfunction(value, row, col, row_ind, col_ind) {\n\t\t\t\t\tif (data[row_ind] && data[row_ind].length > col_ind) {\n\t\t\t\t\t\tvar cdata = data[row_ind][col_ind];\n\t\t\t\t\t\t_clipboardToTable(view, row, col, cdata, fromSheet, translate);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\n\t\tif (cutted === 1){\n\t\t\t//cut and cleared\n\t\t\tcutted = 2;\n\t\t\tupdateFilters = false;\n\t\t}\n\t});\n\t\n\tview.refresh();\n}\n\nfunction _clipboardToTable(view, row, col, cdata, fromSheet, translate){\n\tlet newValue = cdata;\n\n\tif (typeof cdata === \"object\"){\n\t\tif (cdata.math){\n\t\t\tif(translate.cut)\n\t\t\t\tnewValue = cdata.math;\n\t\t\telse\n\t\t\t\tnewValue = view._mData.getStore().transposeMath(cdata.math, translate.row, translate.column);\n\t\t}\n\t\telse\n\t\t\tnewValue = cdata.text;\n\n\t\tif(cdata.style && cdata.style.props){\n\t\t\tconst style = view.addStyle(cdata.style.props);\n\t\t\tview.setStyle(row, col, style);\n\t\t}\n\n\t\tconst extra = cdata.extra;\n\t\tif(extra){\n\t\t\tif(extra.condition)\n\t\t\t\tpasteCondition(view, extra, row, col, cutted);\n\t\t\tif(extra.dropdown)\n\t\t\t\tpasteDropdown(view, extra, row, col, cutted, translate);\n\t\t\tif(extra.filter && updateFilters)\n\t\t\t\tpasteFilter(view, extra, row, col, cutted, translate);\n\t\t}\n\t\tpasteSpan(view, extra, row, col, cutted, translate);\n\t}\n\n\tview.setCellValue(row, col, newValue);\n}\n\nfunction _get_sel_style(view, grid){\n\tvar data = [];\n\tvar row, last;\n\n\tgrid.mapSelection(function(value, id, col) {\n\t\tif (id != last){\n\t\t\trow = []; data.push(row);\n\t\t\tlast = id;\n\t\t}\n\n\t\tvar math =  view._mPage.getValue(id-1, col-1, true);\n\t\tmath = math && math[0] == \"=\" ? math : null;\n\t\tvalue = view._mPage.getValue(id-1, col-1);\n\t\tvar obj = { text:value, math, style:view.getStyle(id, col) };\n\n\t\tvar condition = view.conditions.get(id,col);\n\t\tvar editor = view.getCellEditor(id, col);\n\t\tvar filter = view.getCellFilter(id, col);\n\t\tvar span = view._table.getSpan(id, col);\n\n\t\tif (editor || filter || condition || span){\n\t\t\tvar extra = { row:id, col:col };\n\t\t\tif (condition) extra.condition = condition;\n\t\t\tif (editor) extra.dropdown = editor;\n\t\t\tif (filter) extra.filter = filter;\n\t\t\tif (span) extra.span = span;\n\t\t\tobj.extra = extra;\n\t\t}\n\n\t\trow.push(obj);\n\t\treturn value;\n\t});\n\n\treturn data;\n}\n\nfunction allFiltersInZone(extra, origin, columnCount){\n\tvar filters = Object.keys(extra);\n\tvar startRow = Math.min.apply(null, filters);\n\tvar endRow = Math.max.apply(null, filters);\n\tvar startCol = columnCount;\n\tvar endCol = 1;\n\n\tfor (var i = startRow; i <= endRow; i++){\n\t\tif(extra[i]){\n\t\t\tvar columns = Object.keys(extra[i]);\n\t\t\tstartCol = Math.min(startCol, Math.min.apply(null, columns));\n\t\t\tendCol = Math.max(endCol, Math.max.apply(null, columns));\n\t\t}\n\t}\n\n\tif(origin.start.row <= startRow && origin.end.row >= endRow && origin.start.column <= startCol && origin.end.column >= endCol)\n\t\treturn true;\n\telse\n\t\treturn false;\n}\n//dynamically increase rows and columns according to pasted data size\nfunction _add_row_col(view, start, data){\n\tvar maxRow = start.row + data.length - 1;\n\tvar maxCol = start.column + data[0].length - 1;\n\n\tif(maxRow > view.config.rowCount || maxCol > view.config.columnCount){\n\t\tvar action = { id:\"add\" };\n\t\tif (maxRow > view.config.rowCount) {\n\t\t\taction.group = \"row\";\n\t\t\tview.callEvent(\"onCommand\", [\n\t\t\t\taction, \n\t\t\t\t{ row: view.config.rowCount + 1 }, \n\t\t\t\t{ row: maxRow }\n\t\t\t]);\n\t\t}\n\t\tif (maxCol > view.config.columnCount) {\n\t\t\taction.group = \"column\";\n\t\t\tview.callEvent(\"onCommand\", [\n\t\t\t\taction, \n\t\t\t\t{ column: view.config.columnCount + 1 },\n\t\t\t\t{ column: maxCol }\n\t\t\t]);\n\t\t}\n\t}\n}\n\nfunction _changeDelimiter(data, clipboardDecimalDelimiter){\n\tfor(var i = 0; i < data.length; i++)\n\t\tfor(var k = 0; k < data[i].length; k++){\n\t\t\tvar record = data[i][k].toString().replace(clipboardDecimalDelimiter, \".\");\n\t\t\tif(webix.rules.isNumber(record))\n\t\t\t\tdata[i][k] = record;\n\t\t}\n\treturn data;\n}","export function init(view) {\n\tview.attachEvent(\"onCommand\", (action) => {\n\t\tif (action.id == \"show\" || action.id == \"hide\"){\n\t\t\tconst sel = view._table.getSelectArea();\n\t\t\tif (sel)\n\t\t\t\tprocess(action, webix.copy(sel.start), webix.copy(sel.end), view);\n\t\t}\n\t});\n\treset(view);\n\n\tview.attachEvent(\"onUndo\", (action, row, column, value, direction) => {\n\t\tif ((action.id == \"hide\" || action.id == \"show\") && (action.group == \"column\" || action.group == \"row\")){\n\t\t\tlet type = action.id;\n\t\t\tif (!direction)\n\t\t\t\ttype = type == \"hide\" ? \"show\" : \"hide\";\n\t\t\tconst obj = (row || column);\n\t\t\tprocess({ id: type, group: action.group }, obj.start, obj.end, view, true);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onHardReset\", () => reset(view));\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\t_updatePosition(view, p.name, p.inc, p.data, p.start);\n\t});\n}\n\nexport function reset(view, mode) {\n\tif(mode) view[\"_hidden_\"+mode+\"_hash\"] = {};\n\telse{\n\t\tview._hidden_cols_hash = {};\n\t\tview._hidden_rows_hash = {};\n\t\tview.filterSpreadSheet();\n\t}\n}\n\nfunction getIds(id){\n\treturn webix.isArray(id) ? id : [id, id];\n}\n\nexport function isColumnVisible(view, column){\n\treturn !view._hidden_cols_hash[column];\n}\n\nexport function setState(view, indexes, state, type){\n\t// hide\n\tif(!indexes){\n\t\tconst sel = view.getSelectedId(true);\n\t\tconst action = {\n\t\t\tid: state === false ? \"show\" : \"hide\",\n\t\t\tgroup: type\n\t\t};\n\n\t\tif(sel.length)\n\t\t\tview.callEvent(\"onCommand\", [action, sel[0], sel[sel.length-1]]);\n\t}\n\telse {\n\t\tconst ids = getIds(indexes);\n\t\tconst hidden = type == \"row\" ? view._hidden_rows_hash : view._hidden_cols_hash;\n\n\t\tif (!hidden[ids[0]] && (webix.isUndefined(state) || state)){\n\t\t\t(type == \"row\" ? _hideRow : _hideColumn)({id: \"hide\", group: type}, {[type]: ids[0]}, {[type]: ids[1]}, view);\n\t\t}\n\t\t// show\n\t\telse if (hidden[ids[0]] && (webix.isUndefined(state) || !state)) {\n\t\t\tconst inc = ids[0] > 1 ? 1 : -1;\n\t\t\t(type == \"row\" ? _showRow : _showColumn)({id: \"hide\", group: type}, {[type]: ids[0] + inc}, {[type]: ids[1] + inc}, view);\n\t\t}\n\t}\n}\n\nexport function isRowVisible(view, row){\n\treturn !view._hidden_rows_hash[row];\n}\n\nexport function serialize(view, data){\n\tlet hrows  = []; let hcols = [];\n\tfor(let r in view._hidden_rows_hash) hrows.push(r);\n\tfor(let c in view._hidden_cols_hash) hcols.push(c);\n\n\tif(hrows.length || hcols.length)\t\n\t\tdata.table.hidden = {};\n\tif(hrows.length)\n\t\tdata.table.hidden.row = hrows;\n\tif(hcols.length)\n\t\tdata.table.hidden.column = hcols;\n}\n\nexport function load(view, data){\n\treset(view);\n\t\n\tif(!webix.isUndefined(data.table) && !webix.isUndefined(data.table.hidden)){\n\t\tconst hidden = data.table.hidden;\n\n\t\tif(hidden.row && hidden.row.length){\n\t\t\tfor(let r = 0; r < hidden.row.length; r++)\n\t\t\t\t_hideRow({id:\"hide\", group:\"row\"}, {row:hidden.row[r]}, {row:hidden.row[r]}, view, true);\n\t\t}\n\n\t\tif(hidden.column && hidden.column.length){\n\t\t\tfor(let c = 0; c < hidden.column.length; c++)\n\t\t\t\t_hideColumn({id:\"hide\", group:\"column\"}, {column:hidden.column[c]}, {column:hidden.column[c]}, view, true);\n\t\t}\n\t}\n}\n\nfunction process(action) {\n\tif (action.group == \"column\"){\n\t\tif (action.id == \"show\")\n\t\t\t_showColumn.apply(this, arguments);\n\t\telse if (action.id == \"hide\")\n\t\t\t_hideColumn.apply(this, arguments);\n\t} else if (action.group == \"row\") {\n\t\tif (action.id == \"show\")\n\t\t\t_showRow.apply(this, arguments);\n\t\telse if (action.id == \"hide\")\n\t\t\t_hideRow.apply(this, arguments);\n\t}\n}\n\nfunction _showColumn(action, start, end, view, silent) {\n\tlet i = end.column;\n\tconst grid = view.$$(\"cells\");\n\n\twhile (i >= start.column) {\n\t\tlet id = i;\n\t\tif (!silent)\n\t\t\tid = view._hidden_cols_hash[i*1-1] || view._hidden_cols_hash[i*1+1] || false;\n\n\t\tif (id !== false) {\n\t\t\tdelete view._hidden_cols_hash[id];\n\t\t\tlet cell = grid.getColumnConfig(id - 1 || \"rowId\").header[0];\n\t\t\tcell.css = cell.css.replace(\"webix_ssheet_hide_column\", \"\");\n\t\t\tgrid.showColumn(id);\n\t\t\tstart.column = start.column < id ? start.column : id;\n\t\t\tend.column = end.column > id ? end.column : id;\n\n\t\t\tif (!silent)\n\t\t\t\tview.callEvent(\"onColumnOperation\", [action, { column: id }, { column:id }, null]);\n\t\t}\n\t\ti--;\n\t}\n\n\tconst split = view._frozenColumns;\n\tif(split && split >= start.column && split <= end.column){\n\t\tview.freezeColumns(0); // remove freeze (split is equal with current frozen col)\n\t\tview.freezeColumns(split); // if col was freezed on hidden column - move it\n\t}\n}\n\nfunction _showRow(action, start, end, view, silent) {\n\tlet i = end.row;\n\tconst grid = view.$$(\"cells\");\n\n\tconst split = view._frozenRows;\n\tif(split){\n\t\t//Frozen rows ignore filtering applied to the datatable\n\t\tview.freezeRows(0);\n\t}\n\n\twhile (i >= start.row) {\n\t\tlet id = i;\n\t\tif (!silent)\n\t\t\tid = view._hidden_rows_hash[i*1-1] || view._hidden_rows_hash[i*1+1] || false;\n\n\t\tif (id !== false) {\n\t\t\tdelete view._hidden_rows_hash[id];\n\t\t\tif (id - 1 === 0) {\n\t\t\t\tlet cell = grid.getColumnConfig(\"rowId\").header[0];\n\t\t\t\tcell.css = cell.css.replace(\"webix_ssheet_hide_row\", \"\");\n\t\t\t\tgrid.refreshColumns();\n\t\t\t} else {\n\t\t\t\tgrid.removeCellCss(id - 1, \"rowId\", \"webix_ssheet_hide_row\");\n\t\t\t}\n\t\t\tif (!silent)\n\t\t\t\tview.callEvent(\"onRowOperation\", [action, { row: id }, { row: id }, null]);\n\t\t}\n\t\ti--;\n\t}\n\n\tview.filterSpreadSheet();\n\n\tif(split)\n\t\tview.freezeRows(split);\n}\n\nfunction _hideColumn(action, start, end, view, silent) {\n\tconst grid = view.$$(\"cells\");\n\tlet i = end.column;\n\tview.$handleSelection = null;\n\tgrid.unselect();\n\n\tif (end.column<1 || start.column<1){\n\t\tdelete view._hidden_cols_hash[start.column];\n\t\treturn;\n\t}\n\twhile (i >= start.column) {\n\t\tif(grid.getColumnIndex(i) != -1){\n\t\t\tview._hidden_cols_hash[i] = i;\n\n\t\t\tlet cell = grid.getColumnConfig(i - 1 || \"rowId\").header[0];\n\t\t\tcell.css = (cell.css || \"\") + \" webix_ssheet_hide_column\";\n\n\t\t\tgrid.hideColumn(i);\n\t\t}\n\t\ti--;\n\t}\n\n\tif (!silent)\n\t\tview.callEvent(\"onColumnOperation\", [action, start, end, null]);\n}\n\nfunction _hideRow(action, start, end, view, silent) {\n\tif (end.row<1 || start.row<1){\n\t\tdelete view._hidden_rows_hash[start.row];\n\t\treturn;\n\t}\n\n\tconst split = view._frozenRows;\n\tif(split){\n\t\t//Frozen rows ignore filtering applied to the datatable\n\t\tview.freezeRows(0);\n\t}\n\n\tconst grid = view.$$(\"cells\");\n\tlet i = end.row;\n\n\twhile (i >= start.row) {\n\t\tview._hidden_rows_hash[i] = i;\n\n\t\tif (i - 1 === 0) {\n\t\t\tlet cell = grid.getColumnConfig(\"rowId\").header[0];\n\t\t\tcell.css = (cell.css || \"\") + \" webix_ssheet_hide_row\";\n\t\t\tgrid.refreshColumns();\n\t\t}\n\t\telse\n\t\t\tgrid.addCellCss(i - 1, \"rowId\", \"webix_ssheet_hide_row\");\n\n\t\ti--;\n\t}\n\n\tview.filterSpreadSheet();\n\n\tif(split)\n\t\tview.freezeRows(split);\n\n\tif (!silent)\n\t\tview.callEvent(\"onRowOperation\", [action, start, end, null]);\n}\n\nfunction _updatePosition(view, name, inc, data, start){\n\tif(data.table && data.table.hidden && data.table.hidden[name] && data.table.hidden[name].length){\n\t\tif(name ===\"column\") reset(view, \"cols\");\n\t\tif(name === \"row\") reset(view, \"rows\");\n\n\t\tlet s = start[name], e = s + inc;\n\t\tif(s > e) [s, e] = [e, s];\n\n\t\tfor(let i = s; i < e; i++){\n\t\t\tfor(let h = 0; h < data.table.hidden[name].length; h++){\n\t\t\t\tif(data.table.hidden[name][h] >= i)\n\t\t\t\t\tdata.table.hidden[name][h] = data.table.hidden[name][h]*1+(inc>0 ? 1: -1);\n\t\t\t}\n\t\t}\n\t}\n}","import {getStyle, getTextSize} from \"./styles\";\nimport {save} from \"./save\";\n\nexport function init(view){\n\n\tif (view.config.resizeCell){\n\t\tvar grid = view.$$(\"cells\");\n\t\tgrid.define(\"resizeRow\", { headerOnly: true, size: 10 });\n\t\tgrid.define(\"resizeColumn\", { headerOnly: true, size: 10 });\n\t\tgrid.define(\"fixedRowHeight\", false);\n\n\t\tgrid.attachEvent(\"onRowResize\", (id) => {\n\t\t\tview.$$(\"cells\").refreshSelectArea();\n\t\t\tsave(view, \"sizes\", { row: id, column: 0, size: view.$$(\"cells\").getItem(id).$height });\n\t\t});\n\t\tgrid.attachEvent(\"onColumnResize\", (id) => {\n\t\t\tview.$$(\"cells\").refreshSelectArea();\n\t\t\tsave(view, \"sizes\", { row: 0, column: id, size: view.getColumn(id).width });\n\t\t});\n\n\t\t// undo\n\t\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\t\tif(type == \"c-resize\" || type == \"r-resize\")\n\t\t\t\t_undoResize(view, row, column, value);\n\t\t});\n\t}\n\n\tview.attachEvent(\"onDataParse\", (data) => {\n\t\tload(view,data);\n\t});\n\n\t\n\tview.attachEvent(\"onDataSerialize\", (data) => {\n\t\tserialize(view,data);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(view, p.name,p.inc, p.data, p.start);\n\t});\n\n\tview.attachEvent(\"onBeforeStyleChange\", function(row, column, n, o){\n\t\tif (o && o.props.wrap === \"wrap\" && (!n || n.props.wrap != o.props.wrap)){\n\t\t\tdelete view._table.getItem(row).$height;\n\t\t}\n\t});\n\tview.attachEvent(\"onStyleChange\", _adjustRowHeight);\n\tview.attachEvent(\"onCellChange\",  _adjustRowHeight);\n}\n\nfunction serialize(view,data){\n\tvar sizes = [];\n\tvar grid = view.$$(\"cells\");\n\tvar columns = grid.getState().order;\n\tvar order = grid.data.order;\n\n\tvar defWidth = grid.config.columnWidth;\n\tvar defHeight = grid.config.rowHeight;\n\n\tfor (let i = 1; i < columns.length; i++){\n\t\tvar width = grid.getColumnConfig(columns[i]).width;\n\t\tif (width && width != defWidth)\n\t\t\tsizes.push([0, i, width]);\n\t}\n\n\tfor (let i = 0; i < order.length; i++){\n\t\tvar height = grid.getItem(order[i]).$height;\n\t\tif (height && height != defHeight)\n\t\t\tsizes.push([order[i]*1, 0, height]);\n\t}\n\t\n\tdata.sizes = sizes;\n}\n\nfunction load(view,data){\n\tif (data.sizes){\n\t\tfor (let i=0; i<data.sizes.length; i++){\n\t\t\tconst size = data.sizes[i];\n\t\t\tif (size[0]*1 !== 0){\n\t\t\t\tconst row = view.$$(\"cells\").getItem(size[0]);\n\t\t\t\tif(row) row.$height = size[2]*1;\n\t\t\t} else {\n\t\t\t\tconst col = view.getColumn(size[1]);\n\t\t\t\tif(col) col.width = size[2]*1;\n\t\t\t}\n\t\t}\n\t\tif (data.sizes.length)\n\t\t\tview.refresh(true);\n\t}\n}\n\nfunction _undoResize(view, row, column, value){\n\tif(row){\n\t\tview.$$(\"cells\").getItem(row).$height = value;\n\t\tsave(view, \"sizes\", { row:row, column: 0, size: value });\n\t}\n\telse{\n\t\tview._table.setColumnWidth(column, value);\n\t}\n\t// update area selection\n\tview._table.refreshSelectArea();\n}\n\nfunction updatePosition(view, name, inc, data, start){\n\tlet i,\n\t\tsizes = data.sizes,\n\t\tnsizes = [];\n\n\tif(inc){\n\t\tfor(i = sizes.length-1;i >=0;i--){\n\t\t\tlet [row,column,size] = sizes[i];\n\t\t\tif(row && name == \"row\" && row>= start.row || column && name == \"column\" && column >= start.column){\n\t\t\t\t//moving row|column index\n\t\t\t\trow =  name == \"row\"?row*1 + inc:row;\n\t\t\t\tcolumn = name == \"column\"?column*1 + inc:column;\n\t\t\t\tif((name == \"row\" && row>0) || (name == \"column\" && column >0))\n\t\t\t\t\tnsizes.push([row, column, size]);\n\t\t\t} else //row, column not affected by resize\n\t\t\t\tnsizes.push(sizes[i]);\n\t\t}\n\t\tdata.sizes = nsizes;\n\t}\n}\n\nfunction _adjustRowHeight(row, column){\n\tconst view = this;\n\tlet style = getStyle(view, {row:row, column:column});\n\n\t//changing styles or content of wrapped cell -> resize the related row\n\tif (style && style.props.wrap){\n\t\tlet item = view._table.getItem(row);\n\t\tlet height = item.$height || view._table.config.rowHeight;\n\n\t\tview._table.eachColumn(function(col, config){\n\t\t\tlet style = getStyle(view, {row:row, column:col});\n\t\t\t//include only cells with active wrap into calculation \n\t\t\tif(style && style.props && style.props.wrap === \"wrap\"){\n\t\t\t\tlet text = this.getText(row, col);\n\t\t\t\tlet baseWidth = config.width;\n\n\t\t\t\tconst span = view._table.getSpan(row, col);\n\t\t\t\tif(span)\n\t\t\t\t\tbaseWidth = view._table.getSpanNode({row:span[0], column:span[1]}).offsetWidth;\n\n\t\t\t\tif(view.getCellEditor(row, col) || view.getCellFilter(row, col))\n\t\t\t\t\tbaseWidth += 20;\n\n\t\t\t\theight = Math.max(height, getTextSize(view, text, style.id, baseWidth).height);\n\t\t\t}\n\t\t});\n\n\t\titem.$height  = height;\n\t}\n}\n","import {encode} from \"../helpers/column_names\";\n\nexport function init(view){\n\tvar table = view._table;\n\n\tvar bs = 0;\n\ttable.attachEvent(\"onAreaDrag\", () => bs = new Date());\n\ttable.attachEvent(\"onBeforeAreaRemove\", function(){\n\t\t//[FIXME] currently we don't have enough info to know\n\t\t//is user selects new area, and removing need to be blocked\n\t\t//or is it some API which attempts to remove the area\n\t\tif (view.$handleSelection && (new Date() - bs)<500) return false;\n\t});\n\n\ttable.attachEvent(\"onBeforeAreaAdd\", (area) => {\n\t\t//[FIXME] \n\t\t//block selection of row-id column\n\t\t//temporary fix, we need to fire onBeforeBlockSelect when selection moves\n\t\t//so the common onBeforeBlockSelect handler will block rowId selection\n\t\tif (area.start.column == \"rowId\") return false;\n\n\t\t//if we have an active editor, we need to close it on block selection\n\t\t//ignore, when selecting the editor's cell\n\t\tvar editor = table.getEditor();\n\t\tif (editor && (\n\t\t\teditor.row != area.start.row || editor.column != area.start.column ||\n\t\t\teditor.row != area.start.row || editor.column != area.start.column ))\n\t\t\ttable.editStop();\n\n\t\tif (!view.$handleSelection) return true;\n\t\t\n\n\t\tlet blockStart = encode[area.start.column] + area.start.row;\n\t\tlet blockEnd = encode[area.end.column] + area.end.row;\n\n\t\tvar res = view.$handleSelection(area.start, area.end, blockStart, blockEnd);\n\n\t\tif (res !== false){\n\t\t\tview.$handleSelection = null;\n\t\t\ttable.removeSelectArea();\n\t\t}\n\n\t\treturn res;\n\t});\n\n\twebix.event(table.$view, \"mousedown\", function(e){\n\t\tif (view.$handleSelection)\n\t\t\treturn webix.html.preventEvent(e);\n\t});\n}\n","export function expandSelection(r, view){\n\tlet maxY = view.config.rowCount;\n\tlet maxX = view.config.columnCount;\n\tlet table = view._table;\n\n\tlet nr1 = r.start.row, nr2 = r.end.row, nc1 = r.start.column, nc2 = r.end.column;\n\n\tfor (let i=nr1-1; i>0; i--){\n\t\tif (getValue(i, r.start.column, table))\n\t\t\tnr1 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nr2+1; i<maxY; i++){\n\t\tif (getValue(i, r.end.column, table))\n\t\t\tnr2 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nc1-1; i>0; i--){\n\t\tif (getValue(r.start.row, i, table))\n\t\t\tnc1 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nc2+1; i<maxX; i++){\n\t\tif (getValue(r.end.row, i, table))\n\t\t\tnc2 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tlet newrange = { start:{ row:nr1, column:nc1 } , end:{ row: nr2, column: nc2 }};\n\tif (nr1 != r.start.row || nr2 != r.end.row || nc1 != r.start.column || nc2 != r.end.column){\n\t\tview._table.addSelectArea(newrange.start, newrange.end);\n\t}\n\n\treturn newrange;\n}\n\nfunction getValue(r,c, table){\n\tvar value = table.getItem(r)[c];\n\tif(value === undefined || value === \"\"){\n\t\treturn false;\n\t} else {\n\t\treturn true;\n\t}\n}","import {expandSelection} from \"../helpers/expand_selection\";\nimport {rangeObj} from \"../helpers/column_names\";\nimport group from \"./undo_group\";\nimport {_changeCondition} from \"./conditional_formats\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"sort-asc\" || cm.id === \"sort-desc\")\n\t\t\tsortRange(view, null, cm.id.replace(\"sort-\",\"\"));\n\t});\n}\n\nconst sorters = {\n\t\"int\":function(dir, key){\n\t\treturn (a,b) => {\n\t\t\tif (!b[key]) return -1;\n\t\t\tif (!a[key]) return 1;\n\n\t\t\tlet c = parseFloat(a[key]) || dir*Infinity;\n\t\t\tlet d = parseFloat(b[key]) || dir*Infinity;\n\t\t\treturn (c > d ? 1 : (c == d ? 0 : -1))*dir;\n\t\t};\n\t},\n\t\"str\":function(dir, key){\n\t\treturn (a,b) => {\n\t\t\tif (!b[key]) return -1;\n\t\t\tif (!a[key]) return 1;\n\n\t\t\tlet c = a[key].toString().toLowerCase();\n\t\t\tlet d = b[key].toString().toLowerCase();\n\t\t\treturn (c > d ? 1 : (c == d ? 0 : -1))*dir;  \n\t\t};\n\t}\n};\n\nexport function sortRange(view, range, dir){\n\trange = range || view._table.getSelectArea();\n\n\tif (range){\n\t\trange = rangeObj(range, view);\n\t\tlet fullrange = range;\n\t\tif (range.start.row === range.end.row)\n\t\t\tfullrange = expandSelection(range, view);\n\n\t\tconst key = view.getCellValue(range.start.row, range.start.column, false);\n\t\tconst type = isNaN(parseFloat(key)) ? \"str\" : \"int\";\n\n\t\tdir = (!dir || dir === \"asc\") ? 1 : -1;\n\t\tgroup.set(()=>\n\t\t\tsort(fullrange, range.start.column, type, dir, view)\n\t\t);\n\t}\n}\n\nfunction sort(range, by, type, dir, view){\n\tfor (let column = range.start.column; column <= range.end.column; column++){\n\t\t//get all selected column values\n\t\tconst values = [];\n\t\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\t\tif(view.isRowVisible(row)){\n\t\t\t\tconst value = view.getCellValue(row, column, false);\n\t\t\t\tconst style = view.getStyle(row, column);\n\n\t\t\t\tlet math = view.getCellValue(row, column);\n\t\t\t\tmath = math && math[0] == \"=\" ? math : null;\n\n\t\t\t\tconst conditions = view.conditions.get(row,column);\n\t\t\t\tif(conditions)\n\t\t\t\t\t_changeCondition(\"remove\", row, column, conditions, null, view);\n\n\t\t\t\tvalues.push({\n\t\t\t\t\tvalue,\n\t\t\t\t\tstyle,\n\t\t\t\t\tmath,\n\t\t\t\t\trow,\n\t\t\t\t\tconditions\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t//sort them\n\t\tvalues.sort(sorters[type](dir, \"value\"));\n\n\t\t//set new values to original column\n\t\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\t\tif(view.isRowVisible(row)){\n\t\t\t\tconst element = values.shift();\n\n\t\t\t\tview.setStyle(row, column, (element.style || null));\n\t\t\t\tif(element.conditions)\n\t\t\t\t\t_changeCondition(\"update\", row, column, null, element.conditions, view);\n\n\t\t\t\tif (!element.math) view.setCellValue(row, column, element.value);\n\t\t\t\telse {\n\t\t\t\t\tconst newMath = view._mData.getStore().transposeMath(element.math, row - element.row, 0);\n\t\t\t\t\tview.setCellValue(row, column, newMath);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tview.refresh();\n}","import {split} from \"./parser\";\n\nfunction updateSheetNames(view, formula, oldName, newName){\n\tif(formula.indexOf(\"!\") == -1)\n\t\treturn formula;\n\n\tconst stack = split(formula, view, true);\n\tfor(let i = 0; i < stack.length; i++){\n\t\tif(webix.isArray(stack[i])){\n\t\t\tconst thisSheet = stack[i][0] === oldName;\n\t\t\tlet sheet = thisSheet ? newName : stack[i][0];\n\t\t\tif(sheet.indexOf(\" \") != -1)\n\t\t\t\tsheet = `'${sheet}'`;\n\t\t\tstack[i] = `${sheet}!${stack[i][1]}`;\n\t\t}\n\t}\n\treturn stack.join(\"\");\n}\n\nfunction isFormula(val){\n\treturn typeof val == \"string\" && val[0] == \"=\";\n}\n\nexport function init(view){\n\tview.attachEvent(\"onSheetRename\", (name, newName) => {\n\t\tview._sheets.forEach(sheet => {\n\t\t\tconst activeSheet = sheet.name == view.getActiveSheet();\n\t\t\tif(activeSheet)\n\t\t\t\tsheet.content = view.serialize(); //actual data\n\n\t\t\tif(sheet.content.editors){\n\t\t\t\tsheet.content.editors.forEach(value => {\n\t\t\t\t\tconst options = value[2].options;\n\t\t\t\t\tif(options){\n\t\t\t\t\t\tif(typeof options == \"string\")\n\t\t\t\t\t\t\tvalue[2].options = updateSheetNames(view, options, name, newName);\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tfor (let i = 0; i < options.length; i++){\n\t\t\t\t\t\t\t\tconst option = options[i];\n\t\t\t\t\t\t\t\tif(typeof option == \"string\"){\n\t\t\t\t\t\t\t\t\tif(isFormula(option))\n\t\t\t\t\t\t\t\t\t\toptions[i] = updateSheetNames(view, option, name, newName);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse if(isFormula(option.id))\n\t\t\t\t\t\t\t\t\toption.id = updateSheetNames(view, option.id, name, newName);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif(sheet.content.conditions){\n\t\t\t\tsheet.content.conditions.forEach(value => {\n\t\t\t\t\tif(isFormula(value[3]))\n\t\t\t\t\t\tvalue[3] = updateSheetNames(view, value[3], name, newName);\n\t\t\t\t});\n\t\t\t\tif(activeSheet){\n\t\t\t\t\tview.conditions.clear();\n\t\t\t\t\tview.conditions.parse( sheet.content.conditions );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n}","export function init(view) {\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif (action == \"gridlines-hide\"){\n\t\t\thideGridlines(view, value);\n\t\t}\n\t});\n}\n\nexport function hideGridlines(view, state = true){\n\tvar grid = view.$$(\"cells\");\n\tvar borderless = grid.$view.className.indexOf(\"webix_borderless\") !=-1;\n\tif (state === \"toggle\")\n\t\tstate = !borderless;\n\n\tif(!borderless && state){\n\t\twebix.html.addCss( grid.$view, \"webix_borderless\", true);\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"hide-gridlines\", value:true}]);\n\t\tview.callEvent(\"onAction\", [\"gridlines-hide\", {newValue:true, value: false}]);\n\t}\n\telse if(borderless && !state){\n\t\twebix.html.removeCss( grid.$view, \"webix_borderless\");\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"hide-gridlines\", value:false}]);\n\t\tview.callEvent(\"onAction\", [\"gridlines-hide\", {newValue:false, value: true}]);\n\t}\n}\n\nexport function serialize(view, data){\n\tdata.table.gridlines = view.$$(\"cells\").$view.className.indexOf(\"webix_borderless\") !=-1?0:1;\n}\n\nexport function load(view, data){\n\tvar mode = false;\n\tif(!webix.isUndefined(data.table) && !webix.isUndefined(data.table.gridlines))\n\t\tmode = !data.table.gridlines;\n\thideGridlines(view, mode);\n}","export function init(view) {\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif (action == \"header-hide\"){\n\t\t\thideHeaders(view, value);\n\t\t}\n\t});\n}\n\nexport function hideHeaders(view, state = true){\n\tvar grid = view.$$(\"cells\");\n\tif (state === \"toggle\")\n\t\tstate = grid.config.header;\n\n\tif(grid.config.header && state){\n\t\tgrid.config.header = false;\n\t\tif (grid.isColumnVisible(\"rowId\"))\n\t\t\tgrid.hideColumn(\"rowId\", {}, true, true);\n\t\tgrid.refreshColumns();\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"hide-headers\", value:true}]);\n\t\tview.callEvent(\"onAction\", [\"header-hide\", {newValue:true, value:false}]);\n\t}\n\telse if(!grid.config.header && !state){\n\t\tgrid.config.header = true;\n\t\tif (!grid.isColumnVisible(\"rowId\"))\n\t\t\tgrid.showColumn(\"rowId\", {}, true);\n\t\tgrid.refreshColumns();\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"hide-headers\", value:false}]);\n\t\tview.callEvent(\"onAction\", [\"header-hide\", {newValue:false, value:true}]);\n\t}\n}\n\nexport function serialize(view, data){\n\tdata.table.headers = view.$$(\"cells\").config.header?1:0;\n}\n\nexport function load(view, data){\n\tvar mode = false;\n\tif(data.table && !webix.isUndefined(data.table.headers))\n\t\tmode = !data.table.headers;\n\thideHeaders(view, mode);\n}","import group from \"./undo_group\";\nimport {eachRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tview.comments = {\n\t\tget: function(row, column){\n\t\t\treturn getComment(view, row, column);\n\t\t},\n\t\tadd: function(row, column, comment){\n\t\t\tcommentCell(view, row, column, comment);\n\t\t},\n\t\tremove: function(row, column){\n\t\t\tremoveComment(view, row, column);\n\t\t},\n\t\t_activeComment: {},\n\t\t_pull:{}\n\t};\n\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif (type === \"comment\")\n\t\t\t_undoComment(view, row, column, value);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(view, p.name,p.inc,p.data, p.start);\n\t});\n}\n\nfunction _undoComment(view, row, column, value){\n\tif(getComment(view, row, column))\n\t\tremoveComment(view, row, column, true);\n\tif(value)\n\t\tcommentCell(view, row, column, value, true);\n}\n\nfunction reset(view){\n\tview.comments._pull = {};\n}\n\nfunction removeComment(view, row, column, silent){\n\tif(getComment(view, row, column)){\n\t\tif (!silent)\n\t\t\tview.callEvent(\"onAction\", [\"comment\", {row, column, newValue: null, value: view.comments._pull[row][column]}]);\n\t\tdelete view.comments._pull[row][column];\n\t}\n\tview.$$(\"cells\").updateItem(row,column);\n}\n\nexport function removeCommentsRange(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tif(getComment(view, cell.row, cell.column))\n\t\t\t\tremoveComment(view, cell.row, cell.column);\n\t\t});\n\t\tview.$$(\"cells\").refresh();\n\t});\n}\n\nfunction commentCell(view, row, column, comment, silent){\n\tvar oldValue = getComment(view, row, column) ? view.comments._pull[row][column] : null;\n\tvar table = view.$$(\"cells\");\n\n\tif(typeof comment == \"string\")\n\t\tcomment = comment.trim() ? comment : \"\";\n\tview.comments._pull[row] = view.comments._pull[row] ? view.comments._pull[row] : {};\n\tview.comments._pull[row][column] = comment;\n\n\ttable.addCellCss(row, column, \"ssheet_commented_cell\");\n\n\tif (!silent)\n\t\tview.callEvent(\"onAction\", [\"comment\", {row, column, newValue:comment, value:oldValue}]);\n}\n\nexport function serialize(view,data){\n\tvar row, column,\n\t\tcomments = [];\n\tfor(row in view.comments._pull){\n\t\tfor(column in view.comments._pull[row])\n\t\t\tif(view.comments._pull[row][column])\n\t\t\t\tcomments.push([row, column, view.comments._pull[row][column]]);\n\t}\n\tdata.comments = comments;\n}\n\nexport function load(view,data){\n\tvar i,\n\t\tcomments = data.comments;\n\n\tif(comments)\n\t\tfor(i = 0; i < comments.length; i++)\n\t\t\tcommentCell(view, comments[i][0], comments[i][1], comments[i][2], true);\n}\n\nfunction updatePosition(view, name, inc, data, start){\n\tlet comments = data.comments,\n\t\ti = comments.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = comments[i];\n\t\t\tif(row && name == \"row\" && row>= start.row || column && name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete comment if row was deleted\n\t\t\t\t\t\tcomments.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tcomments[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tcomments.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tcomments[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction getComment(view, row, column){\n\treturn view.comments._pull[row] && view.comments._pull[row][column] ? view.comments._pull[row][column] : \"\";\n}","import * as m1  from \"./hide_gridlines\";\nimport * as m2  from \"./hide_headers\";\nimport * as m3  from \"./lock_cell\";\nimport * as m4  from \"./dropdown\";\nimport * as m5  from \"./filter\";\nimport * as m6  from \"./hide_row_col\";\nimport * as m7  from \"./comments\";\n\nexport function init(view){\n\tvar modules = [m1,m2,m3,m4,m5,m6,m7];\n\tview.attachEvent(\"onDataSerialize\", function(data){\n\t\tfor (var i = 0; i < modules.length; i++){\n\t\t\tif(modules[i].serialize)\n\t\t\t\tmodules[i].serialize(view,data);\n\t\t}\n\n\t});\n\tview.attachEvent(\"onDataParse\", function(data){\n\t\tfor (var i = 0; i < modules.length; i++){\n\t\t\tif(modules[i].load)\n\t\t\t\tmodules[i].load(view,data);\n\t\t}\n\t});\n}","const types = [\".xls\",\".xlt\",\".xla\",\".xlsx\",\".xlsm\",\".xltx\",\".xltm\",\".xlam\",\".xlsb\"];\n\nexport function init(view){\n\tlet uploader;\n\tif (window.XMLHttpRequest && (new XMLHttpRequest()).upload){\n\t\tuploader = webix.ui({\n\t\t\tview:\"uploader\",\n\t\t\tapiOnly:true,\n\t\t\taccept: types.join()\n\t\t});\n\n\t\tuploader.attachEvent(\"onBeforeFileAdd\",webix.bind(function(upload){\n\t\t\tif(types.indexOf(\".\"+upload.type.toLowerCase())>-1){\n\t\t\t\tview.reset();\n\t\t\t\tview.parse(upload.file, \"excel\");\n\t\t\t}\n\t\t\treturn false;\n\t\t},this));\n\n\t\tview._destroy_with_me.push(uploader);\n\t}\n\n\tview.attachEvent(\"onCommand\", (obj) => {\n\t\tif (obj.id === \"excel-import\")\n\t\t\tstartImport(view, uploader);\n\t});\n}\n\nfunction startImport(view, uploader){\n\tif (!uploader)\n\t\tview.alert(webix.i18n.spreadsheet.labels[\"import-not-support\"]);\n\telse\n\t\twebix.delay(() => uploader.fileDialog());\n}","export function print(view, options){\n\tlet active = view._activeSheet;\n\n\tlet html = _buildHtml(view, options, active);\n\twebix.html.insertBefore(html, options.docFooter, document.body);\n\twindow.print();\n\t_cleanHtml(view, html);\n\n\tview.showSheet(active);\n}\n\nexport function init(view){\n\tview.$customPrint = function(options){\n\t\tprint(view, options);\n\t};\n}\n\nfunction _cleanHtml(view, html){\n\twebix.html.remove(html);\n\n\tview._sheets.forEach((sheet, i) => {\n\t\twebix.html.removeStyle(\".wss_\"+view.$index+\"_\"+i);\n\t});\n}\nfunction _buildHtml(view, options, active){\n\tlet doc = webix.html.create(\"div\", { \"class\":\"webix_ssheet_print\"});\n\n\toptions.xCorrection = 1;\n\toptions.header = options.header || false;\n\toptions.trim = webix.isUndefined(options.trim) ? true : options.trim;\n\toptions.sheetnames = webix.isUndefined(options.sheetnames) ? true : options.sheetnames;\n\tconst baseIndex = view.$index;\n\n\tview._sheets.forEach((sheet, i) => {\n\t\tview.$index = baseIndex+\"_\"+i;\n\t\tif(options.data ===\"all\" || (options.data !== \"all\" && sheet.name === active)){\n\t\t\tview.showSheet(sheet.name);\n\t\t\tlet prefix = \"wss_\"+view.$index;\n\n\t\t\tif(options.sheetnames){\n\t\t\t\tlet sheetname = webix.html.create(\"div\", { \"class\":\"webix_view webix_ssheet_sheetname\"}, sheet.name+\":\");\n\t\t\t\tdoc.appendChild(sheetname);\n\t\t\t}\n\n\t\t\tview._print = true;\n\t\t\tlet table = view._table.$customPrint(options, true);\n\t\t\tdelete view._print;\n\n\t\t\t//for empty sheet we don't have any HTML\n\t\t\tif (table.firstChild)\n\t\t\t\ttable.firstChild.className += \" \"+prefix;\n\t\t\tdoc.appendChild(table);\n\n\t\t\tif(options.data == \"all\" && i+1 < view._sheets.length){\n\t\t\t\tvar br = webix.html.create(\"DIV\", {\"class\":\"webix_print_pagebreak\"});\n\t\t\t\tdoc.appendChild(br);\n\t\t\t}\n\t\t}\n\t});\n\tview.$index = baseIndex;\n\n\treturn doc;\n}","import { style_names } from \"../operations/styles\";\nimport { getType } from \"../operations/types\";\nimport { defaultStyles} from \"../toolbar/defaults\";\nimport { getFormatSource } from \"../operations/formats\";\nimport { getDimension } from \"../helpers/array\";\nimport { getConditionCss } from \"../operations/conditional_formats\";\nimport { getRenderedValue } from \"../table\";\n\nexport function init(view){\n\tconst table = view._table;\n\tview.$exportView = function(options){\n\t\tconst pdf = options.export_mode == \"pdf\";\n\t\tconst excel = options.export_mode == \"excel\";\n\t\tconst defaultOptions = {\n\t\t\theader: false,\n\t\t\tfooter:false,\n\t\t\theights:true,\n\t\t\trawValues: !pdf,\n\t\t\tfilterHTML:true,\n\t\t\tspans: true,\n\t\t\tstyles:true,\n\t\t\tmath: !pdf,\n\t\t\thidden: excel,\n\t\t\txCorrection: table.config.header || options.hidden ? 1 : 0,\n\t\t\tignore:{rowId:true},\n\t\t\tconditions:true\n\t\t};\n\n\t\twebix.extend(options, defaultOptions);\n\n\t\tif(excel || pdf)\n\t\t\treturn _exportView(view, options);\n\t\telse\n\t\t\treturn table;\n\t};\n\n\ttable.$getExportValue = function(row, column, options){\n\t\tconst value = view.getCellValue(row, column, options.math);\n\t\tconst mode = options.export_mode;\n\t\tconst math = options.math && value[0] == \"=\";\n\t\tif((mode == \"pdf\" || mode == \"csv\") && !math && !options.rawValues)\n\t\t\treturn getRenderedValue(view, row, column);\n\t\treturn typeof value == \"string\" && value.match(/^=(image|sparkline)\\(/i) ? \"\" : value;\n\t};\n}\n\nfunction _exportView(view, options){\n\tconst excel = options.export_mode == \"excel\";\n\n\tif(options.sheets === true) \n\t\toptions.sheets = view._sheets.map(function(s){ return s.name;});\n\telse if(!options.sheets || !options.sheets.length)\n\t\toptions.sheets = [view._activeSheet];\n\telse if(typeof options.sheets == \"string\")\n\t\toptions.sheets = [options.sheets];\n\n\toptions.dataOnly = true;\n\n\tlet data = [];\n\tlet active = view._activeSheet;\n\n\tfor(let i = 0; i<options.sheets.length; i++){\n\t\tconst sheet = options.sheets[i];\n\t\tconst id = sheet.id || sheet;\n\n\t\tview.showSheet(id);\n\n\t\tif(options.hidden)\n\t\t\toptions.xCorrection = 1;\n\n\t\tconst sheetOptions = sheet.options ? webix.extend(sheet.options, options) : webix.copy(options);\n\t\tif(id != active)\n\t\t\tsheetOptions._hidden = true;\n\t\tif(!sheetOptions.name)\n\t\t\tsheetOptions.name = id;\n\n\t\tconst pdfTable = !excel && sheetOptions.display != \"image\";\n\n\t\tconst serialized = view.serialize();\n\t\tconst [rows, cols] = getDimension(serialized.data, serialized.spans, 0, 0);\n\n\t\tif(!excel){\n\t\t\tif(webix.isUndefined(sheetOptions.textBefore))\n\t\t\t\tsheetOptions.textBefore = sheetOptions.name;\n\t\t\tif(pdfTable){\n\t\t\t\tsheetOptions.ignore = sheetOptions.ignore || {};\n\t\t\t\tfor(let i = cols+1; i <= view.config.columnCount; i++){\n\t\t\t\t\tsheetOptions.ignore[i] = true;\n\t\t\t\t}\n\n\t\t\t\tconst filter = sheetOptions.filter || (()=>true);\n\t\t\t\tsheetOptions.filter = obj =>{\n\t\t\t\t\treturn obj.id <= rows && filter.apply(this, arguments);\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tconst sheetData = webix[excel ? \"toExcel\" : \"toPDF\"](view._table, sheetOptions);\n\t\tif(pdfTable && sheetData[0].scheme.length == 0)\n\t\t\tcontinue;\n\n\t\tif((excel || pdfTable) && sheetOptions.styles){\n\t\t\tconst styles = sheetData[0].styles = _getStyles(view, sheetOptions, excel, rows, cols);\n\n\t\t\tif(pdfTable)\n\t\t\t\t_updatePdfData(styles, sheetData, sheetOptions, view, serialized);\n\t\t}\n\n\t\tdata = data.concat(sheetData);\n\n\t\tif(excel){\n\t\t\tdata[i].ranges = [];\n\n\t\t\tview.ranges.serialize(id).forEach(range => {\n\t\t\t\tconst ref = range[1].split(\"!\");\n\t\t\t\tdata[i].ranges.push({\n\t\t\t\t\tSheet: range[2] ? null : i,\n\t\t\t\t\tName: range[0],\n\t\t\t\t\tRef: ref[0]+\"!\"+ref[1].replace(/[0-9]+|[A-Z]+/gi, (match)=>`$${match}`)\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\telse{\n\t\t\tif(options.autowidth)\n\t\t\t\tgetAutowidth(sheetOptions, options);\n\t\t}\n\t}\n\n\tview.showSheet(active);\n\tdelete options.dataOnly;\n\treturn data;\n}\n\nfunction _updatePdfData(styles, sheetData, sheetOptions, view, serialized){\n\tconst header = sheetOptions.header ? 1 : 0;\n\n\tif (sheetOptions.spans) {\n\t\tfor (let idx in serialized.spans) {\n\t\t\tif (serialized.spans[idx][2] > 1) {\n\t\t\t\tlet row = serialized.spans[idx][0] - 1 + header, // zero-based row position\n\t\t\t\t\tcol = serialized.spans[idx][1] - 1, // zero-based col position\n\t\t\t\t\tcols = serialized.spans[idx][2];\n\t\t\t\tif (styles[row] && styles[row][col]) {\n\t\t\t\t\tstyles[row][col].colspan = cols;\n\t\t\t\t\t// if colspan, then remove merged cells (else PDFJS will shift columns)\n\t\t\t\t\tconst rowData = sheetData[0].exportData[row - header];\n\t\t\t\t\tif (rowData){\n\t\t\t\t\t\t// remove merged cell values\n\t\t\t\t\t\trowData.splice(col + 1, cols - 1);\n\t\t\t\t\t}\n\t\t\t\t\tlet style = Object.values(styles[row]);\n\t\t\t\t\tstyle.splice(col + 1, cols - 1); // remove merged cell styles\n\t\t\t\t\tstyles[row] = style;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tconst data = sheetData[0].exportData;\n\tfor(let r = 0; r < data.length; r++){\n\t\tfor (let c = 0; c < data[r].length; c++) {\n\t\t\tlet height = view.$$(\"cells\").config.rowHeight;\n\n\t\t\tif(sheetOptions.heights && serialized.sizes.length){\n\t\t\t\tfor(let s = 0; s < serialized.sizes.length; s++){\n\t\t\t\t\tconst rowSize = serialized.sizes[s][0];\n\t\t\t\t\tif(rowSize && rowSize == r+1){\n\t\t\t\t\t\theight = serialized.sizes[s][2];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst cellStyle = styles[r + header][c];\n\t\t\tconst align = cellStyle.vertAlign;\n\t\t\tconst pad = height*0.75 - cellStyle.fontSize; // available px for padding in top & bottom\n\t\t\tcellStyle.paddingTop = (align == \"top\" ? 0 : (align == \"bottom\" ? pad : pad / 2));\n\t\t\tcellStyle.paddingBottom = (align == \"bottom\" ? 0 : (align == \"top\" ? pad : pad / 2));\n\t\t}\n\t}\n}\n\nfunction getAutowidth(view, options){\n\tconst prop = options.orientation && options.orientation == \"landscape\" ? \"height\" : \"width\";\n\tlet width;\n\n\tif(view.$width)\n\t\twidth = view.$width;\n\telse //'view' can be local settings and we need to compare them with common ones\n\t\twidth = view[prop];\n\n\toptions[prop] = Math.max(options[prop] || 0, width || 0);\n}\n\nfunction _safeColor(str){\n\tstr = str.substring(1);\n\tif(str.length === 3) str = str+str;\n\treturn str;\n}\n\nfunction _getDefaults(options){\n\tlet d = defaultStyles;\n\tif(options.export_mode == \"excel\")\n\t\treturn {\n\t\t\tfont:{\n\t\t\t\tsz:d[\"font-size\"].replace(\"px\", \"\")*0.75,\n\t\t\t\tname:d[\"font-family\"].replace(/'|,.*$/g, \"\"),\n\t\t\t\t//we do not export default color, but it is the right place to do it\n\t\t\t},\n\t\t\talignment:{\n\t\t\t\thorizontal:d[\"text-align\"],\n\t\t\t\tvertical:d[\"vertical-align\"]==\"middle\"?\"center\":d[\"vertical-align\"],\n\t\t\t\twrapText:d[\"white-space\"]!=\"nowrap\"\n\t\t\t}\n\t\t};\n\telse\n\t\treturn {\n\t\t\tfontSize: d[\"font-size\"].replace(\"px\", \"\")*0.75,\n\t\t\t//we do not export default color, but it is the right place to do it\n\t\t\ttextAlign: d[\"text-align\"],\n\t\t\twhiteSpace: (d[\"white-space\"]!=\"nowrap\")\n\t\t};\n}\n\nfunction _getStyles(view, options, excel, rows, cols){\n\tview.compactStyles();\n\n\tlet result = [];\n\tconst cached = {};\n\tconst cachedConditions = {};\n\tconst defaults = _getDefaults(options);\n\n\tif(excel && options.docHeader) result  = result.concat([{0:_getDocStyle(options.docHeader.css, defaults)}, {}]);\n\tif(options.header) result.push({});\n\n\tconst delta = result.length;\n\n\tconst grid = view.$$(\"cells\");\n\n\tlet rIndex = delta;\n\tgrid.eachRow(row =>{\n\t\tif(row > rows)\n\t\t\treturn;\n\n\t\tlet cIndex = 0;\n\t\tgrid.eachColumn(col => {\n\t\t\tif(cIndex > cols)\n\t\t\t\treturn;\n\n\t\t\tif(cIndex >= options.xCorrection){\n\t\t\t\tconst css = view.getStyle(row, col);\n\t\t\t\tconst index = cIndex - options.xCorrection;\n\n\t\t\t\tresult[rIndex] = result[rIndex] || {};\n\n\t\t\t\tlet styles;\n\t\t\t\tif(css){\n\t\t\t\t\tif(cached[css.id])\n\t\t\t\t\t\tstyles = webix.copy(cached[css.id]);\n\t\t\t\t\telse{\n\t\t\t\t\t\tstyles = _getCellStyle(css.text, excel);\n\n\t\t\t\t\t\tfor(let name in defaults){\n\t\t\t\t\t\t\tif(excel)\n\t\t\t\t\t\t\t\twebix.extend(styles[name], defaults[name]);\n\t\t\t\t\t\t\telse if (!styles[name])\n\t\t\t\t\t\t\t\tstyles[name] = defaults[name];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcached[css.id] = webix.copy(styles);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tstyles = webix.copy(defaults);\n\n\t\t\t\tif(options.conditions){\n\t\t\t\t\t//not real excel condition, save only bg and color (sheetJS doesn't support)\n\t\t\t\t\tconst condition = _getCellConditions(view, row, col, cachedConditions);\n\t\t\t\t\tif(condition)\n\t\t\t\t\t\t_updateStyleCondition(styles, condition, excel);\n\t\t\t\t}\n\n\t\t\t\tresult[rIndex][index] = styles;\n\t\t\t\tresult[rIndex][index].type = getType(view, row, col);\n\t\t\t}\n\t\t\tcIndex++;\n\t\t}, options.hidden);\n\t\trIndex++;\n\t}, options.hidden);\n\n\tif(excel && options.docFooter) result  = result.concat([{},{0:_getDocStyle(options.docFooter.css, defaults)}]);\n\n\treturn result;\n}\n\nfunction _getCellStyle(styles, excel){\n\tlet str = styles.split(\";\");\n\tlet stl = {};\n\tif(excel)\n\t\tstl = { font:{}, alignment:{}, border:{}};\n\n\tfor(let s = 0; s<str.length; s++){\n\t\tif(str[s]){\n\t\t\tif(excel)\n\t\t\t\t_getExcelCellStyle(stl, str, s);\n\t\t\telse\n\t\t\t\t_getPdfCellStyle(stl, str, s);\n\t\t}\n\t}\n\n\treturn stl;\n}\n\nfunction _getCellConditions(view, r, c, cached){\n\tconst rendered = getRenderedValue(view, r, c);\n\tconst css = getConditionCss(view, r, c, rendered);\n\tif(css){\n\t\tif(cached[css])\n\t\t\treturn cached[css];\n\t\tconst el = webix.html.create(\"div\", {\"class\":css});\n\t\tdocument.body.appendChild(el);\n\n\t\tconst computed = window.getComputedStyle(el);\n\t\tconst bg = computed.backgroundColor;\n\t\tconst color = computed.color;\n\n\t\tdocument.body.removeChild(el);\n\n\t\tcached[css] = [bg, color];\n\t\treturn cached[css];\n\t}\n}\n\nfunction _updateStyleCondition(stl, condition, excel){\n\tlet [bg, color] = condition.map(val => webix.color.rgbToHex(val));\n\tif(excel){\n\t\tstl.fill = {fgColor:{rgb:bg}};\n\t\tstl.font.color = {rgb:color};\n\t}\n\telse{\n\t\tstl.backgroundColor = bg;\n\t\tstl.color = color;\n\t}\n}\n\nfunction _getExcelCellStyle(stl, str, s){\n\tswitch (style_names[s]){\n\t\tcase \"color\":\n\t\t\tstl.font.color = {rgb:_safeColor(str[s])};\n\t\t\tbreak;\n\t\tcase \"background\":{\n\t\t\tconst fill = _safeColor(str[s]);\n\t\t\tif(fill && fill.toLowerCase() !== \"ffffff\")\n\t\t\t\tstl.fill = { fgColor:{ rgb:fill}};\n\t\t\tbreak;\n\t\t}\t\n\t\tcase \"text-align\":\n\t\t\tstl.alignment.horizontal = str[s];\n\t\t\tbreak;\n\t\tcase \"font-family\":\n\t\t\tstl.font.name = str[s].replace(/'|,.*$/g, \"\"); // cut off fallback font\n\t\t\tbreak;\n\t\tcase \"font-size\":\n\t\t\tstl.font.sz = str[s].replace(\"px\", \"\")*0.75; //px to pt conversion\n\t\t\tbreak;\n\t\tcase \"font-style\":\n\t\t\tstl.font.italic = str[s] == \"italic\";\n\t\t\tbreak;\n\t\tcase \"text-decoration\":\n\t\t\tstl.font.underline = str[s] == \"underline\";\n\t\t\tbreak;\n\t\tcase \"font-weight\":\n\t\t\tstl.font.bold = str[s] == \"bold\";\n\t\t\tbreak;\n\t\tcase \"vertical-align\":\n\t\t\tstl.alignment.vertical = str[s] == \"middle\"?\"center\":str[s];\n\t\t\tbreak;\n\t\tcase \"wrap\":\n\t\t\tstl.alignment.wrapText = str[s] == \"wrap\";\n\t\t\tbreak;\n\t\tcase \"borders\":\n\t\t\tbreak;\n\t\tcase \"format\":\n\t\t\tstl.format = getFormatSource(str[s], true) || \"\";\n\t\t\tbreak;\n\t\tcase \"border-right\":\n\t\tcase \"border-bottom\":\n\t\tcase \"border-left\":\n\t\tcase \"border-top\":\n\t\t\tstl.border[ style_names[s].split(\"-\")[1] ] = getBorderStyles(str[s], true);\n\t\t\tbreak;\n\t}\n}\n\nfunction _getPdfCellStyle(stl, str, s){\n\tswitch (style_names[s]) {\n\t\tcase \"color\":\n\t\t\tstl.color = _safeColor(str[s]);\n\t\t\tbreak;\n\t\tcase \"background\":\n\t\t\tstl.backgroundColor = _safeColor(str[s]);\n\t\t\tbreak;\n\t\tcase \"text-align\":\n\t\t\tstl.textAlign = str[s];\n\t\t\tbreak;\n\t\tcase \"font-family\":\n\t\t\tbreak;\n\t\tcase \"font-size\":\n\t\t\tstl.fontSize = str[s].replace(\"px\", \"\")*0.75;\n\t\t\tbreak;\n\t\tcase \"font-style\":\n\t\t\tstl.italic = str[s] == \"italic\";\n\t\t\tbreak;\n\t\tcase \"text-decoration\":\n\t\t\tstl.underline = str[s] == \"underline\";\n\t\t\tbreak;\n\t\tcase \"font-weight\":\n\t\t\tstl.bold = str[s] == \"bold\";\n\t\t\tbreak;\n\t\tcase \"vertical-align\":\n\t\t\tstl.vertAlign = str[s]; // not supported in PDFJS, so simulate with lineHeight and paddingTop\n\t\t\tbreak;\n\t\tcase \"wrap\":\n\t\t\tstl.whiteSpace = (str[s] != \"nowrap\");\n\t\t\tbreak;\n\t\tcase \"borders\":\n\t\t\tbreak;\n\t\tcase \"format\":\n\t\t\tbreak;\n\t\tcase \"border-right\":\n\t\tcase \"border-bottom\":\n\t\tcase \"border-left\":\n\t\tcase \"border-top\":{\n\t\t\tconst pos = style_names[s].split(\"-\")[1];\n\t\t\tstl[`border${pos[0].toUpperCase() + pos.substring(1)}Color`] = getBorderStyles(str[s]);\n\t\t\tbreak;\n\t\t}\n\t}\n}\n\nfunction getBorderStyles(val, excel){\n\tconst [color, type] = val.split(\",\");\n\n\tif(excel)\n\t\treturn { color:{ rgb:_safeColor(color)}, style:type};\n\telse\n\t\treturn _safeColor(color);\n}\n\nfunction _getDocStyle(css){\n\tif(!css) return {};\n\tvar str = [];\n\tfor(let i =0; i<style_names.length; i++)\n\t\tstr.push(css[style_names[i]]||\"\");\n\treturn _getCellStyle(str.join(\";\"), true);\n}","import { style_names } from \"../operations/styles\";\nimport { fontFamily} from \"../toolbar/buttons\";\nimport { defaultStyles} from \"../toolbar/defaults\";\n\nexport function init(view){\n\tview._parseExcel = function(obj, driver){\n\t\tvar options = obj.options || {};\n\t\toptions.math = view.config.math;\n\n\t\tvar full = { sheets:[]};\n\t\tfor(let i  = 0; i< obj.names.length; i++){\n\t\t\toptions.name = obj.names[i];\n\t\t\tfull.sheets.push({\n\t\t\t\tname:options.name,\n\t\t\t\tcontent:_excel_to_data(driver.getSheet(obj, options), obj.ranges, i)\n\t\t\t});\n\t\t}\n\t\treturn full;\n\t};\n\tview._parseCsv = function(obj, driver){\n\t\tobj = driver.getRecords(obj);\n\n\t\tvar dataObj = webix.copy(obj);\n\t\tvar data = [];\n\n\t\tfor(let i = 0; i<dataObj.length; i++){\n\t\t\tlet item = dataObj[i].split(driver.cell);\n\t\t\tfor(let c  = 0; c<item.length; c++){\n\t\t\t\tvar row = i+1, column = c+1;\n\t\t\t\tdata.push([row, column, item[c]]);\n\t\t\t}\n\t\t}\n\t\treturn { data:data };\n\t};\n}\n\n\nfunction _excel_to_data(obj, ranges, index){\n\tvar dataObj = webix.copy(obj.data);\n\tvar data =  [];\n\n\tfor (let i = 0; i < dataObj.length; i++){\n\t\tfor(let c = 0; c<dataObj[0].length; c++){\n\t\t\tvar row = i+1, column = c+1;\n\t\t\tdata.push([row, column, dataObj[i][c]]);\n\t\t}\n\t}\n\tobj.data = data;\n\n\t//merged cells\n\tif(obj.spans){\n\t\tfor(let i = 0; i<obj.spans.length; i++){\n\t\t\tobj.spans[i][0]++;\n\t\t\tobj.spans[i][1]++;\n\t\t}\n\t}\n\n\t//named ranges\n\tif(ranges){\n\t\tfor(let r = 0; r<ranges.length; r++){\n\t\t\t//we don't support global named ranges, so import only sheet-based :(\n\t\t\tif(ranges[r].Sheet === index){\n\t\t\t\tobj.ranges = obj.ranges || [];\n\t\t\t\tobj.ranges.push([ranges[r].Name.toUpperCase(), ranges[r].Ref.substring(ranges[r].Ref.indexOf(\"!\")+1).replace(/\\$/g, \"\")]);\n\t\t\t}\n\t\t}\n\t}\n\n\t//cell styles\n\tif(obj.styles)\n\t\t_getStyles(obj);\n\n\tif(obj.types)\n\t\t_getTypes(obj);\n\n\tif(obj.hidden){\n\t\t_getHidden(obj);\n\t}\n\n\t//column width and row height\n\tif(obj.sizes){\n\t\tfor(let i = 0; i<obj.sizes.length; i++){\n\t\t\tif(obj.sizes[i][0] == \"column\")\n\t\t\t\tobj.sizes[i] = [0, obj.sizes[i][1]+1, obj.sizes[i][2]];\n\t\t\telse\n\t\t\t\tobj.sizes[i] = [obj.sizes[i][1]+1, 0, obj.sizes[i][2]];\n\t\t}\n\t}\n\n\treturn obj; \n}\n\n//ARGB conversion\nfunction _safeColor(str){\n\tstr = str || \"000000\";\n\tif(str.length === 8) str = str.substring(2);\n\treturn \"#\"+str;\n}\n\n//only fonts that we support can be imported\nfunction _safeFont(str){\n\tlet safe = defaultStyles[\"font-family\"];\n\tfor(let i = 0; i<fontFamily.length; i++){\n\t\tif(fontFamily[i].value == str) { safe = fontFamily[i].id; break; }\n\t}\n\treturn safe;\n}\n\nfunction _getTypes(obj){\n\tobj.types.forEach(type => {\n\t\tfor(let i = 0; i < obj.data.length; i++){\n\t\t\tif(obj.data[i][0] === type[0]+1 && obj.data[i][1] === type[1]+1){\n\t\t\t\tobj.data[i][4] = type[2];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction _getHidden(obj){\n\tconst hidden = {\n\t\trow:[],\n\t\tcolumn:[]\n\t};\n\n\tfor(let i = 0; i < obj.hidden.length; i++){\n\t\tconst item = obj.hidden[i];\n\t\tif(item[0] == \"column\")\n\t\t\thidden.column.push(item[1]+1);\n\t\telse\n\t\t\thidden.row.push(item[1]+1);\n\t}\n\n\tobj.table = {hidden};\n}\n\nfunction _getBorderStyles(pos, stl){\n\tpos = pos.replace(\"border-\", \"\");\n\tif(stl.border && stl.border[pos]){\n\t\tconst border = stl.border[pos];\n\t\tconst color = _safeColor(border.color.rgb) || \"\";\n\t\tconst type = border.style || \"\";\n\t\treturn `${color},${type}`;\n\t}\n\treturn \"\";\n}\n\nfunction _getStyles(obj){\n\tlet styleshash = {}, styles = [], stylescount = 1;\n\tfor(let i = 0; i<obj.styles.length; i++){\n\t\tlet str = [], stl = obj.styles[i][2], css;\n\n\t\tfor(let s  = 0; s<style_names.length; s++){\n\t\t\tswitch (style_names[s]){\n\t\t\t\tcase \"color\": \n\t\t\t\t\tstr[s] = stl.font && stl.font.color?(_safeColor(stl.font.color.rgb)||\"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"background\":\n\t\t\t\t\tstr[s] = stl.fill && stl.fill.fgColor?(_safeColor(stl.fill.fgColor.rgb) ||\"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"text-align\":\n\t\t\t\t\tstr[s] = (stl.alignment ?stl.alignment.horizontal:\"\") || defaultStyles[\"text-align\"];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-family\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.name?_safeFont(stl.font.name):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-size\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.sz?((stl.font.sz/0.75)+\"px\" ||\"\"):\"\"; //pt to px conversion\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-style\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.italic?\"italic\":\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"text-decoration\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.underline?\"underline\":\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-weight\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.bold?\"bold\":\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"vertical-align\":\n\t\t\t\t\tvar va = stl.alignment ? (stl.alignment.vertical || \"\"):\"\";\n\t\t\t\t\tstr[s] = (va ==\"center\"?\"middle\":va) || defaultStyles[\"vertical-align\"];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"wrap\":\n\t\t\t\t\tstr[s] = stl.alignment && stl.alignment.wrapText?\"wrap\":\"nowrap\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"borders\":\n\t\t\t\t\tstr[s] = \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"format\":\n\t\t\t\t\tstr[s] = \"\"; //stl.numFmt\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-right\":\n\t\t\t\tcase \"border-bottom\":\n\t\t\t\tcase \"border-left\":\n\t\t\t\tcase \"border-top\":\n\t\t\t\t\tstr[s] = _getBorderStyles(style_names[s], stl);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tstr = str.join(\";\");\n\t\tcss = styleshash[str] || \"wss\"+stylescount;\n\n\t\tfor(let d = 0; d<obj.data.length; d++){\n\t\t\tif(obj.data[d][0] === obj.styles[i][0]+1 && obj.data[d][1] === obj.styles[i][1]+1){\n\t\t\t\tobj.data[d][3] = css;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(!styleshash[str]){\n\t\t\tstyles.push([css, str]);\n\t\t\tstyleshash[str] = css;\n\t\t\tstylescount++;\n\t\t}\n\t}\n\tobj.styles = styles;\n}","import group from \"../operations/undo_group\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (action) => {\n\t\tswitch (action.id) {\n\t\t\tcase \"clear-value\":\n\t\t\t\tview.clearRange(null,{values: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-style\":\n\t\t\t\tview.clearRange(null,{styles: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-conditional-formats\":\n\t\t\t\tview.clearRange(null,{conditions: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-dropdown-editors\":\n\t\t\t\tview.clearRange(null,{editors: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-all\":\n\t\t\t\tgroup.set(function(){\n\t\t\t\t\tview.clearRange(null,null);\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-comments\":\n\t\t\t\tview.clearRange(null,{comments: true});\n\t\t\t\tbreak;\n\t\t}\n\t});\n}","import group from \"../operations/undo_group\";\nimport {adjustRow, adjustColumn} from \"../operations/column_operations\";\n\n/* row operations */\n\nexport function insertRow(row){\n\tcallCommand(this, \"add\", \"row\", row);\n}\n\nexport function deleteRow(row){\n\tcallCommand(this, \"del\", \"row\", row);\n}\n\nexport function setRowHeight(row, height){\n\tsetSize(this, \"row\", row, height);\n}\n\n/* col operations */\n\nexport function insertColumn(column){\n\tcallCommand(this, \"add\", \"column\", column);\n}\n\nexport function deleteColumn(column){\n\tcallCommand(this, \"del\", \"column\", column);\n}\n\nexport function setColumnWidth(column, width){\n\tsetSize(this, \"column\", column, width);\n}\n\n/* helpers */\n\nfunction getCells(view, id, group){\n\tif(!id){\n\t\tlet area = view.$$(\"cells\").getSelectArea();\n\t\tif(area)\n\t\t\tid = [area.start[group],area.end[group]];\n\t}\n\telse if(!webix.isArray(id)){\n\t\tid =  [id,id];\n\t}\n\treturn id;\n}\n\nfunction callCommand(view, name, group, id){\n\tlet start = {}, end = {};\n\tid = getCells(view, id, group);\n\tif(!id)\n\t\treturn;\n\tstart[group] = id[0];\n\tend[group] = id[1];\n\tview.callEvent(\"onCommand\", [{id:name,  group:group}, start, end]);\n}\n\nfunction setSize(view, type, id, size){\n\tid = getCells(view, id, type);\n\tif(!id)\n\t\treturn;\n\tgroup.set(()=>{\n\t\tfor (let i = id[0]; i <= id[1]; i++){\n\t\t\tif(size != \"auto\")\n\t\t\t\tview.$$(\"cells\")[type == \"row\" ? \"setRowHeight\" : \"setColumnWidth\"](i, size);\n\t\t\telse\n\t\t\t\t(type == \"row\" ? adjustRow : adjustColumn)(i, view);\n\t\t}\n\t});\n}","import * as lock from \"../operations/lock_cell\";\n\nexport function lockCell(row, column, state){\n\tlock.lockCell(this, row, column, state);\n}\n\nexport function isCellLocked(row, column){\n\treturn lock.isCellLocked(this, row, column);\n}","import group from \"../operations/undo_group\";\n\nexport function freezeColumns(column){\n\tconst grid = this.$$(\"cells\");\n\n\tif( webix.isUndefined(column) ){\n\t\tlet sel = this.getSelectedId(true);\n\t\tcolumn = sel.length?sel[0].column:0;\n\t}\n\n\tconst base = grid.config.columns[0].id == \"rowId\" ? 1 : 0;\n\tlet index = base;\n\tif (column && column != this._frozenColumns){\n\t\tfor (let i = column; i > 0; i--) {\n\t\t\tindex = grid.getColumnIndex(i)+1;\n\t\t\tif(index)\n\t\t\t\tbreak;\n\t\t}\n\t\tif (!index) index = base;\n\t}\n\n\tgroup.set(function(){\n\t\tcheckSpans(this, \"column\", column);\n\t\tgrid.unselect();\n\t\tgrid.define(\"leftSplit\", index);\n\t\tgrid.refreshColumns();\n\n\t\tthis.callEvent(\"onAction\", [ \"freeze-column\", { value: (this._frozenColumns || 0), newValue: column}]);\n\t\tthis._frozenColumns = column || 0;\n\t},this);\n}\n\nexport function freezeRows(row){\n\tconst grid = this.$$(\"cells\");\n\n\tif( webix.isUndefined(row) ){\n\t\tlet sel = this.getSelectedId(true);\n\t\trow = sel.length?sel[0].row:0;\n\t}\n\n\tlet index = 0;\n\tif (row && row != this._frozenRows){\n\t\tfor (let i = row; i > 0; i--) {\n\t\t\tindex = grid.getIndexById(i)+1;\n\t\t\tif(index)\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tgroup.set(function(){\n\t\tcheckSpans(this, \"row\", row);\n\t\tgrid.unselect();\n\t\tgrid.define(\"topSplit\", index);\n\t\tgrid.refreshColumns();\n\n\t\tthis.callEvent(\"onAction\", [ \"freeze-row\", { value: this._frozenRows, newValue: row}]);\n\t\tthis._frozenRows = row || 0;\n\t},this);\n}\n\nfunction checkSpans(view, type, num){\n\tconst grid = view.$$(\"cells\");\n\n\tif(type == \"row\"){\n\t\tlet start = 1;\n\t\tlet end = view.config.columnCount;\n\t\tfor(let i = start; i <= end; i++){\n\t\t\tconst span = grid.getSpan(num, i);\n\t\t\tif(span){\n\t\t\t\tconst spanSize = (span[0]*1) + span[3] - 1;\n\t\t\t\tif(spanSize>num)\n\t\t\t\t\tchangeSpan(view, span, span[2], span[3] - (spanSize - num));\n\t\t\t}\n\t\t}\n\t}\n\telse{//column\n\t\tlet start = grid.data.order[0];\n\t\tlet end = grid.data.order.length;\n\t\tfor(let i = start; i <= end; i++){\n\t\t\tconst span = grid.getSpan(i, num);\n\t\t\tif(span){\n\t\t\t\tconst spanSize = (span[1]*1) + span[2] - 1;\n\t\t\t\tif(spanSize>num)\n\t\t\t\t\tchangeSpan(view, span, span[2] - (spanSize - num), span[3]);\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction changeSpan(view, span, x, y){\n\tview.splitCell(span[0], span[1]);\n\tview.combineCells({\n\t\tcell:{\n\t\t\trow:span[0],\n\t\t\tcolumn:span[1]\n\t\t},\n\t\tx:x,\n\t\ty:y\n\t});\n}","import * as gridlines from \"../operations/hide_gridlines\";\n\nexport function hideGridlines(state){\n\tgridlines.hideGridlines(this,state);\n}","import * as headers from \"../operations/hide_headers\";\n\nexport function hideHeaders(state){\n\theaders.hideHeaders(this,state);\n}","import * as hrows from \"../operations/hide_row_col\";\n\nexport function hideColumn(column,state){\n\throws.setState(this, column, state, \"column\");\n}\nexport function isColumnVisible(column){\n\treturn hrows.isColumnVisible(this, column);\n}\nexport function hideRow(row,state){\n\throws.setState(this, row, state, \"row\");\n}\nexport function isRowVisible(row){\n\treturn hrows.isRowVisible(this, row);\n}","import {addMethod} from \"@xbs/muon\";\nimport {image, chart} from \"../mathematics/writer\";\nimport {range as getRange} from \"../helpers/column_names\";\n\nexport function addImage(row, column, url){\n\tthis.setCellValue(row, column, image(url));\n\tthis.refresh();\n}\n\nexport function addSparkline(row, column, config){\n\tlet value = chart(config);\n\tthis.setCellValue(row, column, value);\n\tthis.refresh();\n}\n\nexport function getSheetData(name){\n\tconst sheet = this._mData.getPage(name);\n\n\tif(sheet)\n\t\treturn {\n\t\t\tgetValue: (r, c, math)=>{\n\t\t\t\treturn _normalizeVal(sheet.getValue(r-1, c-1, math));\n\t\t\t},\n\t\t\tgetRangeValue: (range)=>{\n\t\t\t\tconst pos = getRange(range, this, name);\n\t\t\t\tif (!pos) return [];\n\n\t\t\t\tconst page = pos[4] == name ? sheet : this._mData.getPage(pos[4]);\n\t\t\t\treturn page.getRange(pos[0]-1, pos[1]-1, pos[2]-1, pos[3]-1).map(_normalizeVal);\n\t\t\t}\n\t\t};\n}\n\nfunction _normalizeVal(val){\n\treturn !val && val !== 0 ? \"\" : val;\n}\n\nexport function registerMathMethod(name, handler){\n\tname = name.toUpperCase();\n\taddMethod(name, handler);\n\tif(this.$$(\"liveEditor\")){\n\t\tconst sid = this.$$(\"liveEditor\").config.suggest;\n\t\tconst list = webix.$$(sid).getList();\n\t\tif(!list.exists(name))\n\t\t\tlist.add({id:name, value:name});\n\t}\n}\n\nexport function recalculate(){\n\tthis._mData.getStore().recalculate();\n\tthis.callEvent(\"onMathRefresh\",[]);\n\tthis.refresh();\n}\n\nexport function setPlaceholder(name, value){\n\tif(typeof name == \"object\"){\n\t\tvalue = name;\n\t\tname = \"*\";\n\t}\n\n\tthis._mData.getStore().setPlaceholder(name, value);\n\n\tthis.refresh();\n\tthis.callEvent(\"onMathRefresh\",[]);\n}","import * as sheets from \"../sheets\";\nimport * as spn from \"../operations/spans\";\nimport * as und from \"../operations/undo\";\nimport group from \"../operations/undo_group\";\nimport * as stl from \"../operations/styles\";\nimport * as srt from \"../operations/sorting\";\nimport {removeCommentsRange} from \"../operations/comments\";\nimport {clearConditionalFormats} from \"../operations/conditional_formats\";\nimport {clearEditors} from \"../operations/dropdown\";\nimport {clearFilters} from \"../operations/filter\";\n\n//spans\nexport function combineCells(range){\n\tif(!range){\n\t\tvar sel = this.getSelectedId(true);\n\t\tif (sel.length>1){\n\t\t\trange = spn.getRange(sel);\n\t\t}\n\t}\n\tgroup.set(()=> {\n\t\tif (range)\n\t\t\tspn.addSpan(this, range.cell, range.x, range.y);\n\t});\n\tthis.refresh();\n}\n\nexport function splitCell(row, column){\n\tif (row && column) {\n\t\tspn.removeSpan(this, {row: row, column: column});\n\t}\n\telse{\n\t\tgroup.set(function(){\n\t\t\tthis.eachSelectedCell(function(cell){\n\t\t\t\tspn.removeSpan(this, cell);\n\t\t\t});\n\t\t},this);\n\n\t}\n\n\tthis.refresh();\n}\n\n//styles\nexport function addStyle(prop, origin){\n\treturn stl.addStyle(this, prop, origin);\n}\n\nexport function getStyle(row, column){\n\treturn stl.getStyle(this, {row:row, column:column});\n}\n\nexport function setStyle(row, column, style){\n\treturn stl.setStyle(this, {row: row, column: column}, style);\n}\n\nexport function setRangeStyle(rangeStr, style){\n\tgroup.set(function() {\n\t\tstl.setRangeStyle(this, rangeStr, style);\n\t},this);\n}\n\nexport function clearRange(rangeStr, type) {\n\tif (!rangeStr){\n\t\trangeStr = this._table.getSelectArea();\n\t\tif (!rangeStr) return;\n\t}\n\n\tif (!type) type = {styles: true, values: true, editors:true, conditions:true, comments:true };\n\t\n\tif (type.styles)\n\t\tstl.clearRangeStyle(this,rangeStr);\n\n\tif (type.conditions)\n\t\tclearConditionalFormats(this,rangeStr);\n\t\n\tif (type.values)\n\t\tthis.setRangeValue(rangeStr, null);\n\n\tif (type.editors){\n\t\tclearEditors(this, rangeStr);\n\t\tclearFilters(this, rangeStr);\n\t}\n\n\tif (type.comments)\n\t\tremoveCommentsRange(this, rangeStr);\n\n\tthis.refresh();\n}\n\nexport function compactStyles(){\n\treturn stl.compactStyles(this);\n}\n\n// serialize\nexport function serialize(config){\n\tconst obj = {};\n\tthis.callEvent(\"onDataSerialize\",[obj, config]);\n\n\tif(config){\n\t\tif(config.compactStyles)\n\t\t\tobj.styles = stl.removeUnusedStyles(obj);\n\t\tif(config.sheets)\n\t\t\treturn sheets.serialize(this, obj, config);\n\t}\n\n\treturn obj;\n}\n\n//sheets\nexport function showSheet(name){\n\tsheets.show(this,name);\n}\nexport function getActiveSheet(){\n\treturn this._activeSheet;\n}\nexport function addSheet(content){\n\tsheets.add(this, content);\n}\nexport function clearSheet(){\n\tthis.reset();\n}\nexport function renameSheet(name,newName){\n\tsheets.rename(this,name,newName);\n}\nexport function editSheet(name){\n\tsheets.edit(this,name);\n}\nexport function removeSheet(name){\n\tsheets.remove(this,name);\n}\n\n\n//undo\nexport function undo(){\n\tund.undo(this);\n}\nexport function redo(){\n\tund.redo(this);\n}\n\n// sort\nexport function sortRange(range, dir){\n\tsrt.sortRange(this, range, dir);\n}","import {toRange,rangeObj} from \"../helpers/column_names\";\nimport * as tbl from \"../table\";\nimport group from \"../operations/undo_group\";\nimport {newSheet} from \"../sheets\";\nimport {getType} from \"../operations/types\";\nimport {getExcelDateFromJs} from \"../mathematics/methods\";\n\nexport function refresh(all){\n\tif (all)\n\t\tthis._table.refreshColumns();\n\telse\n\t\tthis._table.refresh();\n}\nexport function eachSelectedCell(cb){\n\tvar cells = this.getSelectedId(true);\n\tfor (var i=0; i<cells.length; i++)\n\t\tcb.call(this, cells[i]);\n}\nexport function getSelectedRange(sheet){\n\tvar area = this._table.getSelectArea();\n\tif (area){\n\t\tif (sheet)\n\t\t\tsheet = this.getActiveSheet();\n\t\treturn toRange(area.start.row,area.start.column,area.end.row,area.end.column,sheet);\n\t}\n\treturn \"\";\n}\nexport function getSelectedId(all){\n\tvar area = this._table.getSelectArea();\n\tif(!all)\n\t\treturn area && area.start.row ? area.start : null;\n\n\tvar selection = [];\n\tif(area){\n\t\tvar c0 = area.start;\n\t\tvar c1 = area.end;\n\n\t\tfor(var i = c0.row; i<= c1.row; i++){\n\t\t\tfor(var j = c0.column; j <= c1.column; j++){\n\t\t\t\tselection.push({row: i,column:j});\n\t\t\t}\n\t\t}\n\t}\n\n\treturn selection;\n\t//return this._table.getSelectedId(all)\n}\nexport function getCellValue(row, column, math){\n\tconst value = this._mPage.getValue(row-1, column-1, math !== false);\n\n\treturn correctVal(value);\n}\nexport function setCellValue(row, column, value){\n\tvalue = correctVal(value);\n\tconst old = this.getCellValue(row, column);\n\tconst oldType = getType(this, row, column);\n\n\tlet sameValue;\n\tif(oldType == \"date\"){\n\t\tconst parser = webix.Date.strToDate( webix.i18n.spreadsheet.formats.parseDateTime );\n\t\tconst dateValue = isNaN(value) ? getExcelDateFromJs(parser(value)) : value;\n\t\tsameValue = old == dateValue;\n\t}\n\telse if(oldType != \"string\" && value !== \"\" && !isNaN(value) && old == value){\n\t\tsameValue = true;\n\t\tvalue = value*1;\n\t}\n\n\tif (!sameValue && old !== value){\n\t\tgroup.set(()=>{\n\t\t\tif (this.callEvent(\"onBeforeValueChange\",[row, column, value, old])){\n\t\t\t\tthis._mPage.setValue(row-1, column-1, value);\n\n\t\t\t\t//onCellChange can change item (via types module)\n\t\t\t\tthis.callEvent(\"onCellChange\", [row, column, value]);\n\t\t\t\tconst updatedType = getType(this, row, column);\n\n\t\t\t\t//recalculate if we refer to a cell, where type is string and value is something like 005 or 5e5\n\t\t\t\tif(oldType != updatedType && updatedType == \"string\" && value[0] == \"=\" && value.length > 1)\n\t\t\t\t\tthis._mPage.setValue(row-1, column-1, value);\n\n\t\t\t\tthis.saveCell(row, column);\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction correctVal(val){\n\treturn val || val === 0 ? val : \"\";\n}\n\nexport function setRangeValue(range, value){\n\tgroup.set(function(){\n\t\tvar pos = rangeObj(range, this);\n\t\tfor (let row = pos.start.row; row <= pos.end.row; row++) {\n\t\t\tfor (let column = pos.start.column; column <=  pos.end.column; column++) {\n\t\t\t\tthis.setCellValue(row, column, value);\n\t\t\t}\n\t\t}\n\t},this);\n\n}\n\nexport function getRow(id){\n\tconst row = webix.copy(this._table.getItem(id));\n\n\tfor(let i = 1; i < this.config.columnCount; i++){\n\t\tconst cell = this._mPage.getCell(id-1, i-1);\n\n\t\tif(cell){\n\t\t\trow[i] = cell.value;\n\n\t\t\t[[\"style\", \"$cellCss\"], [\"type\", \"$cellType\"], [\"format\", \"$cellFormat\"]].forEach(param => {\n\t\t\t\tconst val = cell[param[0]];\n\t\t\t\tif(val){\n\t\t\t\t\tif(!row[param[1]])\n\t\t\t\t\t\trow[param[1]] = {};\n\t\t\t\t\trow[param[1]][i] = val;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst math =  this.getCellValue(id, i, true);\n\t\t\tif(math && math[0] == \"=\")\n\t\t\t\trow[\"$\"+i] = math;\n\t\t}\n\t}\n\n\treturn row;\n}\nexport function getColumn(id){\n\treturn this._table.getColumnConfig(id);\n}\nexport function reset(mode){\n\tvar obj = { data:[] };\n\tif (mode && mode.sheets){\n\t\tobj = newSheet(obj);\n\t}\n\t\n\tthis.parse(obj);\n}\n\nexport function _resetTable(){\n\ttbl.reset(this);\n}\n","import {save} from \"../operations/save\";\n\nexport function saveCell(row, column){\n\tvar style = this.getStyle(row, column);\n\n\tsave(this, \"data\", {\n\t\trow: row,\n\t\tcolumn: column,\n\t\tvalue: this.getCellValue(row, column),\n\t\tstyle: (style ? style.id : \"\")\n\t});\n}","export function setCellEditor(row, column, editor) {\n\tconst line = this._table._ssEditors[row] = this._table._ssEditors[row] || {};\n\tconst value = line[column] || null;\n\tline[column] = editor;\n\n\tif (editor && editor.editor){\n\t\tthis._table.addCellCss(row,column, \"ss_editor\");\n\t} else {\n\t\tdelete this._table._ssEditors[row][column];\n\t\tthis._table.removeCellCss(row,column, \"ss_editor\");\n\t}\n\tthis.callEvent(\"onAction\", [\"dropdown\", { row, column, value, newValue:editor }]);\n}\n\nexport function getCellEditor(row, column){\n\tlet line = this._table._ssEditors[row] || {};\n\treturn line[column] || null;\n}","import * as flt from \"../operations/filter\";\n\nexport function setCellFilter(row, column, filter){\n\tconst line = this._table._ssFilters[row] = this._table._ssFilters[row] || {};\n\tconst value = line[column] || null;\n\n\tif (filter && (webix.isArray(filter) || typeof filter == \"string\"))\n\t\tfilter = { options:filter };\n\tline[column] = filter;\n\n\tif (filter && typeof filter == \"object\"){\n\t\tthis._table.addCellCss(row,column, \"ss_filter\");\n\t\tif (filter.value && flt.isValueActive(filter.value))\n\t\t\tthis._table.addCellCss(row,column, \"ss_filter_active\");\n\n\t\twebix.extend(filter, {row, column}, true);\n\t\tfilter.options = flt.calibrateRange(this, row, column, filter.options);\n\n\t\tif (!filter.handler && filter.value && filter.value.condition){\n\t\t\tconst mode = filter.mode || flt.getFilterMode(this, row, column);\n\t\t\tfilter.handler = flt.getFilterFunction(mode, filter.value);\n\t\t}\n\t} else {\n\t\tdelete this._table._ssFilters[row][column];\n\t\tthis._table.removeCellCss(row,column, \"ss_filter\");\n\t\tthis._table.removeCellCss(row,column, \"ss_filter_active\");\n\t}\n\tthis.callEvent(\"onAction\", [\"filter\", { row, column, value, newValue:filter }]);\n}\n\nexport function getCellFilter(row, column){\n\tlet line = this._table._ssFilters[row] || {};\n\treturn line[column] || null;\n}\n\nexport function removeFilters(){\n\tconst filters = flt.getFilters(this._table);\n\n\tfor\t(let i=0; i<filters.length; i++){\n\t\tconst {row, column} = filters[i];\n\t\tthis.setCellFilter(row, column, null);\n\t}\n\n\tthis._table._ssFilters = {};\n\tthis._table.data.filter((obj) => {\n\t\treturn this.isRowVisible(obj.id);\n\t});\n}\n\n\nexport function filterSpreadSheet(){\n\tthis._table.data.silent(function(){\n\t\tconst filters = flt.getFilters(this._table);\n\n\t\t// hidden rows\n\t\tthis._table.data.filter((obj) => {\n\t\t\treturn this.isRowVisible(obj.id);\n\t\t});\n\n\t\tfor (let i=0; i<filters.length; i++){\n\t\t\tconst {row, column, handler} = filters[i];\n\n\t\t\tlet all = false;\n\t\t\tthis._table.data.filter(obj => {\n\t\t\t\tif (all || obj.id*1 <= row*1) return true;\n\n\t\t\t\tlet value = this._mPage.getValue(obj.id - 1, column - 1);\n\n\t\t\t\tif (!value && value !== \"\") return all = true;\n\t\t\t\treturn (typeof handler == \"function\") ? handler( String(value) ) : true;\n\t\t\t}, 1, true);\n\t\t}\n\t}, this);\n\n\tthis._table.callEvent(\"onAfterFilter\", []);\n\tthis._table.refresh();\n}\n","export function confirm(config){\n\treturn webix.confirm({\n\t\tcss:\"webix_ssheet_confirm\",\n\t\ttext:config.text,\n\t\tok: webix.i18n.spreadsheet.labels.ok,\n\t\tcancel: webix.i18n.spreadsheet.labels.cancel\n\t});\n}\n\nexport function alert(config){\n\treturn webix.alert({\n\t\tcss: \"webix_ssheet_alert\",\n\t\ttext:config.text,\n\t\tok: webix.i18n.spreadsheet.labels.ok\n\t});\n}","import * as undo from \"../operations/undo\";\nimport group from \"../operations/undo_group\";\n\nexport function resetUndo(){\n\tundo.reset(this);\n}\n\nexport function groupUndo(func){\n\tgroup.set(func, this);\n}\n\nexport function ignoreUndo(func){\n\tundo.ignoreUndo(func, this);\n}","import * as fmt from \"../operations/formats\";\n\nexport function setFormat(row, column, format){\n\tfmt.addFormat(this, row, column, format);\n}\n\nexport function changeDecimals(row, column, inc){\n\t//row and column may be obj\n\tfmt.changeAreaDecimals(this, inc, row, column);\n}","const defaultMenu = [\n\t{ id:\"file\", submenu:[\n\t\t{id: \"sheet\", submenu: [\n\t\t\t{id: \"new-sheet\"},\n\t\t\t{id: \"copy-sheet\"},\n\t\t\t{id: \"remove-sheet\"}\n\t\t]},\n\t\t{id: \"excel-import\"},\n\t\t{id: \"excel-export\"}\n\t]},\n\t{ id:\"edit\", submenu:[\n\t\t{id: \"add-range\"},\n\t\t{id: \"add-dropdown\"},\n\t\t{id: \"add-link\"},\n\t\t{id: \"lock-cell\"},\n\t\t{id: \"conditional-format\"},\n\t\t{id: \"clear\", submenu:[\n\t\t\t{id: \"clear-value\"},\n\t\t\t{id: \"clear-style\"},\n\t\t\t{id: \"clear-conditional-formats\"},\n\t\t\t{id: \"clear-dropdown-editors\"},\n\t\t\t{id: \"clear-comments\"},\n\t\t\t{ $template:\"Separator\" },\n\t\t\t{id: \"clear-all\"}\n\t\t]}\n\t]},\n\t{ id:\"insert\", submenu:[\n\t\t{id: \"image\", submenu:[\n\t\t\t{ id: \"add-image-cell\"},\n\t\t\t{ id: \"add-image-top\"}\n\t\t]},\n\t\t{id: \"graph\", submenu:[\n\t\t\t{ id: \"add-sparkline\"},\n\t\t\t{ id: \"add-chart\"}\n\t\t]},\n\t\t{id: \"add-comment\"}\n\t]},\n\t{ id:\"data\", submenu:[\n\t\t{id: \"sort\", submenu: [\n\t\t\t{id: \"sort-asc\"},\n\t\t\t{id: \"sort-desc\"}\n\t\t]},\n\t\t{id: \"create-filter\"}\n\t]},\n\t{ id: \"view\", submenu:[\n\t\t{id: \"columns\", submenu: [\n\t\t\t{id: \"insert-column\"},\n\t\t\t{id: \"delete-column\"},\n\t\t\t{id: \"show-column\"},\n\t\t\t{id: \"hide-column\"},\n\t\t\t{id: \"resize-column\"}\n\t\t]},\n\t\t{id: \"rows\", submenu: [\n\t\t\t{id: \"insert-row\"},\n\t\t\t{id: \"delete-row\"},\n\t\t\t{id: \"show-row\"},\n\t\t\t{id: \"hide-row\"},\n\t\t\t{id: \"resize-row\"}\n\t\t]},\n\t\t{ $template:\"Separator\" },\n\t\t{id: \"freeze-columns\"},\n\t\t{id: \"freeze-rows\"},\n\t\t{id: \"hide-gridlines\"},\n\t\t{id: \"hide-headers\"}\n\t]}\n];\n\nconst ui = {\n\tgetMenuData: function(menu, config){\n\t\tvar i;\n\t\tfor(i=0; i < menu.length; i++){\n\t\t\tif(typeof menu[i] == \"string\")\n\t\t\t\tmenu[i] = {id: menu[i]};\n\t\t\tif((menu[i].id == \"resize-column\" || menu[i].id == \"resize-row\") && !config.resizeCell){\n\t\t\t\tmenu.splice(i,1);\n\t\t\t\ti--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(!menu[i].value)\n\t\t\t\tmenu[i].value = webix.i18n.spreadsheet.menus[menu[i].id];\n\t\t\tif(menu[i].submenu)\n\t\t\t\tmenu[i].submenu = this.getMenuData(menu[i].submenu, config);\n\t\t}\n\n\t\treturn menu;\n\t}\n};\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\tvar config = view.config,\n\t\tmenu = {\n\t\t\tview: \"menu\",\n\t\t\tborderless: true,\n\t\t\tcss: \"webix_ssheet_menu\",\n\t\t\tid: \"menu\",\n\t\t\tautowidth: true,\n\t\t\ttype:{\n\t\t\t\theight: 40\n\t\t\t},\n\t\t\tdata: ui.getMenuData(webix.isArray(config.menu)?config.menu : webix.copy(defaultMenu), view.config)\n\t\t};\n\n\tview.callEvent(\"onViewInit\", [\"menu\", menu]);\n\treturn menu;\n}\n\n\nfunction ready(view){\n\tif(view.$$(\"menu\"))\n\t\tview.$$(\"menu\").attachEvent(\"onMenuItemClick\",(id) => callAction(view,id));\n}\n\nconst actionMap = {\n\t\"undo\": function (view) {\n\t\tview.undo();\n\t},\n\t\"redo\": function (view) {\n\t\tview.redo();\n\t},\n\t\"insert-column\": function (view) {\n\t\tview.insertColumn();\n\t},\n\t\"delete-column\": function (view) {\n\t\tview.deleteColumn();\n\t},\n\t\"show-column\": function (view) {\n\t\tview.hideColumn(null,false);\n\t},\n\t\"hide-column\": function (view) {\n\t\tview.hideColumn(null,true);\n\t},\n\t\"resize-column\": function (view) {\n\t\t//like we are calling from the toolbar\n\t\tview.callEvent(\"onCommand\",[{id: \"resize\", group: \"column\", value: webix.i18n.spreadsheet.menus[\"resize-column\"]}]);\n\t},\n\t\"insert-row\": function (view) {\n\t\tview.insertRow();\n\t},\n\t\"delete-row\": function (view) {\n\t\tview.deleteRow();\n\t},\n\t\"show-row\": function (view) {\n\t\tview.hideRow(null,false);\n\t},\n\t\"hide-row\": function (view) {\n\t\tview.hideRow(null,true);\n\t},\n\t\"resize-row\": function (view) {\n\t\t//like we are calling from the toolbar\n\t\tview.callEvent(\"onCommand\",[{id: \"resize\", group: \"row\", value: webix.i18n.spreadsheet.menus[\"resize-row\"]}]);\n\t},\n\t\"freeze-columns\": function(view){\n\t\tview.freezeColumns();\n\t},\n\t\"hide-gridlines\": function(view){\n\t\tview.hideGridlines(\"toggle\");\n\t},\n\t\"hide-headers\": function(view){\n\t\tview.hideHeaders(\"toggle\");\n\t}\n};\n\nfunction callAction(view,id){\n\tif(view.callEvent(\"onMenuItemClick\",[id])){\n\t\tif(actionMap[id])\n\t\t\tactionMap[id](view);\n\t\telse\n\t\t\tview.callEvent(\"onCommand\",[{id: id}]);\n\t}\n}","//global definitions\nimport \"./locale\";\nimport \"./views/index\";\n\n//special content for non-production builds\nimport \"./init\";\n\nimport \"./editors/index\";\n\n//modules\nimport * as bar from \"./toolbar\";\nimport * as tbl from \"./table\";\nimport * as key from \"./hotkeys\";\nimport * as editor from \"./editor\";\nimport * as sheets from \"./sheets\";\nimport * as dialogs from \"./dialogs/index\";\nimport * as context from \"./context\";\nimport * as chart from \"./chart\";\n\nimport {setDefaultFormats} from \"./operations/formats\";\nimport {operations} from \"./operations/index\";\nimport {api} from \"./api/index\";\n\n//styling\nimport * as menu from \"./menu\";\nimport {getDefaultStyles} from \"./helpers/conditional\";\nimport {setSkinDefaults} from \"./toolbar/defaults\";\n\nvar component = {\n\tname:\"spreadsheet\",\n\t_base_index:{ count:1 },\n\tdefaults:{\n\t\tspans: true,\n\t\tliveEditor: true,\n\t\trowCount:50,\n\t\tmath:true,\n\t\tcolumnCount:20,\n\t\tresizeCell: true,\n\t\tsheetTabWidth: 90,\n\t\tconditionStyle: getDefaultStyles()\n\t},\n\t$init:function(){\n\t\tthis.$index = (this._base_index.count++);\n\t\tthis.$view.className += \" webix_ssheet\";\n\n\t\tthis.$ready.unshift(this._sub_init);\n\t\tthis.$ready.unshift(setDefaultFormats);\n\t\tthis.$ready.push(this._set_handlers);\n\n\t\tthis._destroy_with_me = [];\n\t\tthis.attachEvent(\"onDestruct\", () => {\n\t\t\tthis._destroy_with_me.forEach(view => view.destructor());\n\t\t});\n\t},\n\t$skin:function(){\n\t\tsetSkinDefaults();\n\t},\n\t_sub_init:function(){\n\t\tconst obj = this.config;\n\t\tconst rows = [];\n\n\t\t//toolbars\n\t\tif(!obj.readonly && obj.menu)\n\t\t\trows.push(menu.init(this));\n\t\tif(!obj.readonly && obj.toolbar !== false)\n\t\t\trows.push(bar.init(this));\n\t\tif (obj.subbar)\n\t\t\trows.push(obj.subbar);\n\t\tif(!obj.readonly && obj.liveEditor)\n\t\t\trows.push(editor.init(this));\n\n\t\t//data part\n\t\tconst tblObj = {\n\t\t\teditable : !obj.readonly,\n\t\t\tliveEditor: obj.liveEditor\n\t\t};\n\t\tif(obj.rowHeight)\n\t\t\ttblObj.rowHeight = obj.rowHeight;\n\t\tif(obj.columnWidth)\n\t\t\ttblObj.columnWidth = obj.columnWidth;\n\n\t\tif(obj.readonly)\n\t\t\trows.push(tbl.init(this, tblObj));\n\t\telse\n\t\t\trows.push({cols:[tbl.init(this, tblObj), chart.init(this)]});\n\n\t\tconst bottom = obj.bottombar === true ? sheets.defaultBottom(this) : obj.bottombar;\n\t\tif (bottom)\n\t\t\trows.push(bottom);\n\n\t\tsheets.init(this);\n\n\t\tif(!obj.readonly)\n\t\t\tcontext.init(this);\n\n\t\tdialogs.init(this);\n\n\t\tthis.rows_setter(rows);\n\t},\n\t_set_handlers:function(){\n\t\t//prevent double init\n\t\tif (this._table) return;\n\t\tthis._table = this.$$(\"cells\");\n\n\t\t//init all sub modules\n\t\toperations(this);\n\n\t\t//set sizes for the table\n\t\ttbl.reset(this, this.config.columnCount, this.config.rowCount);\n\t\tkey.init(this); //keyboard shortcuts\n\t\t\n\t\tthis._table.attachEvent(\"onAfterAreaAdd\", () =>\n\t\t\tthis.callEvent(\"onAfterSelect\", [ this.getSelectedId(true) ]));\n\n\t\tthis.callEvent(\"onComponentInit\", []);\n\t},\n\t$onLoad:function(obj, driver){\n\t\t//when loading data by data:, we can get $onLoad before _set_handlers call\n\t\tthis._set_handlers();\n\n\t\tif (obj.excel)\n\t\t\tobj = this._parseExcel(obj, driver);\n\t\telse if(!obj.data && typeof obj == \"string\" && (driver.cell || driver.row))\n\t\t\tobj = this._parseCsv(obj, driver);\n\n\t\tsheets.load(this, obj);\n\t}\n};\napi(component);\nwebix.protoUI(component, webix.AtomDataLoader, webix.IdSpace, webix.ui.layout);\n","import {isCellSelected, isColSelected,isRowSelected,selectRow,selectColumn} from \"./operations/column_operations\";\nimport {getColumnOperation, getRowOperation, getClearOperation} from \"./toolbar/buttons\";\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => view.$$(\"context\").attachTo(view._table.$view));\n\n\tvar locale = webix.i18n.spreadsheet.menus;\n\tconst lists = {\n\t\tdata:[\n\t\t\t{ id:\"clear\",\t\tvalue: locale[\"clear\"], submenu: getClearOperation()},\n\t\t\t{ id:\"lock-cell\",\t\tvalue: locale[\"lock-cell\"]},\n\t\t\t{ $template: \"Separator\"},\n\t\t\t{ id:\"sort\",\tvalue: locale.sort, submenu:[\n\t\t\t\t{id: \"sort-asc\", value: locale[\"sort-asc\"]},\n\t\t\t\t{id: \"sort-desc\", value: locale[\"sort-desc\"]}\n\t\t\t]},\n\t\t\t{id:\"create-filter\",\t\tvalue: locale[\"create-filter\"]},\n\t\t\t{ $template: \"Separator\"},\n\t\t\t{ id:\"add-range\",\t\tvalue: locale[\"add-range\"]},\n\t\t\t{ id:\"add-link\",\t\tvalue: locale[\"add-link\"]},\n\t\t\t{ id:\"add-comment\",\t\tvalue: locale[\"add-comment\"]}\n\t\t],\n\t\tcolumn: getColumnOperation(view),\n\t\trow: getRowOperation(view)\n\t};\n\n\n\tvar context = {\n\t\tview: \"contextmenu\",\n\t\tid: \"context\",\n\t\tpadding:0,\n\t\tsubmenuConfig:{\n\t\t\tpadding:0,\n\t\t\ton:{\n\t\t\t\tonBeforeShow:function(){\n\t\t\t\t\tthis.sizeToContent();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tdata:[],\n\t\ton:{\n\t\t\tonMenuItemClick(id) {\n\t\t\t\tview.callEvent(\"onCommand\", [this.getMenuItem(id)]);\n\t\t\t},\n\t\t\tonBeforeShow(pos) {\n\t\t\t\twebix.callEvent(\"onClick\", []);\n\t\t\t\tvar mode, trg;\n\n\t\t\t\ttrg = view._table.locate(pos);\n\t\t\t\tif (!trg) return false;\n\n\t\t\t\tmode = \"\";\n\t\t\t\tif (trg.header && trg.column !== \"rowId\"){\n\t\t\t\t\tif (!isColSelected(trg.column, view))\n\t\t\t\t\t\tselectColumn(trg.column, view);\n\t\t\t\t\tmode = \"column\";\n\t\t\t\t} else if (trg.row){\n\t\t\t\t\tif (trg.column === \"rowId\"){\n\t\t\t\t\t\tif (!isRowSelected(trg.row, view))\n\t\t\t\t\t\t\tselectRow(trg.row, view);\n\t\t\t\t\t\tmode = \"row\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (!isCellSelected(trg.row, trg.column, view))\n\t\t\t\t\t\t\tview._table.addSelectArea(trg, trg);\n\t\t\t\t\t\tmode = \"data\";\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (mode){\n\t\t\t\t\tvar data = getMenuData(view, mode, lists[mode]);\n\t\t\t\t\tif (data){\n\t\t\t\t\t\tthis.clearAll();\n\t\t\t\t\t\tthis.parse(data);\n\t\t\t\t\t\tthis.sizeToContent();\n\t\t\t\t\t\twebix.html.preventEvent(pos);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"context\", context]);\n\tconst contextMenu = view.ui(context);\n\n\tview._destroy_with_me.push(contextMenu);\n}\n\nexport function getMenuData(view, name, data){\n\tvar ev = { area:name, data:data };\n\tif (view.callEvent(\"onContextMenuConfig\", [ev]))\n\t\treturn ev && ev.data;\n\treturn null;\n}","import * as m1  from \"./add_row_col\";\nimport * as m6  from \"./clipboard\";\nimport * as m12 from \"./column_operations\";\nimport * as m2  from \"./conditional_formats\";\nimport * as m4 from \"./types\";\nimport * as m8 from \"./formats\";\nimport * as m17 from \"./data\";\nimport * as m18 from \"./dropdown\";\nimport * as m7  from \"./formats\";\nimport * as m13 from \"./hide_row_col\";\nimport * as m14 from \"./lock_cell\";\nimport * as m3  from \"./resize\";\nimport * as m9  from \"./selection\";\nimport * as m10 from \"./sorting\";\nimport * as m16 from \"./spans\";\nimport * as m16a from \"../mathematics/methods\";\nimport * as m16b from \"../mathematics/ranges\";\nimport * as m16c from \"../mathematics/sheets\";\nimport * as m19 from \"./states\";\nimport * as m5  from \"./styles\";\nimport * as m11 from \"./undo\";\nimport * as m20 from \"./import\";\nimport * as m21 from \"./filter\";\nimport * as m22 from \"./print\";\nimport * as m23 from \"./export\";\nimport * as m24 from \"./load\";\nimport * as m25 from \"./clear_styles\";\nimport * as m26 from \"./comments\";\nimport * as m27 from \"./save\";\nimport * as m28 from \"./hide_headers\";\nimport * as m29 from \"./hide_gridlines\";\nimport * as m30 from \"./views\";\n\nexport function operations(view){\n\t//order in some cases does matter\n\t//resize must be applied after math, to size data by the result of math calculation\n\t//types must be applied after state and data \n\tvar all = [m1,m2,m5,m6,m7,m9,m10,m11,m12,m13,m14,m16,m3,m8,m17,m16a,m16b,m16c,m18,m19,m4,m20,m21,m22,m23,m24,m25,m26,m27,m28,m29,m30];\n\tfor (var i = 0; i < all.length; i++){\n\t\tif (all[i].init)\n\t\t\tall[i].init(view);\n\t}\n}","import * as rco from \"./row_col_operations\";\nimport * as lcl from \"./lock_cell\";\nimport * as fcl from \"./freeze\";\nimport * as hbr from \"./hide_gridlines\";\nimport * as hhd from \"./hide_headers\";\nimport * as hrc from \"./hide_rows\";\nimport * as mat from \"./math\";\nimport * as ops from \"./operations\";\nimport * as cor from \"./core\";\nimport * as sav from \"./save\";\nimport * as dpd from \"./dropdown\";\nimport * as flt from \"./filter\";\nimport * as cfm from \"./confirm\";\nimport * as und from \"./undo\";\nimport * as fmt from \"./number_formats\";\n\nexport function api(view){\n\tvar all = [rco, lcl, fcl, hbr, hhd, hrc, mat, ops, cor, sav, dpd, flt, cfm, und, fmt];\n\tfor (var i = 0; i < all.length; i++)\n\t\twebix.extend(view, all[i]);\n}"],"names":["webix","i18n","spreadsheet","labels","tooltips","menus","table","liveEditor","formats","protoUI","name","$cssName","$init","config","options","view","body","tooltip","template","xCount","yCount","data","ui","richselect","defaults","width","margin","cols","scroll","select","obj","id","on","onAfterSelect","this","getParentView","updateMasterValue","value","rows","css","skin","$name","title","onChange","suggest","fitMaster","hide","getValue","$$","master","setValue","getList","getColorView","getTypeView","getSelectedId","getBody","getChildViews","getItemText","$ready","push","bind","getPopup","isArray","callEvent","join","height","type","palette","attachEvent","setMasterValue","colorboard","icon","borderless","$view","className","$renderInput","divStart","color","renderColor","call","replace","match","p1","p2","p3","colorpicker","prototype","$setValue","popup","toString","getColorNode","style","backgroundColor","firstChild","childNodes","$renderIcon","text","apply","arguments","Object","defineProperty","exports","t","e","1","2","3","r","assign","n","length","o","hasOwnProperty","a","s","i","u","f","h","c","p","g","code","l","source","_","v","d","b","pageName","substr","indexOf","toUpperCase","String","fromCharCode","charCodeAt","y","m","x","I","P","M","C","z","E","T","k","page","O","D","w","N","A","R","S","U","exec","broken","triggers","Function","Date","getFullYear","valueOf","getTimezoneOffset","Math","floor","round","getTime","isNaN","concat","ceil","freeze","__proto__","SUM","AVERAGE","COUNT","COUNTA","COUNTBLANK","MAX","MIN","PRODUCT","SUMPRODUCT","SUMSQ","pow","VARP","STDEVP","sqrt","POWER","QUOTIENT","SQRT","ABS","abs","RAND","random","PI","INT","ROUND","parseFloat","toFixed","ROUNDDOWN","ROUNDUP","TRUNC","EVEN","sign","ODD","CONCATENATE","LEFT","substring","MID","RIGHT","LOWER","toLowerCase","UPPER","PROPER","split","TRIM","trim","LEN","DATE","TIME","DAY","getDate","MONTH","getMonth","YEAR","HOUR","getHours","MINUTE","getMinutes","SECOND","getSeconds","NOW","DATEDIF","IF","number","string","date","other","F","V","get","set","_getter","_setter","_parser","_printer","_parseContext","pageObj","$count","_data","Map","_triggers","_holders","_context","Error","getPlaceholder","_removeTriggers","trigger","clean","setPlaceholder","entries","forEach","each","setMath","_generate","_setMathAt","_execAndTrigger","refresh","getMath","Set","add","triggerSet","size","values","next","done","_check_for_loops","has","delete","_errorAndTrigger","findIndex","splice","parse","_exec","Array","from","keys","setLogger","_err_handler","_setErr","isFinite","regenerate","recalculate","debug","console","log","transpose","_transpose","transposeMath","Y","_id","_store","_meta","getMeta","setMeta","getID","cellID","getSize","getContext","addRow","j","removeRow","addColumn","removeColumn","setCell","getCell","getRange","getCellRange","eachCell","serialize","G","_ranges","_counter","_rangeOrder","_page","_pageGetter","toId","_next_id","_refresh","remove","map","renamePage","L","_pages","_pageNames","_pageName2ID","_pCounter","$format","getPage","addPage","removePage","getRanges","getStore","slice","getJsDateFromExcel","excelDate","getExcelDateFromJs","jsDate","init","addMethod","url","escape","arr","color1","color2","negativeColor","Sparklines","getTemplate","getJsDate","getExcelDate","datepicker","$prepareValue","copy","start","end","daterangepicker","buttons","close","getBodyConfig","content","elements","getFormElements","padding","$active","layoutPadding","form","label","cancel","autowidth","click","getTopParentView","save","hotkey","body_setter","_typeof","isUndefined","window","move","head","autofocus","IdSpace","headerRowHeight","datatable","setHTML","dataview","contextmenu","group","method","uid","all","sheets","proxy","$parse","$proxy","ajax","headers","post","thread","events","handler","newName","params","_loading_data","getActiveSheet","clearTimeout","delay","decode","encode","alpha","prefixIndex","parseInt","str","adress","col","range","nind","sheet","parts","ranges","getCode","rangeParts","d1","d2","escapeSheet","toRange","x2","y2","rangeObj","row","column","eachRange","callback","cellTest","isRange","cells","test","pop","changeRange","inc","updated","r1","c1","r2","c2","toolbarSizes","paddingY","sectorPadding","sectorMargin","defaultStyles","style_names","_style_map","left","center","right","top","middle","bottom","wrap","getBorderCss","pos","border","sizeEl","border_checks","cell","area","mode","_style_handlers","getSelectArea","lineStyle","modes","_updateStyle","reset","_styles","_styles_cache","_styles_max","prefix","$index","html","removeStyle","getStyle","_mPage","span","getSpan","spanStyles","spanStyle","getFormat","format","addStyle","props","origin","styleFromText","key","_styleToText","cache","_addStyle","_parse","styles","styleObj","update_style_data","nstyle","setStyle","_setStyle","setRangeStyle","getTextSize","baseWidth","innerHTML","_table","appendChild","max","offsetWidth","offsetHeight","removeChild","old","oldFormat","formatChanged","saveCell","silent","_buildCssString","clearRangeStyle","compactStyles","serialized","removeUnusedStyles","used","newStyles","_applyStyles","eachSelectedCell","_applyCellStyles","ostyle","_serialize","_undoStyle","create","formatsCount","formatSources","formatCache","formatHelpers","currencies","setDefaultFormats","formatsLocale","price","getCurrencySymbol","extra","priceFormat","extend","zeros","priceSettings","decimalSize","symbol","separator","negative","getDelimiters","numberFormat","percent","format2code","dateFormat","serializeFormat","formToValues","groupSign","groupDelimiter","decimalSign","decimalDelimiter","getFormatSource","toexcel","parseFormat","createFormatName","formatToForm","dates","timeFormat","fullDateFormat","longDateFormat","find","red","first","second","priceBrackets","currency","isPrice","delimiters","integer","decimal","addFormat","nev","removeFormat","splitFormat","conditional","errorMessage","separated","separateFmt","genCode","condition","fmt","check","line","ind","isAbs","genFormatCode","isQuote","comma","numberPlaceholder","textPlaceholder","symbolPos","multiply","lastDateType","val","betweenPlaceholders","placeholder","datePart","excelDateToWebix","undefined","getParts","reverse","lzeros","lfills","rzeros","rfills","rmax","dateTypes","timeTypes","dateOrder","sort","timeOrder","typesOrder","order","types","changeAreaDecimals","getCells","rules","isNumber","changeCellDecimals","getFormatName","isCustom","updateDecimals","parsed","decimals","placeholders","withoutText","withoutPlaceholders","formValues","symbolId","toExcel","leftPlaceholders","fmtParts","sepFmtParts","getFmtPartValues","leftText","rightText","fmtPart","firstPlaceholder","index","Infinity","checkFormat","checkTime","quot","item","isDateInvalid","getDateEditFormat","formatName","locale","isTime","dateToStr","getFormatFromData","styleName","fmtName","load","defaultFormats","isChar","char","getLastCharIndex","getWord","formula","passive","quotes","operand","position","word","sum","flags","chars","crosssheet","activeSheet","lines","ph","escaped","pushLine","loadCell","setType","dateToExcel","setCellValue","getFormatType","formatType","getType","parseToStore","_setType","mathFormat","isFormula","parseDate","getMathFormat","blockLevel","level","methods","part","expectType","getExpectType","strToDate","parseDateTime","parser","ignoreUndo","checkType","updateCell","isString","cellEditor","getCellEditor","setFormat","setCellEditor","editor","filter","cursor","getInputNode","selectionStart","charAt","search","nextSymbol","node","tagName","_this","sizes","offset","textWidth","show","setValueHere","$enterKey","isVisible","getCellValue","action","newValue","getPopupConfig","onItemClick","button","getItem","suggestData","highlight","_highlightedCells","_update_range","_last_value_set","activeCell","showActiveSheet","updateCellValue","blur","preventEvent","oldVal","$handleSelection","UIManager","setFocus","eventRemove","keydownEv","event","_this2","endEdit","escapeText","changeCellCss","colorIndex","crossheet","cellSheet","prepareSheet","activeMath","_activeMath","cellText","rangeName","repeatedColor","nextCell","nextCellText","setColor","document","activeElement","paintValue","enter","grid","define","showSheet","moveSelection","which","keyCode","dir","getItemNode","newv","$setValueHere","str1","str2","setSelectionRange","expectOperator","setRange","len","lastPos","prepareArea","min","row1","col1","row2","col2","coloredArea","texthighlight","layout","drag","dragscroll","EditAbility","list","toggle","onValue","offValue","common","inp","awidth","aheight","$allowsClear","blockEvent","unblockEvent","arrow","elementsConfig","labelWidth","_initOnChange","$eventSource","_getCheckboxes","count","$all","_count","base","labelRight","active","baseHeight","inputHeight","checkboxes","output","scrollview","queryView","onSelectChange","focus","resize","toFront","minWidth","minHeight","escHide","autofit","setAttribute","addHotKey","_removeView","getMenu","_clickEv","_menu","destructor","move_setter","DragControl","addDrag","$dragPos","$dragCreate","object","trg","target","getAttribute","elOffset","elPos","pOffset","parentNode","state","getScrollState","toNode","$dragDestroy","submenu","readonly","submenuConfig","externalUI","onMenuItemClick","_menuActions","onBeforeShow","_toggleExcel","dots","toPDF","display","toPNG","header","pull","showItem","hideItem","layoutMargin","multi","getSectionConfig","onAfterScroll","addSection","trashIcon","dataPadding","upper","hidden","labelsVisible","markersVisible","onClick","removeView","childs","getLayout","lastIndex","layoutId","addView","setValues","setSubValue","sub","hideSubviews","child","getValues","editors","excel_date","createPopup","icons","timepicker","_last_input_target","onEnter","render","showPopup","input","updateCalendar","calendar","afterRender","ss_richselect","exists","popupInit","$value","actions","isMerged","c0","splitCell","confirm","then","combineCells","undo","redo","hideGridlines","hideHeaders","freezeColumns","freezeRows","fontFamily","getColumnOperation","colOperations","resizeCell","getRowOperation","rowOperations","getClearOperation","getLocaleClear","$template","borders","styleFormats","colorButton","toggleButton","iconButton","btn","segmented","popupWidth","popupTemplate","popupEvents","titleHeight","align","condFormat","buttonsMap","getFontSize","numbers","fontSize","px","getCellFormats","example","getText","getAllElements","calcButtons","groups","result","$button","insert","ready","selected","barStyles","getBarStyles","dropdowns","getCellStyles","cellStyle","property","updateValue","element","toolbar","allElements","elm","bottombar","toolbarButtons","structure","checkButtons","getButtons","columns","block","blockColumns","bar","viewId","innerId","selectRow","endRow","last","_selectRange","selectAll","firstColumn","selectColumn","endColumn","isColSelected","selectedArea","isCellSelected","isRowSelected","selectColumns","addSelectArea","adjustColumn","columnWidth","getColumnConfig","eachRow","getCellFilter","setColumnWidth","adjustRow","eachColumn","getSpanNode","setRowHeight","highlightColRow","sr","er","sc","ec","removeCellCss","addCellCss","getHeaderNode","removeCss","addCss","lockCss","lockCell","_mapCellsCalls","_locks","isCellLocked","cm","lock","updatePosition","locked","addSpan","extraCss","getExtraCss","setSpanValue","isEmpty","removeSpan","sel","lx","ly","rx","ry","cx","cy","setSpanCss","borderChecks","adjustSpan","spanData","checkSpan","selection","isFirstCell","pasteSpan","cutted","translate","mapCells","rid","cid","spans","isUndo","undoSpan","checkSpanBorders","isDate","conditions","batch","lastIndexOf","_mData","getConditionCss","rendered","_empty","collection","currentValue","rule","handlers","checkOrder","compare","addEmptyCollection","oldConditions","_pull","clear","rowId","columnId","clearConditionalFormats","_changeCondition","pasteCondition","oldCondition","newCondition","_normalizeValue","createRules","rId","cId","cond","update","newData","_setCondition","type_action","_undoCondition","dragStartColumn","dragEndColumn","showCommentHandler","comments","_activeComment","editStatus","locate","visible","commentsView","viewonly","contains","math","editMath","highlightHeaders","ids","cop","st","ed","ev","getEditor","$anyKey","finalStep","resizeColumn","cind","dx","posRelative","selectColumnHandler","lastHeaderClick","headerClick","dblClick","shiftKey","lastClickedRow","editStop","getFocus","need_focus","setDefaultCss","leftSplit","areaselect","minColumnWidth","editable","editaction","minRowHeight","navigation","cell_template","_v","valueOnly","invalidDate","helper","_print","clearAll","columnCount","rowCount","el","nms","cssFormat","getRenderedValue","refreshColumns","env","isMac","f2","edit","del","styleHotKey","ctrlU","ctrlP","attr","elementOn","methodsName","updateEditor","fillEditor","startEdit","symbols","disableEditor","disabled","disable","enable","_rangeDialog","en","pasteRange","updateRange","colon","isEnabled","clearEditor","isActiveCell","func","getDimension","spanEndRow","spanEndCol","getSheetData","tconfig","frozenColumns","frozenRows","_frozenColumns","_frozenRows","getState","_undoValue","actionMap","_activeSheet","prepare","selectSheet","command","changePagerVisability","sheetTabWidth","showBatch","changePagerStatus","scrollPos","tabWidth","context","dataOrder","num","_sheets","rename","defaultBottom","editValue","webix_ssheet_sheet_arrow","initSheetMenu","$sheetMenu","menuInit","menu","_destroy_with_me","callAction","getMark","disableItem","enableItem","scrollSheets","direction","scrollTo","newIndex","getNewTitle","getSheet","newSheet","changeId","linkRegex","DataStore","sheetName","tabs","_resetTable","Dialog","$dialog","$hide","$show","unescape","DialogBox","box","preview","parseImage","server","images","image","showPreview","upload","onBeforeFileAdd","file","reader","FileReader","onload","getFormView","readAsDataURL","onFileUpload","response","imageURL","onSaveClick","okClick","onCancelClick","fillUrl","addImage","viewid","open","views","els","parseChart","color_def","color_pos","color_neg","renderPreview","visibleBatch","labelPosition","getTypes","alert","checkRange","sparkConfig","addSparkline","clearValidation","selectedCell","getSelectedRange","scope","_updateData","toSheetRange","unshift","validate","oldData","_getScope","updateItem","unselect","_this3","theform","onBeforeSelect","removeRange","editRange","isNotEmpty","onFocus","autoheight","saveClick","selectedId","allRanges","nameParts","selectList","rangeVal","Ranges","_master","_normalizeName","_normalizeRange","globalRange","out","global","rangeOptions","getRangePos","unique","empty","objA","objB","sorters","sorting","as","int","nullFilter","$empty","_ssFilters","markBarFilter","getFilters","filters","clearFilters","refilter","filterSpreadSheet","calibrateRange","getFilterRange","isValueActive","includes","isFilterExists","getFilterMode","pasteFilter","setCellFilter","getSingleOption","getConditions","getFilterFunction","opt","on_click","ssheet_filter_sign","on_dblclick","toggleFilters","removeFilters","isFilter","$mode","$filter","syncScroll","_getTargetNode","getFilter","flt","importData","relative","field","inputs","applyFilter","oldValue","setCellStyle","isHidden","nodeOffset","tableOffset","getElementsByClassName","ydiff","xdiff","scrollSize","fillForm","labelsLocale","commonConfig","customConfig","dateConfig","getFormats","updateForm","paddingX","closeWin","isText","$css","forms","value2","_formatValue","_isNotDateRule","editFormat","_safeInt","_getCondition","activeValue","_clean","dialog","_rulesToArr","current_view","_this4","onBlur","getRows","getConditionStyle","conditionStyle","_this5","getSheets","filename","restoreValue","paper","fit","sheetnames","modal","vertical","print","_setComment","textarea","onViewResize","animate","showInput","addComment","comment","showTemplate","changeTextarea","getHead","$height","rowHeight","getOption","optionHeight","bases","imt","imc","asw","rgs","dpd","cnd","exp","lnk","pnt","cmt","ignoreUndoReset","restoreHistory","_ssUndoHistory","_ssUndoCursor","addToHistory","$skipHistory","ignoreReset","step","prevData","undoHandlers","nvalue","ovalue","_trackAll","conf","viewMethods","_types","track","_trackOne","_fromRange","_isPie","_removeLegend","legend","fromData","shift","names","_getNames","switchDirection","dataSeries","legendRange","_getParts","_showAll","win","_correctPos","_showOne","_getWidth","$width","_getHeight","_isRange","_getDataParts","subdata","getRangeRows","getRangeCols","_getSeries","oldXaxis","vals","xAxis","activeVals","series","firstRange","inActiveSeries","seria","activeVal","marker","_getColor","colors","dataRange","subRange","_normalizeConfig","valign","scale","rangeToData","rind","editUIType","querySelector","register","container","_commands","getConfig","inner","renderConfig","_processTables","query","tables","dt","oldWin","_activeWin","$destructed","_reset","_undoUI","one","viewIds","_genChartConfig","htmlFilter","scaleColor","legendConfig","_pieConfig","pieInnerText","borderColor","lineColor","yAxis","lineShape","circle","chartEditor","handlePieLegend","getLeftColumn","getTopRow","setSilentValue","updateLegendRange","updateXaxisRange","xAxisRange","leftColumn","topRow","exist","updateAlign","updateValign","updateType","getTabbar","switchRowsCols","stacked","hideField","hideBatch","hideOption","showOption","updateSeries","pie","inValues","expand","closeEditor","outValues","activeSkin","barHeight","complexData","addRichselect","getLegendAlign","getLegendValign","attributes","loadChangedData","process","getUpdateValues","_addColumn","_delColumn","_addRow","_delRow","updatedData","fixSelectArea","_ssEditors","clearEditors","pasteDropdown","dropdown","styledata","clipdata","updateFilters","getRow","ignore","$popup","tblEditors","isEditor","_clipboardToTable","cdata","fromSheet","cut","clipboard","clipbuffer","_sel_to_clip","mapSelection","row_ind","delimiter","clipboardDecimalDelimiter","_updateDelimiter","csv","stringify","ctrlKey","metaKey","_get_sel_style","allFiltersInZone","startRow","startCol","endCol","_clip_to_sel","leftTop","_changeDelimiter","record","_add_row_col","maxRow","maxCol","col_ind","subtrans","_hidden_cols_hash","_hidden_rows_hash","isColumnVisible","setState","indexes","getIds","_showRow","_showColumn","_hideRow","_hideColumn","isRowVisible","showColumn","getColumnIndex","hideColumn","_updatePosition","hrows","hcols","_adjustRowHeight","headerOnly","refreshSelectArea","getColumn","_undoResize","defWidth","defHeight","nsizes","bs","blockStart","blockEnd","res","removeSelectArea","sortRange","fullrange","expandSelection","maxY","maxX","nr1","nr2","nc1","nc2","newrange","by","newMath","updateSheetNames","oldName","stack","option","gridlines","removeComment","getComment","removeCommentsRange","commentCell","_undoComment","modules","m1","m2","m3","m4","m5","m6","m7","uploader","XMLHttpRequest","apiOnly","accept","startImport","fileDialog","_buildHtml","doc","xCorrection","baseIndex","sheetname","$customPrint","br","insertBefore","docFooter","_cleanHtml","_safeColor","_getCellStyle","excel","stl","font","alignment","_getExcelCellStyle","_getPdfCellStyle","rgb","fill","fgColor","horizontal","sz","italic","underline","bold","wrapText","getBorderStyles","textAlign","vertAlign","whiteSpace","_getDocStyle","$exportView","pdf","export_mode","defaultOptions","footer","heights","rawValues","filterHTML","_exportView","dataOnly","sheetOptions","_hidden","pdfTable","textBefore","sheetData","scheme","_getStyles","cached","cachedConditions","_getDefaults","docHeader","delta","rIndex","cIndex","_getCellConditions","computed","getComputedStyle","bg","_updateStyleCondition","rgbToHex","_updatePdfData","idx","colspan","rowData","exportData","rowSize","pad","paddingTop","paddingBottom","ref","Sheet","Name","Ref","getAutowidth","prop","orientation","$getExportValue","_excel_to_data","dataObj","styleshash","stylescount","_safeFont","va","_getBorderStyles","_getTypes","_getHidden","safe","_parseExcel","driver","full","_parseCsv","getRecords","clearRange","callCommand","setSize","insertRow","deleteRow","insertColumn","deleteColumn","checkSpans","spanSize","changeSpan","getIndexById","hideRow","_normalizeVal","chart","getRangeValue","registerMathMethod","sid","spn","rangeStr","setRangeValue","addSheet","clearSheet","renameSheet","editSheet","removeSheet","und","srt","correctVal","cb","sameValue","oldType","dateValue","updatedType","param","tbl","ok","resetUndo","groupUndo","changeDecimals","defaultMenu","getMenuData","component","_base_index","getDefaultStyles","_sub_init","_set_handlers","$skin","setSkinDefaults","material","background","subbar","tblObj","attachTo","lists","sizeToContent","getMenuItem","contextMenu","dialogs","viewBases","rows_setter","operations","m9","m10","m11","m12","m13","m14","m16","m8","m17","m16a","m16b","m16c","m18","m19","m20","m21","m22","m23","m24","m25","m26","m27","m28","m29","m30","$onLoad","api","rco","lcl","fcl","hbr","hhd","hrc","mat","ops","cor","sav","cfm","AtomDataLoader"],"mappings":";;;;;;;;uJACAA,MAAMC,KAAKC,YCDI,CACdC,OAAO,QAEI,kBACE,kBACF,iBACC,eACH,cACE,uBACO,0BACA,2BACL,2BACD,oCACO,yBACJ,4BACA,qCAED,iBACL,YACA,YACA,aACC,eACC,gBACA,iBACC,aACL,WACG,eAEC,cACF,aAEC,6BAEa,+BACT,gCACQ,+BACG,iCACF,kCACE,kBAEf,sBACM,4BACD,qBACC,sBACA,uBACC,kBAEJ,mBACG,2BACC,qCACH,wCAEM,iCACD,yBACC,0BACA,6BACG,gCACA,0BAEN,8BACE,kCAEA,+BACA,gCACA,WAEZ,oBAEU,8BACM,6DACN,uBACD,wCACK,iCAEN,uBACD,kBACD,YAEH,yBACQ,8BACD,wBAEP,wBACO,0BACJ,0BAEA,gBACF,+BAEc,gFACA,8EACH,6EACN,gCAEP,sBACM,sCACG,iCACH,4BACC,yBACC,6BACH,uBACD,4BACC,+BACC,+BACF,yBACH,6BACK,mBACJ,2BACA,8BACG,2BACC,8BACE,4BACC,oBAEP,gBAEF,eACC,uBACM,gCACA,+BAEH,qBACE,sBACD,4BAEE,wBACA,wBACA,uBAED,6BACI,iCACA,gCACE,0BAEP,oBACA,mBACD,oBACE,oBACF,oBACE,uBACC,4BACI,4BAEL,uBACC,wBACA,uBACD,4BACM,kCACA,4BACA,0BACF,6CACA,2CACE,6BACC,6BACD,0BACF,yBACC,0BACA,sEAEJ,4BACI,2CACA,iDACE,oCACA,4BACD,4BACC,8BACC,+BACA,oCACH,4BACG;sBACA,sBAET,uBACG,wBACF,6BACO,mBACV,wBACE,uBACG,yBACF,2BAEI,mCACF,uBACH,uBAEG,iCACO,kCACE,mCACD,gCACF,yBAEL,oCACF,0BAEM,iBAEtBC,SAAU,OACA,wBACK,iCACC,0BACF,yBACC,oCACI,yBACP,uBACG,+BACE,4BACD,6BACE,gCACC,8BACH,8BACE,qCACK,yCACL,4BACH,4BACE,6BACD,0BACF,2BACG,8BACA,oBACR,aACA,iBACA,YACA,cACE,oCACU,8CACA,wCACL,oBACD,2BACK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"}